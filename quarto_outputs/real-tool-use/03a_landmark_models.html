<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.186">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Joshua Bell">
<meta name="dcterms.date" content="2022-11-06">

<title>Bayesian Models - Landmark</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="03a_landmark_models_files/libs/clipboard/clipboard.min.js"></script>
<script src="03a_landmark_models_files/libs/quarto-html/quarto.js"></script>
<script src="03a_landmark_models_files/libs/quarto-html/popper.min.js"></script>
<script src="03a_landmark_models_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="03a_landmark_models_files/libs/quarto-html/anchor.min.js"></script>
<link href="03a_landmark_models_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="03a_landmark_models_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="03a_landmark_models_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="03a_landmark_models_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="03a_landmark_models_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Bayesian Models - Landmark</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Joshua Bell </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">November 6, 2022</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> <span class="cn">TRUE</span>, </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">warning =</span> <span class="cn">FALSE</span>, </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">message =</span> <span class="cn">FALSE</span>, </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">cache =</span> <span class="cn">TRUE</span>, </span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">fig.width =</span> <span class="dv">12</span>, </span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">fig.height =</span> <span class="dv">8</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>pkgs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"dplyr"</span>, <span class="st">"readr"</span>, <span class="st">"magrittr"</span>, <span class="st">"data.table"</span>, <span class="st">"here"</span>, <span class="st">"brms"</span>, <span class="st">"cmdstanr"</span>, <span class="st">"bayestestR"</span>, <span class="st">"tidybayes"</span>, <span class="st">"ggplot2"</span>, <span class="st">"flextable"</span>, <span class="st">"officer"</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> pkgs){</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="sc">!</span>i <span class="sc">%in%</span> <span class="fu">rownames</span>(<span class="fu">installed.packages</span>())){ </span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">install.packages</span>(i) </span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">library</span>(i, <span class="at">character.only =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span>(<span class="fu">library</span>(i, <span class="at">character.only =</span> <span class="cn">TRUE</span>))</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="st">"mc.cores"</span> <span class="ot">=</span> parallel<span class="sc">::</span><span class="fu">detectCores</span>(), <span class="st">"brms.backend"</span> <span class="ot">=</span> <span class="st">"cmdstan"</span>)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>b <span class="ot">=</span> <span class="dv">16000</span><span class="sc">/</span>parallel<span class="sc">::</span><span class="fu">detectCores</span>()</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>i <span class="ot">=</span> <span class="dv">48000</span><span class="sc">/</span>parallel<span class="sc">::</span><span class="fu">detectCores</span>()</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>ch <span class="ot">=</span> parallel<span class="sc">::</span><span class="fu">detectCores</span>()</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>co <span class="ot">=</span> parallel<span class="sc">::</span><span class="fu">detectCores</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-hash="03a_landmark_models_cache/html/import-standardize_ccfdcdaf968551bcb432a49eacce991c">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>landmark <span class="ot">&lt;-</span> <span class="fu">fread</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"study_two"</span>, <span class="st">"landmark.csv"</span>))</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>landmark_summary <span class="ot">&lt;-</span> landmark <span class="sc">%&gt;%</span> <span class="fu">select</span>(ppid, trial, time,</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>                                        forearmlength, target,</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>                                        error, lapse_fix_target,</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>                                        lapse_fix_error) <span class="sc">%&gt;%</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span>ppid <span class="sc">==</span> <span class="st">"d2-010"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">error_std =</span> datawizard<span class="sc">::</span><span class="fu">standardize</span>(error),</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">forearmlength_std =</span> datawizard<span class="sc">::</span><span class="fu">standardize</span>(forearmlength),</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">lapse_fix_error_std =</span> datawizard<span class="sc">::</span><span class="fu">standardize</span>(lapse_fix_error),</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">lapse_fix_target =</span> <span class="fu">factor</span>(</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>          lapse_fix_target,</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>          <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Forearm"</span>, <span class="st">"Wrist"</span>, <span class="st">"Elbow"</span>)),</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">time =</span> <span class="fu">factor</span>(time,</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>          <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"pre"</span>, <span class="st">"post"</span>),</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>          <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Pre"</span>, <span class="st">"Post"</span>)),</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">target =</span> <span class="fu">factor</span>(target,</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>          <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Forearm"</span>, <span class="st">"Wrist"</span>, <span class="st">"Elbow"</span>)))</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>landmark_fix <span class="ot">&lt;-</span> landmark_summary <span class="sc">%&gt;%</span> </span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>    ppid, trial, time,</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>    forearmlength_std,</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>    lapse_fix_target,</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>    lapse_fix_error_std</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">target =</span> lapse_fix_target,</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">error_std =</span> lapse_fix_error_std,</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>landmark_summary <span class="sc">%&gt;%</span></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(time, target) <span class="sc">%&gt;%</span></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">num_lapses =</span> <span class="fu">sum</span>(lapse_fix_target <span class="sc">!=</span> target),</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">num_trials =</span> <span class="fu">n</span>(),</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">lapse_rate =</span> num_lapses<span class="sc">/</span>num_trials</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
# Groups:   time [2]
  time  target  num_lapses num_trials lapse_rate
  &lt;fct&gt; &lt;fct&gt;        &lt;int&gt;      &lt;int&gt;      &lt;dbl&gt;
1 Pre   Forearm         15        150     0.1   
2 Pre   Wrist           11        150     0.0733
3 Pre   Elbow            2        150     0.0133
4 Post  Forearm         14        150     0.0933
5 Post  Wrist           13        150     0.0867
6 Post  Elbow            0        150     0     </code></pre>
</div>
</div>
<section id="models" class="level1">
<h1>Models</h1>
<p>In order to have an interaction parameter (and hypothesis test) for all three targets, brms’s nonlinear construction was used. ## Normal ### Prior</p>
<div class="cell" data-hash="03a_landmark_models_cache/html/landmark-prior_cbb1553b3437742e1c71ad8369d8e336">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>landmark_time_target_priors <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bf</span>(error_std <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> a <span class="sc">+</span> b <span class="sc">*</span> time <span class="sc">+</span> d,</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>     a <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> target,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>     b <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> target,</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>     d <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> (<span class="dv">0</span> <span class="sc">+</span> target <span class="sc">+</span> time <span class="sc">+</span> target <span class="sc">:</span> time <span class="sc">|</span> ppid),</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">nl =</span> <span class="cn">TRUE</span>),</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="st">"normal(0, 2)"</span>, <span class="at">nlpar =</span> <span class="st">"a"</span>),</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>               <span class="fu">prior</span>(<span class="st">"normal(.2, 2)"</span>, <span class="at">nlpar =</span> <span class="st">"b"</span>),</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>                <span class="co">#prior("normal(0, .5)", nlpar = "c"),</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="st">"exponential(1)"</span>, <span class="at">class =</span> <span class="st">"sd"</span>, <span class="at">nlpar =</span> <span class="st">"d"</span>),</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="st">"exponential(1)"</span>, <span class="at">class =</span> <span class="st">"sigma"</span>),</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>                <span class="fu">set_prior</span>(<span class="at">prior =</span> <span class="st">"lkj(1)"</span>, <span class="at">class =</span> <span class="st">"cor"</span>, <span class="at">group =</span> <span class="st">"ppid"</span>)),</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">data =</span> landmark_summary,</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>     <span class="at">sample_prior =</span> <span class="st">"only"</span>,</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>     <span class="at">seed =</span> <span class="dv">1337</span>,</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">silent =</span> <span class="cn">TRUE</span>, <span class="at">refresh =</span> <span class="dv">0</span>,</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>     <span class="at">save_pars =</span> <span class="fu">save_pars</span>(<span class="at">all =</span> <span class="cn">TRUE</span>),</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>     <span class="at">warmup =</span> b,</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>     <span class="at">iter =</span> i,</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>     <span class="at">chains =</span> ch,</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>     <span class="at">cores =</span> co,</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>     <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> .<span class="dv">975</span>, <span class="at">max_treedepth =</span> <span class="dv">15</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Running MCMC with 16 parallel chains...

Chain 7 finished in 2.9 seconds.
Chain 2 finished in 3.5 seconds.
Chain 4 finished in 3.4 seconds.
Chain 1 finished in 3.6 seconds.
Chain 8 finished in 3.6 seconds.
Chain 3 finished in 3.8 seconds.
Chain 5 finished in 3.8 seconds.
Chain 6 finished in 3.7 seconds.
Chain 9 finished in 3.6 seconds.
Chain 10 finished in 3.7 seconds.
Chain 11 finished in 3.9 seconds.
Chain 12 finished in 3.8 seconds.
Chain 14 finished in 3.7 seconds.
Chain 16 finished in 3.6 seconds.
Chain 13 finished in 3.8 seconds.
Chain 15 finished in 3.7 seconds.

All 16 chains finished successfully.
Mean chain execution time: 3.6 seconds.
Total execution time: 4.2 seconds.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(landmark_time_target_priors)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: error_std ~ 0 + a + b * time + d 
         a ~ 0 + target
         b ~ 0 + target
         d ~ 0 + (0 + target + time + target:time | ppid)
   Data: landmark_summary (Number of observations: 900) 
  Draws: 16 chains, each with iter = 3000; warmup = 1000; thin = 1;
         total post-warmup draws = 32000

Group-Level Effects: 
~ppid (Number of levels: 25) 
                                                   Estimate Est.Error l-95% CI
sd(d_targetForearm)                                    1.00      0.98     0.03
sd(d_targetWrist)                                      1.01      1.02     0.02
sd(d_targetElbow)                                      1.00      0.99     0.02
sd(d_timePost)                                         0.99      0.98     0.03
sd(d_targetWrist:timePost)                             1.00      1.00     0.03
sd(d_targetElbow:timePost)                             1.00      1.00     0.02
cor(d_targetForearm,d_targetWrist)                    -0.00      0.38    -0.71
cor(d_targetForearm,d_targetElbow)                     0.00      0.38    -0.71
cor(d_targetWrist,d_targetElbow)                      -0.00      0.38    -0.71
cor(d_targetForearm,d_timePost)                       -0.00      0.38    -0.71
cor(d_targetWrist,d_timePost)                         -0.00      0.38    -0.70
cor(d_targetElbow,d_timePost)                          0.00      0.38    -0.70
cor(d_targetForearm,d_targetWrist:timePost)           -0.00      0.38    -0.71
cor(d_targetWrist,d_targetWrist:timePost)              0.00      0.38    -0.71
cor(d_targetElbow,d_targetWrist:timePost)              0.00      0.38    -0.71
cor(d_timePost,d_targetWrist:timePost)                -0.00      0.38    -0.71
cor(d_targetForearm,d_targetElbow:timePost)            0.00      0.38    -0.71
cor(d_targetWrist,d_targetElbow:timePost)              0.00      0.38    -0.70
cor(d_targetElbow,d_targetElbow:timePost)              0.00      0.38    -0.70
cor(d_timePost,d_targetElbow:timePost)                -0.00      0.38    -0.72
cor(d_targetWrist:timePost,d_targetElbow:timePost)    -0.00      0.38    -0.71
                                                   u-95% CI Rhat Bulk_ESS
sd(d_targetForearm)                                    3.62 1.00    39976
sd(d_targetWrist)                                      3.79 1.00    40258
sd(d_targetElbow)                                      3.65 1.00    40767
sd(d_timePost)                                         3.63 1.00    40856
sd(d_targetWrist:timePost)                             3.69 1.00    39465
sd(d_targetElbow:timePost)                             3.67 1.00    40457
cor(d_targetForearm,d_targetWrist)                     0.71 1.00    73155
cor(d_targetForearm,d_targetElbow)                     0.71 1.00    69661
cor(d_targetWrist,d_targetElbow)                       0.71 1.00    41857
cor(d_targetForearm,d_timePost)                        0.71 1.00    74901
cor(d_targetWrist,d_timePost)                          0.71 1.00    41693
cor(d_targetElbow,d_timePost)                          0.71 1.00    29467
cor(d_targetForearm,d_targetWrist:timePost)            0.71 1.00    76161
cor(d_targetWrist,d_targetWrist:timePost)              0.72 1.00    42812
cor(d_targetElbow,d_targetWrist:timePost)              0.71 1.00    29801
cor(d_timePost,d_targetWrist:timePost)                 0.71 1.00    22712
cor(d_targetForearm,d_targetElbow:timePost)            0.71 1.00    70936
cor(d_targetWrist,d_targetElbow:timePost)              0.70 1.00    40167
cor(d_targetElbow,d_targetElbow:timePost)              0.71 1.00    29605
cor(d_timePost,d_targetElbow:timePost)                 0.70 1.00    23334
cor(d_targetWrist:timePost,d_targetElbow:timePost)     0.71 1.00    18341
                                                   Tail_ESS
sd(d_targetForearm)                                   17191
sd(d_targetWrist)                                     16583
sd(d_targetElbow)                                     17671
sd(d_timePost)                                        19020
sd(d_targetWrist:timePost)                            16684
sd(d_targetElbow:timePost)                            17269
cor(d_targetForearm,d_targetWrist)                    21108
cor(d_targetForearm,d_targetElbow)                    21410
cor(d_targetWrist,d_targetElbow)                      22879
cor(d_targetForearm,d_timePost)                       21003
cor(d_targetWrist,d_timePost)                         20953
cor(d_targetElbow,d_timePost)                         23697
cor(d_targetForearm,d_targetWrist:timePost)           20272
cor(d_targetWrist,d_targetWrist:timePost)             21921
cor(d_targetElbow,d_targetWrist:timePost)             23582
cor(d_timePost,d_targetWrist:timePost)                24151
cor(d_targetForearm,d_targetElbow:timePost)           21469
cor(d_targetWrist,d_targetElbow:timePost)             21037
cor(d_targetElbow,d_targetElbow:timePost)             23656
cor(d_timePost,d_targetElbow:timePost)                23512
cor(d_targetWrist:timePost,d_targetElbow:timePost)    24101

Population-Level Effects: 
                Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
a_targetForearm    -0.01      2.01    -3.97     3.92 1.00    72282    22733
a_targetWrist      -0.01      1.99    -3.91     3.86 1.00    76251    20648
a_targetElbow       0.00      2.00    -3.92     3.94 1.00    75551    22387
b_targetForearm     0.21      2.00    -3.71     4.13 1.00    70673    22963
b_targetWrist       0.19      1.97    -3.63     4.04 1.00    71639    23622
b_targetElbow       0.18      1.99    -3.78     4.09 1.00    73746    22166

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     1.00      1.00     0.03     3.67 1.00    40667    17754

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(landmark_time_target_priors)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03a_landmark_models_files/figure-html/landmark-prior-1.png" class="img-fluid" width="1152"></p>
</div>
<div class="cell-output-display">
<p><img src="03a_landmark_models_files/figure-html/landmark-prior-2.png" class="img-fluid" width="1152"></p>
</div>
<div class="cell-output-display">
<p><img src="03a_landmark_models_files/figure-html/landmark-prior-3.png" class="img-fluid" width="1152"></p>
</div>
<div class="cell-output-display">
<p><img src="03a_landmark_models_files/figure-html/landmark-prior-4.png" class="img-fluid" width="1152"></p>
</div>
<div class="cell-output-display">
<p><img src="03a_landmark_models_files/figure-html/landmark-prior-5.png" class="img-fluid" width="1152"></p>
</div>
<div class="cell-output-display">
<p><img src="03a_landmark_models_files/figure-html/landmark-prior-6.png" class="img-fluid" width="1152"></p>
</div>
</div>
<section id="posterior" class="level3">
<h3 class="anchored" data-anchor-id="posterior">Posterior</h3>
<div class="cell" data-hash="03a_landmark_models_cache/html/landmark-posterior_852e4da88b7bb53e95e200671191285e">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>landmark_time_target <span class="ot">&lt;-</span> <span class="fu">update</span>(</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  landmark_time_target_priors,</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">sample_prior =</span> <span class="st">"no"</span>,</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">refresh =</span> <span class="dv">0</span>,</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">1337</span>,</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"scripts"</span>, <span class="st">"for_osf"</span>, <span class="st">"tooluse_in_real"</span>, <span class="st">"models"</span>, <span class="st">"landmark_error_time_target.rds"</span>),</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">file_refit =</span> <span class="st">"on_change"</span>,</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">silent =</span> <span class="cn">TRUE</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(landmark_time_target)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: error_std ~ 0 + a + b * time + d 
         a ~ 0 + target
         b ~ 0 + target
         d ~ 0 + (0 + target + time + target:time | ppid)
   Data: landmark_summary (Number of observations: 900) 
  Draws: 16 chains, each with iter = 3000; warmup = 1000; thin = 1;
         total post-warmup draws = 32000

Group-Level Effects: 
~ppid (Number of levels: 25) 
                                                   Estimate Est.Error l-95% CI
sd(d_targetForearm)                                    0.52      0.09     0.37
sd(d_targetWrist)                                      0.73      0.12     0.53
sd(d_targetElbow)                                      0.71      0.12     0.51
sd(d_timePost)                                         0.43      0.10     0.25
sd(d_targetWrist:timePost)                             0.15      0.12     0.01
sd(d_targetElbow:timePost)                             0.45      0.17     0.09
cor(d_targetForearm,d_targetWrist)                     0.78      0.11     0.52
cor(d_targetForearm,d_targetElbow)                     0.32      0.19    -0.07
cor(d_targetWrist,d_targetElbow)                       0.09      0.19    -0.29
cor(d_targetForearm,d_timePost)                       -0.24      0.21    -0.61
cor(d_targetWrist,d_timePost)                         -0.02      0.22    -0.44
cor(d_targetElbow,d_timePost)                         -0.07      0.23    -0.49
cor(d_targetForearm,d_targetWrist:timePost)           -0.01      0.35    -0.68
cor(d_targetWrist,d_targetWrist:timePost)             -0.07      0.35    -0.71
cor(d_targetElbow,d_targetWrist:timePost)              0.05      0.36    -0.65
cor(d_timePost,d_targetWrist:timePost)                -0.04      0.37    -0.71
cor(d_targetForearm,d_targetElbow:timePost)            0.18      0.26    -0.36
cor(d_targetWrist,d_targetElbow:timePost)              0.10      0.25    -0.41
cor(d_targetElbow,d_targetElbow:timePost)             -0.39      0.25    -0.78
cor(d_timePost,d_targetElbow:timePost)                 0.07      0.29    -0.48
cor(d_targetWrist:timePost,d_targetElbow:timePost)    -0.04      0.37    -0.72
                                                   u-95% CI Rhat Bulk_ESS
sd(d_targetForearm)                                    0.71 1.00    12429
sd(d_targetWrist)                                      0.98 1.00    12627
sd(d_targetElbow)                                      0.99 1.00    12384
sd(d_timePost)                                         0.65 1.00    12469
sd(d_targetWrist:timePost)                             0.44 1.00     9911
sd(d_targetElbow:timePost)                             0.80 1.00     5869
cor(d_targetForearm,d_targetWrist)                     0.93 1.00    12432
cor(d_targetForearm,d_targetElbow)                     0.65 1.00    10435
cor(d_targetWrist,d_targetElbow)                       0.45 1.00    13911
cor(d_targetForearm,d_timePost)                        0.22 1.00    13700
cor(d_targetWrist,d_timePost)                          0.41 1.00    19059
cor(d_targetElbow,d_timePost)                          0.38 1.00    18881
cor(d_targetForearm,d_targetWrist:timePost)            0.67 1.00    40335
cor(d_targetWrist,d_targetWrist:timePost)              0.63 1.00    39324
cor(d_targetElbow,d_targetWrist:timePost)              0.71 1.00    33956
cor(d_timePost,d_targetWrist:timePost)                 0.68 1.00    25459
cor(d_targetForearm,d_targetElbow:timePost)            0.63 1.00    19906
cor(d_targetWrist,d_targetElbow:timePost)              0.58 1.00    27271
cor(d_targetElbow,d_targetElbow:timePost)              0.18 1.00    19331
cor(d_timePost,d_targetElbow:timePost)                 0.65 1.00    19635
cor(d_targetWrist:timePost,d_targetElbow:timePost)     0.66 1.00    13452
                                                   Tail_ESS
sd(d_targetForearm)                                   19408
sd(d_targetWrist)                                     18378
sd(d_targetElbow)                                     19683
sd(d_timePost)                                        15583
sd(d_targetWrist:timePost)                            15145
sd(d_targetElbow:timePost)                             4120
cor(d_targetForearm,d_targetWrist)                    20134
cor(d_targetForearm,d_targetElbow)                    17390
cor(d_targetWrist,d_targetElbow)                      19281
cor(d_targetForearm,d_timePost)                       20238
cor(d_targetWrist,d_timePost)                         22836
cor(d_targetElbow,d_timePost)                         23210
cor(d_targetForearm,d_targetWrist:timePost)           24696
cor(d_targetWrist,d_targetWrist:timePost)             24184
cor(d_targetElbow,d_targetWrist:timePost)             25304
cor(d_timePost,d_targetWrist:timePost)                25696
cor(d_targetForearm,d_targetElbow:timePost)           19640
cor(d_targetWrist,d_targetElbow:timePost)             23111
cor(d_targetElbow,d_targetElbow:timePost)             16534
cor(d_timePost,d_targetElbow:timePost)                21217
cor(d_targetWrist:timePost,d_targetElbow:timePost)    22590

Population-Level Effects: 
                Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
a_targetForearm     0.26      0.12     0.02     0.50 1.00     7522    13940
a_targetWrist       0.27      0.16    -0.05     0.57 1.00     8109    13896
a_targetElbow      -0.18      0.16    -0.49     0.12 1.00    10998    16053
b_targetForearm    -0.22      0.12    -0.46     0.02 1.00    15315    20216
b_targetWrist      -0.29      0.13    -0.54    -0.05 1.00    16255    21270
b_targetElbow      -0.18      0.16    -0.49     0.13 1.00    14480    19886

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.73      0.02     0.69     0.77 1.00    31665    22401

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(landmark_time_target)</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  landmark_time_target,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"dens_overlay_grouped"</span>, </span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">ndraws =</span> <span class="dv">50</span>,</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">group =</span> <span class="st">"target"</span>) <span class="sc">+</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_tidybayes</span>() <span class="sc">+</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>()</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Landmark Task Errors"</span>,</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Posterior Draws vs. Empirical Distribution"</span>,</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Error (standardized)"</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03a_landmark_models_files/figure-html/landmark-posterior-1.png" class="img-fluid" width="1152"></p>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>landmark_describe <span class="ot">&lt;-</span> bayestestR<span class="sc">::</span><span class="fu">describe_posterior</span>(</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  landmark_time_target,</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">centrality =</span> <span class="st">"map"</span>,</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">ci_method=</span><span class="st">"hdi"</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> <span class="fu">as.data.table</span>()</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>landmark_describe</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           Parameter        MAP   CI     CI_low    CI_high        pd ROPE_CI
1: b_a_targetForearm  0.2583284 0.95  0.0242502  0.4959120 0.9842812    0.95
2:   b_a_targetWrist  0.2763623 0.95 -0.0410979  0.5775140 0.9547813    0.95
3:   b_a_targetElbow -0.1848944 0.95 -0.4964330  0.1174240 0.8855625    0.95
4: b_b_targetForearm -0.2250935 0.95 -0.4610210  0.0165533 0.9641875    0.95
5:   b_b_targetWrist -0.2952957 0.95 -0.5430130 -0.0500015 0.9888125    0.95
6:   b_b_targetElbow -0.1866934 0.95 -0.4930460  0.1244450 0.8815625    0.95
   ROPE_low ROPE_high ROPE_Percentage     Rhat       ESS
1:     -0.1       0.1      0.06911184 1.001212  7456.238
2:     -0.1       0.1      0.12302632 1.001257  8005.367
3:     -0.1       0.1      0.26661184 1.000625 10917.962
4:     -0.1       0.1      0.14414474 1.000406 15179.086
5:     -0.1       0.1      0.03634868 1.000485 16142.800
6:     -0.1       0.1      0.27375000 1.000541 14366.252</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>landmark_bfs <span class="ot">&lt;-</span> landmark_time_target <span class="sc">%&gt;%</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bayesfactor_pointnull</span>(</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">direction =</span> <span class="st">"&gt;"</span>,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">prior =</span> landmark_time_target_priors</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.table</span>()</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>(landmark_error_table <span class="ot">&lt;-</span> <span class="fu">merge</span>(</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  landmark_bfs[Parameter <span class="sc">%in%</span> <span class="fu">c</span>(</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"b_b_targetElbow"</span>, </span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"b_b_targetWrist"</span>, </span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">"b_b_targetForearm"</span>),</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>    .(<span class="at">Parameter =</span> <span class="fu">fcase</span>(</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>        Parameter <span class="sc">==</span> <span class="st">"b_b_targetElbow"</span>, <span class="st">"Elbow"</span>,</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>        Parameter <span class="sc">==</span> <span class="st">"b_b_targetWrist"</span>, <span class="st">"Wrist"</span>,</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>        Parameter <span class="sc">==</span> <span class="st">"b_b_targetForearm"</span>, <span class="st">"Forearm"</span>),</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">BF =</span> <span class="fu">exp</span>(log_BF))],</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>    landmark_describe[</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>      Parameter <span class="sc">%in%</span> <span class="fu">c</span>(</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>        <span class="st">"b_b_targetElbow"</span>, </span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>        <span class="st">"b_b_targetWrist"</span>, </span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>        <span class="st">"b_b_targetForearm"</span></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>        )][,</span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">Parameter :=</span> <span class="fu">fcase</span>(</span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>          Parameter <span class="sc">==</span> <span class="st">"b_b_targetElbow"</span>, <span class="st">"Elbow"</span>,</span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>          Parameter <span class="sc">==</span> <span class="st">"b_b_targetWrist"</span>, <span class="st">"Wrist"</span>,</span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>          Parameter <span class="sc">==</span> <span class="st">"b_b_targetForearm"</span>, <span class="st">"Forearm"</span></span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>          ],</span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">by =</span> <span class="st">"Parameter"</span></span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Parameter         BF        MAP   CI    CI_low    CI_high        pd ROPE_CI
1:     Elbow 0.03455301 -0.1866934 0.95 -0.493046  0.1244450 0.8815625    0.95
2:   Forearm 0.02075112 -0.2250935 0.95 -0.461021  0.0165533 0.9641875    0.95
3:     Wrist 0.01923806 -0.2952957 0.95 -0.543013 -0.0500015 0.9888125    0.95
   ROPE_low ROPE_high ROPE_Percentage     Rhat      ESS
1:     -0.1       0.1      0.27375000 1.000541 14366.25
2:     -0.1       0.1      0.14414474 1.000406 15179.09
3:     -0.1       0.1      0.03634868 1.000485 16142.80</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(landmark_error_table, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"scripts"</span>, <span class="st">"for_osf"</span>, <span class="st">"tooluse_in_real"</span>, <span class="st">"tables"</span>, <span class="st">"landmark_table.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="lapse-fix" class="level2">
<h2 class="anchored" data-anchor-id="lapse-fix">Lapse Fix</h2>
<section id="prior" class="level3">
<h3 class="anchored" data-anchor-id="prior">Prior</h3>
<div class="cell" data-hash="03a_landmark_models_cache/html/lapsefix_model_ecab33b5598fa519bfdb49c47c8a23ed">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>landmark_lapsefix_error_time_target_priors <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bf</span>(error_std <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> a <span class="sc">+</span> b <span class="sc">*</span> time <span class="sc">+</span> d,</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>     a <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> target,</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>     b <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> target,</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>     d <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> (<span class="dv">0</span> <span class="sc">+</span> target <span class="sc">+</span> time <span class="sc">+</span> target <span class="sc">:</span> time <span class="sc">|</span> ppid),</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">nl =</span> <span class="cn">TRUE</span>),</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="st">"normal(0, 2)"</span>, <span class="at">nlpar =</span> <span class="st">"a"</span>),</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>               <span class="fu">prior</span>(<span class="st">"normal(0, 2)"</span>, <span class="at">nlpar =</span> <span class="st">"b"</span>),</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="st">"exponential(1)"</span>, <span class="at">class =</span> <span class="st">"sd"</span>, <span class="at">nlpar =</span> <span class="st">"d"</span>),</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="st">"exponential(1)"</span>, <span class="at">class =</span> <span class="st">"sigma"</span>)),</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">data =</span> landmark_fix,</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">sample_prior =</span> <span class="st">"only"</span>,</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">seed =</span> <span class="dv">1337</span>,</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>     <span class="at">silent =</span> <span class="cn">TRUE</span>, <span class="at">refresh =</span> <span class="dv">0</span>,</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>     <span class="at">save_pars =</span> <span class="fu">save_pars</span>(<span class="at">all =</span> <span class="cn">TRUE</span>),</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">warmup =</span> b,</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>     <span class="at">iter =</span> i,</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>     <span class="at">chains =</span> ch,</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>     <span class="at">cores =</span> co,</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>     <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> .<span class="dv">975</span>, <span class="at">max_treedepth =</span> <span class="dv">15</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Running MCMC with 16 parallel chains...

Chain 1 finished in 3.6 seconds.
Chain 2 finished in 3.6 seconds.
Chain 3 finished in 3.8 seconds.
Chain 8 finished in 3.8 seconds.
Chain 12 finished in 3.7 seconds.
Chain 13 finished in 3.7 seconds.
Chain 4 finished in 3.8 seconds.
Chain 10 finished in 3.8 seconds.
Chain 5 finished in 3.9 seconds.
Chain 6 finished in 4.0 seconds.
Chain 7 finished in 4.0 seconds.
Chain 9 finished in 3.9 seconds.
Chain 11 finished in 3.9 seconds.
Chain 15 finished in 3.8 seconds.
Chain 16 finished in 3.8 seconds.
The remaining chains had a mean execution time of 4.1 seconds.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(landmark_lapsefix_error_time_target_priors)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: error_std ~ 0 + a + b * time + d 
         a ~ 0 + target
         b ~ 0 + target
         d ~ 0 + (0 + target + time + target:time | ppid)
   Data: landmark_fix (Number of observations: 900) 
  Draws: 15 chains, each with iter = 3000; warmup = 1000; thin = 1;
         total post-warmup draws = 30000

Group-Level Effects: 
~ppid (Number of levels: 25) 
                                                   Estimate Est.Error l-95% CI
sd(d_targetForearm)                                    1.00      0.99     0.03
sd(d_targetWrist)                                      1.00      1.00     0.02
sd(d_targetElbow)                                      1.00      0.99     0.02
sd(d_timePost)                                         0.99      0.98     0.03
sd(d_targetWrist:timePost)                             1.00      1.01     0.03
sd(d_targetElbow:timePost)                             1.00      0.99     0.02
cor(d_targetForearm,d_targetWrist)                     0.00      0.38    -0.71
cor(d_targetForearm,d_targetElbow)                     0.00      0.38    -0.71
cor(d_targetWrist,d_targetElbow)                      -0.00      0.38    -0.70
cor(d_targetForearm,d_timePost)                       -0.00      0.38    -0.70
cor(d_targetWrist,d_timePost)                          0.00      0.38    -0.70
cor(d_targetElbow,d_timePost)                          0.00      0.38    -0.70
cor(d_targetForearm,d_targetWrist:timePost)           -0.00      0.38    -0.71
cor(d_targetWrist,d_targetWrist:timePost)              0.00      0.38    -0.71
cor(d_targetElbow,d_targetWrist:timePost)              0.00      0.38    -0.70
cor(d_timePost,d_targetWrist:timePost)                -0.00      0.38    -0.71
cor(d_targetForearm,d_targetElbow:timePost)            0.00      0.38    -0.70
cor(d_targetWrist,d_targetElbow:timePost)              0.00      0.38    -0.70
cor(d_targetElbow,d_targetElbow:timePost)             -0.00      0.38    -0.71
cor(d_timePost,d_targetElbow:timePost)                -0.00      0.38    -0.71
cor(d_targetWrist:timePost,d_targetElbow:timePost)    -0.00      0.38    -0.71
                                                   u-95% CI Rhat Bulk_ESS
sd(d_targetForearm)                                    3.61 1.00    37121
sd(d_targetWrist)                                      3.72 1.00    38497
sd(d_targetElbow)                                      3.65 1.00    39043
sd(d_timePost)                                         3.63 1.00    39378
sd(d_targetWrist:timePost)                             3.69 1.00    38014
sd(d_targetElbow:timePost)                             3.66 1.00    37374
cor(d_targetForearm,d_targetWrist)                     0.72 1.00    76771
cor(d_targetForearm,d_targetElbow)                     0.71 1.00    72352
cor(d_targetWrist,d_targetElbow)                       0.71 1.00    41219
cor(d_targetForearm,d_timePost)                        0.70 1.00    74327
cor(d_targetWrist,d_timePost)                          0.70 1.00    39953
cor(d_targetElbow,d_timePost)                          0.71 1.00    28124
cor(d_targetForearm,d_targetWrist:timePost)            0.71 1.00    76664
cor(d_targetWrist,d_targetWrist:timePost)              0.72 1.00    42305
cor(d_targetElbow,d_targetWrist:timePost)              0.71 1.00    27219
cor(d_timePost,d_targetWrist:timePost)                 0.70 1.00    21792
cor(d_targetForearm,d_targetElbow:timePost)            0.71 1.00    71550
cor(d_targetWrist,d_targetElbow:timePost)              0.71 1.00    39620
cor(d_targetElbow,d_targetElbow:timePost)              0.71 1.00    27305
cor(d_timePost,d_targetElbow:timePost)                 0.71 1.00    21370
cor(d_targetWrist:timePost,d_targetElbow:timePost)     0.71 1.00    16996
                                                   Tail_ESS
sd(d_targetForearm)                                   16073
sd(d_targetWrist)                                     15907
sd(d_targetElbow)                                     17571
sd(d_timePost)                                        17732
sd(d_targetWrist:timePost)                            16068
sd(d_targetElbow:timePost)                            16677
cor(d_targetForearm,d_targetWrist)                    19576
cor(d_targetForearm,d_targetElbow)                    19115
cor(d_targetWrist,d_targetElbow)                      20632
cor(d_targetForearm,d_timePost)                       19610
cor(d_targetWrist,d_timePost)                         20186
cor(d_targetElbow,d_timePost)                         21915
cor(d_targetForearm,d_targetWrist:timePost)           19473
cor(d_targetWrist,d_targetWrist:timePost)             20661
cor(d_targetElbow,d_targetWrist:timePost)             21774
cor(d_timePost,d_targetWrist:timePost)                22868
cor(d_targetForearm,d_targetElbow:timePost)           20855
cor(d_targetWrist,d_targetElbow:timePost)             19613
cor(d_targetElbow,d_targetElbow:timePost)             21757
cor(d_timePost,d_targetElbow:timePost)                22325
cor(d_targetWrist:timePost,d_targetElbow:timePost)    22006

Population-Level Effects: 
                Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
a_targetForearm    -0.01      2.00    -3.95     3.91 1.00    74994    20343
a_targetWrist      -0.00      2.00    -3.89     3.88 1.00    77407    20332
a_targetElbow       0.01      1.99    -3.89     3.89 1.00    77397    21673
b_targetForearm     0.01      1.99    -3.89     3.90 1.00    70073    21713
b_targetWrist       0.01      1.97    -3.82     3.86 1.00    75261    21635
b_targetElbow      -0.02      1.99    -3.97     3.93 1.00    76208    19966

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     1.00      1.01     0.02     3.73 1.00    37267    16605

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(landmark_lapsefix_error_time_target_priors)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03a_landmark_models_files/figure-html/lapsefix_model-1.png" class="img-fluid" width="1152"></p>
</div>
<div class="cell-output-display">
<p><img src="03a_landmark_models_files/figure-html/lapsefix_model-2.png" class="img-fluid" width="1152"></p>
</div>
<div class="cell-output-display">
<p><img src="03a_landmark_models_files/figure-html/lapsefix_model-3.png" class="img-fluid" width="1152"></p>
</div>
<div class="cell-output-display">
<p><img src="03a_landmark_models_files/figure-html/lapsefix_model-4.png" class="img-fluid" width="1152"></p>
</div>
<div class="cell-output-display">
<p><img src="03a_landmark_models_files/figure-html/lapsefix_model-5.png" class="img-fluid" width="1152"></p>
</div>
<div class="cell-output-display">
<p><img src="03a_landmark_models_files/figure-html/lapsefix_model-6.png" class="img-fluid" width="1152"></p>
</div>
</div>
</section>
<section id="posterior-1" class="level3">
<h3 class="anchored" data-anchor-id="posterior-1">Posterior</h3>
<div class="cell" data-hash="03a_landmark_models_cache/html/landmark_lapsefix_error_time_target_posterior_6d8796a6ec1bb80ccf167da417b79171">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>landmark_lapsefix_error_time_target <span class="ot">&lt;-</span> <span class="fu">update</span>(</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  landmark_lapsefix_error_time_target_priors,</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">sample_prior =</span> <span class="st">"no"</span>,</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">refresh =</span> <span class="dv">0</span>,</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">1337</span>,</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"scripts"</span>, <span class="st">"for_osf"</span>, <span class="st">"tooluse_in_real"</span>, <span class="st">"models"</span>, <span class="st">"landmark_lapsefix_error_time_target.rds"</span>),</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">file_refit =</span> <span class="st">"on_change"</span>,</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">silent =</span> <span class="cn">TRUE</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(landmark_lapsefix_error_time_target)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: error_std ~ 0 + a + b * time + d 
         a ~ 0 + target
         b ~ 0 + target
         d ~ 0 + (0 + target + time + target:time | ppid)
   Data: landmark_fix (Number of observations: 900) 
  Draws: 16 chains, each with iter = 3000; warmup = 1000; thin = 1;
         total post-warmup draws = 32000

Group-Level Effects: 
~ppid (Number of levels: 25) 
                                                   Estimate Est.Error l-95% CI
sd(d_targetForearm)                                    0.46      0.08     0.32
sd(d_targetWrist)                                      0.79      0.12     0.58
sd(d_targetElbow)                                      0.75      0.12     0.55
sd(d_timePost)                                         0.40      0.10     0.22
sd(d_targetWrist:timePost)                             0.19      0.13     0.01
sd(d_targetElbow:timePost)                             0.43      0.16     0.09
cor(d_targetForearm,d_targetWrist)                     0.75      0.12     0.47
cor(d_targetForearm,d_targetElbow)                     0.35      0.19    -0.05
cor(d_targetWrist,d_targetElbow)                       0.03      0.19    -0.33
cor(d_targetForearm,d_timePost)                       -0.08      0.23    -0.51
cor(d_targetWrist,d_timePost)                         -0.09      0.22    -0.50
cor(d_targetElbow,d_timePost)                         -0.10      0.23    -0.53
cor(d_targetForearm,d_targetWrist:timePost)           -0.04      0.34    -0.69
cor(d_targetWrist,d_targetWrist:timePost)             -0.18      0.34    -0.76
cor(d_targetElbow,d_targetWrist:timePost)              0.08      0.34    -0.60
cor(d_timePost,d_targetWrist:timePost)                 0.03      0.36    -0.65
cor(d_targetForearm,d_targetElbow:timePost)           -0.11      0.27    -0.62
cor(d_targetWrist,d_targetElbow:timePost)             -0.10      0.25    -0.58
cor(d_targetElbow,d_targetElbow:timePost)             -0.43      0.24    -0.80
cor(d_timePost,d_targetElbow:timePost)                 0.12      0.30    -0.45
cor(d_targetWrist:timePost,d_targetElbow:timePost)    -0.05      0.36    -0.72
                                                   u-95% CI Rhat Bulk_ESS
sd(d_targetForearm)                                    0.65 1.00    16136
sd(d_targetWrist)                                      1.06 1.00    14335
sd(d_targetElbow)                                      1.03 1.00    14944
sd(d_timePost)                                         0.62 1.00    12133
sd(d_targetWrist:timePost)                             0.50 1.00     9396
sd(d_targetElbow:timePost)                             0.76 1.00     7554
cor(d_targetForearm,d_targetWrist)                     0.93 1.00    12834
cor(d_targetForearm,d_targetElbow)                     0.67 1.00    12403
cor(d_targetWrist,d_targetElbow)                       0.40 1.00    17334
cor(d_targetForearm,d_timePost)                        0.40 1.00    13965
cor(d_targetWrist,d_timePost)                          0.36 1.00    22404
cor(d_targetElbow,d_timePost)                          0.36 1.00    20456
cor(d_targetForearm,d_targetWrist:timePost)            0.62 1.00    38672
cor(d_targetWrist,d_targetWrist:timePost)              0.55 1.00    33917
cor(d_targetElbow,d_targetWrist:timePost)              0.70 1.00    30993
cor(d_timePost,d_targetWrist:timePost)                 0.70 1.00    24144
cor(d_targetForearm,d_targetElbow:timePost)            0.40 1.00    19191
cor(d_targetWrist,d_targetElbow:timePost)              0.39 1.00    32027
cor(d_targetElbow,d_targetElbow:timePost)              0.12 1.00    25438
cor(d_timePost,d_targetElbow:timePost)                 0.69 1.00    16463
cor(d_targetWrist:timePost,d_targetElbow:timePost)     0.65 1.00    12298
                                                   Tail_ESS
sd(d_targetForearm)                                   20702
sd(d_targetWrist)                                     19278
sd(d_targetElbow)                                     21216
sd(d_timePost)                                        14910
sd(d_targetWrist:timePost)                            17845
sd(d_targetElbow:timePost)                             6554
cor(d_targetForearm,d_targetWrist)                    19480
cor(d_targetForearm,d_targetElbow)                    18199
cor(d_targetWrist,d_targetElbow)                      21684
cor(d_targetForearm,d_timePost)                       20224
cor(d_targetWrist,d_timePost)                         25363
cor(d_targetElbow,d_timePost)                         25744
cor(d_targetForearm,d_targetWrist:timePost)           23448
cor(d_targetWrist,d_targetWrist:timePost)             22871
cor(d_targetElbow,d_targetWrist:timePost)             25327
cor(d_timePost,d_targetWrist:timePost)                25933
cor(d_targetForearm,d_targetElbow:timePost)           21016
cor(d_targetWrist,d_targetElbow:timePost)             25400
cor(d_targetElbow,d_targetElbow:timePost)             17175
cor(d_timePost,d_targetElbow:timePost)                21214
cor(d_targetWrist:timePost,d_targetElbow:timePost)    19911

Population-Level Effects: 
                Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
a_targetForearm     0.28      0.11     0.06     0.50 1.00    11301    17004
a_targetWrist       0.37      0.17     0.04     0.71 1.00    12168    17161
a_targetElbow      -0.32      0.16    -0.64     0.00 1.00    14143    18134
b_targetForearm    -0.17      0.11    -0.40     0.06 1.00    19746    22049
b_targetWrist      -0.29      0.13    -0.54    -0.05 1.00    19739    22226
b_targetElbow      -0.10      0.15    -0.39     0.20 1.00    17187    19511

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.68      0.02     0.65     0.72 1.00    33416    25009

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(landmark_lapsefix_error_time_target)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03a_landmark_models_files/figure-html/landmark_lapsefix_error_time_target_posterior-1.png" class="img-fluid" width="1152"></p>
</div>
<div class="cell-output-display">
<p><img src="03a_landmark_models_files/figure-html/landmark_lapsefix_error_time_target_posterior-2.png" class="img-fluid" width="1152"></p>
</div>
<div class="cell-output-display">
<p><img src="03a_landmark_models_files/figure-html/landmark_lapsefix_error_time_target_posterior-3.png" class="img-fluid" width="1152"></p>
</div>
<div class="cell-output-display">
<p><img src="03a_landmark_models_files/figure-html/landmark_lapsefix_error_time_target_posterior-4.png" class="img-fluid" width="1152"></p>
</div>
<div class="cell-output-display">
<p><img src="03a_landmark_models_files/figure-html/landmark_lapsefix_error_time_target_posterior-5.png" class="img-fluid" width="1152"></p>
</div>
<div class="cell-output-display">
<p><img src="03a_landmark_models_files/figure-html/landmark_lapsefix_error_time_target_posterior-6.png" class="img-fluid" width="1152"></p>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  landmark_lapsefix_error_time_target,</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">type  =</span> <span class="st">"dens_overlay_grouped"</span>,</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">ndraws =</span> <span class="dv">50</span>,</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">group =</span> <span class="st">"target"</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_tidybayes</span>() <span class="sc">+</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>()</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Landmark Task Errors"</span>,</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Posterior Draws vs. Empirical Distribution"</span>,</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Error (standardized)"</span></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03a_landmark_models_files/figure-html/landmark_lapsefix_error_time_target_posterior-7.png" class="img-fluid" width="1152"></p>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>landmark_describe <span class="ot">&lt;-</span> bayestestR<span class="sc">::</span><span class="fu">describe_posterior</span>(</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  landmark_lapsefix_error_time_target,</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">centrality =</span> <span class="st">"map"</span>,</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">ci_method=</span><span class="st">"hdi"</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> <span class="fu">as.data.table</span>()</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>landmark_describe</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           Parameter         MAP   CI     CI_low    CI_high        pd ROPE_CI
1: b_a_targetForearm  0.27569662 0.95  0.0618352  0.4969960 0.9927500    0.95
2:   b_a_targetWrist  0.38490125 0.95  0.0457498  0.7076570 0.9860000    0.95
3:   b_a_targetElbow -0.32725292 0.95 -0.6341540  0.0100534 0.9734375    0.95
4: b_b_targetForearm -0.17990465 0.95 -0.3981250  0.0527093 0.9294375    0.95
5:   b_b_targetWrist -0.30363784 0.95 -0.5438290 -0.0495349 0.9890000    0.95
6:   b_b_targetElbow -0.07703558 0.95 -0.3927080  0.1927090 0.7489062    0.95
   ROPE_low ROPE_high ROPE_Percentage     Rhat      ESS
1:     -0.1       0.1      0.02654605 1.000398 11239.70
2:     -0.1       0.1      0.02851974 1.000454 12114.79
3:     -0.1       0.1      0.06536184 1.000617 14078.54
4:     -0.1       0.1      0.25901316 1.000582 19606.06
5:     -0.1       0.1      0.03993421 1.000431 19675.24
6:     -0.1       0.1      0.44615132 1.000739 17010.27</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>landmark_bfs <span class="ot">&lt;-</span> landmark_lapsefix_error_time_target <span class="sc">%&gt;%</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bayesfactor_pointnull</span>(</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">direction =</span> <span class="st">"&gt;"</span>,</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">prior =</span> landmark_lapsefix_error_time_target_priors</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.table</span>()</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>(landmark_lapsefix_error_table <span class="ot">&lt;-</span> <span class="fu">merge</span>(</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>  landmark_bfs[Parameter <span class="sc">%in%</span> <span class="fu">c</span>(</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"b_b_targetElbow"</span>, </span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"b_b_targetWrist"</span>, </span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">"b_b_targetForearm"</span>),</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>    .(<span class="at">Parameter =</span> <span class="fu">fcase</span>(</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>        Parameter <span class="sc">==</span> <span class="st">"b_b_targetElbow"</span>, <span class="st">"Elbow"</span>,</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>        Parameter <span class="sc">==</span> <span class="st">"b_b_targetWrist"</span>, <span class="st">"Wrist"</span>,</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>        Parameter <span class="sc">==</span> <span class="st">"b_b_targetForearm"</span>, <span class="st">"Forearm"</span>),</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">BF =</span> <span class="fu">exp</span>(log_BF))],</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>    landmark_describe[</span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>      Parameter <span class="sc">%in%</span> <span class="fu">c</span>(</span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>        <span class="st">"b_b_targetElbow"</span>, </span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>        <span class="st">"b_b_targetWrist"</span>, </span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>        <span class="st">"b_b_targetForearm"</span></span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>        )][,</span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">Parameter :=</span> <span class="fu">fcase</span>(</span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>          Parameter <span class="sc">==</span> <span class="st">"b_b_targetElbow"</span>, <span class="st">"Elbow"</span>,</span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>          Parameter <span class="sc">==</span> <span class="st">"b_b_targetWrist"</span>, <span class="st">"Wrist"</span>,</span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a>          Parameter <span class="sc">==</span> <span class="st">"b_b_targetForearm"</span>, <span class="st">"Forearm"</span></span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a>          ],</span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">by =</span> <span class="st">"Parameter"</span></span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Parameter         BF         MAP   CI    CI_low    CI_high        pd ROPE_CI
1:     Elbow 0.04639735 -0.07703558 0.95 -0.392708  0.1927090 0.7489062    0.95
2:   Forearm 0.02402343 -0.17990465 0.95 -0.398125  0.0527093 0.9294375    0.95
3:     Wrist 0.02090069 -0.30363784 0.95 -0.543829 -0.0495349 0.9890000    0.95
   ROPE_low ROPE_high ROPE_Percentage     Rhat      ESS
1:     -0.1       0.1      0.44615132 1.000739 17010.27
2:     -0.1       0.1      0.25901316 1.000582 19606.06
3:     -0.1       0.1      0.03993421 1.000431 19675.24</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>landmark_lapsefix_error_table <span class="sc">%&gt;%</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(<span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"scripts"</span>, <span class="st">"for_osf"</span>, <span class="st">"tooluse_in_real"</span>, <span class="st">"tables"</span>, <span class="st">"landmark_table_lapsefix.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-hash="03a_landmark_models_cache/html/unnamed-chunk-1_d37eff1fa428e725083c7496cce833ba">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>model_params <span class="ot">&lt;-</span> landmark_error_table <span class="sc">%&gt;%</span> <span class="fu">select</span>(</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  Parameter,</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  BF,</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  MAP,</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  CI_low,</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>  CI_high</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="st">"Lower"</span> <span class="ot">=</span> CI_low,</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Upper"</span> <span class="ot">=</span> CI_high,</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Mode"</span> <span class="ot">=</span> MAP)</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a><span class="fu">fwrite</span>(model_params, here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"scripts"</span>, <span class="st">"for_osf"</span>, <span class="st">"tooluse_in_real"</span>, <span class="st">"tables"</span>, <span class="st">"landmark_model_params.csv"</span>))</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(model_params, here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"scripts"</span>, <span class="st">"for_osf"</span>, <span class="st">"tooluse_in_real"</span>, <span class="st">"tables"</span>, <span class="st">"landmark_model_params.rds"</span>))</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>lapsefix_model_params <span class="ot">&lt;-</span> landmark_lapsefix_error_table <span class="sc">%&gt;%</span> <span class="fu">select</span>(</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>  Parameter,</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>  BF,</span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>  MAP,</span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>  CI_low,</span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>  CI_high</span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="st">"Lower"</span> <span class="ot">=</span> CI_low,</span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Upper"</span> <span class="ot">=</span> CI_high,</span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Mode"</span> <span class="ot">=</span> MAP)</span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a><span class="fu">fwrite</span>(lapsefix_model_params, here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"scripts"</span>, <span class="st">"for_osf"</span>, <span class="st">"tooluse_in_real"</span>, <span class="st">"tables"</span>, <span class="st">"landmark_lapsefix_model_params.csv"</span>))</span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(lapsefix_model_params, here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"scripts"</span>, <span class="st">"for_osf"</span>, <span class="st">"tooluse_in_real"</span>, <span class="st">"tables"</span>, <span class="st">"landmark_lapsefix_model_params.rds"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>