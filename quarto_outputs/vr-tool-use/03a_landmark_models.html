<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.186">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Joshua Bell">

<title>VR - Bayesian Models - Landmark</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="03a_landmark_models_files/libs/clipboard/clipboard.min.js"></script>
<script src="03a_landmark_models_files/libs/quarto-html/quarto.js"></script>
<script src="03a_landmark_models_files/libs/quarto-html/popper.min.js"></script>
<script src="03a_landmark_models_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="03a_landmark_models_files/libs/quarto-html/anchor.min.js"></script>
<link href="03a_landmark_models_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="03a_landmark_models_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="03a_landmark_models_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="03a_landmark_models_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="03a_landmark_models_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#models" id="toc-models" class="nav-link active" data-scroll-target="#models">Models</a>
  <ul class="collapse">
  <li><a href="#posterior" id="toc-posterior" class="nav-link" data-scroll-target="#posterior">Posterior</a></li>
  <li><a href="#lapse-fix" id="toc-lapse-fix" class="nav-link" data-scroll-target="#lapse-fix">Lapse Fix</a>
  <ul class="collapse">
  <li><a href="#prior" id="toc-prior" class="nav-link" data-scroll-target="#prior">Prior</a></li>
  <li><a href="#posterior-1" id="toc-posterior-1" class="nav-link" data-scroll-target="#posterior-1">Posterior</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">VR - Bayesian Models - Landmark</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Joshua Bell </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> <span class="cn">TRUE</span>, </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">warning =</span> <span class="cn">FALSE</span>, </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">message =</span> <span class="cn">FALSE</span>,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">fig.width =</span> <span class="dv">12</span>, </span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">fig.height =</span> <span class="dv">8</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>pkgs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"dplyr"</span>, <span class="st">"readr"</span>, <span class="st">"magrittr"</span>, <span class="st">"data.table"</span>, <span class="st">"here"</span>, <span class="st">"brms"</span>, <span class="st">"cmdstanr"</span>, <span class="st">"bayestestR"</span>, <span class="st">"tidybayes"</span>, <span class="st">"ggplot2"</span>, <span class="st">"flextable"</span>, <span class="st">"officer"</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> pkgs){</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="sc">!</span>i <span class="sc">%in%</span> <span class="fu">rownames</span>(<span class="fu">installed.packages</span>())){ </span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">install.packages</span>(i) </span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">library</span>(i, <span class="at">character.only =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span>(<span class="fu">library</span>(i, <span class="at">character.only =</span> <span class="cn">TRUE</span>))</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="st">"mc.cores"</span> <span class="ot">=</span> parallel<span class="sc">::</span><span class="fu">detectCores</span>(), <span class="st">"brms.backend"</span> <span class="ot">=</span> <span class="st">"cmdstan"</span>)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>b <span class="ot">=</span> <span class="dv">16000</span><span class="sc">/</span>parallel<span class="sc">::</span><span class="fu">detectCores</span>()</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>i <span class="ot">=</span> <span class="dv">48000</span><span class="sc">/</span>parallel<span class="sc">::</span><span class="fu">detectCores</span>()</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>ch <span class="ot">=</span> parallel<span class="sc">::</span><span class="fu">detectCores</span>()</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>co <span class="ot">=</span> parallel<span class="sc">::</span><span class="fu">detectCores</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>landmark <span class="ot">&lt;-</span> <span class="fu">fread</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"study_one"</span>, <span class="st">"landmark.csv"</span>))</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>landmark_summary <span class="ot">&lt;-</span> landmark <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(ppid, trial, time,</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>                                        forearmlength, target,</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>                                        error, lapse_fix_target,</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>                                        lapse_fix_error) <span class="sc">%&gt;%</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span>ppid <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"d1-004"</span>, <span class="st">"d1-006"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">error_std =</span> datawizard<span class="sc">::</span><span class="fu">standardize</span>(error),</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">forearmlength_std =</span> datawizard<span class="sc">::</span><span class="fu">standardize</span>(forearmlength),</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">lapse_fix_error_std =</span> datawizard<span class="sc">::</span><span class="fu">standardize</span>(lapse_fix_error),</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">lapse_fix_target =</span> <span class="fu">factor</span>(</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>          lapse_fix_target,</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>          <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Forearm"</span>, <span class="st">"Wrist"</span>, <span class="st">"Elbow"</span>)),</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">time =</span> <span class="fu">factor</span>(time,</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>          <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"pre"</span>, <span class="st">"post"</span>),</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>          <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Pre"</span>, <span class="st">"Post"</span>)),</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">target =</span> <span class="fu">factor</span>(target,</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>          <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Forearm"</span>, <span class="st">"Wrist"</span>, <span class="st">"Elbow"</span>)))</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>landmark_fix <span class="ot">&lt;-</span> landmark_summary <span class="sc">%&gt;%</span> </span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>    ppid, trial, time,</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>    forearmlength_std,</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>    lapse_fix_target,</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>    lapse_fix_error_std</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">target =</span> lapse_fix_target,</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">error_std =</span> lapse_fix_error_std,</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>landmark_summary <span class="sc">%&gt;%</span></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(time, target) <span class="sc">%&gt;%</span></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">num_lapses =</span> <span class="fu">sum</span>(lapse_fix_target <span class="sc">!=</span> target),</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">num_trials =</span> <span class="fu">n</span>(),</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">lapse_rate =</span> num_lapses<span class="sc">/</span>num_trials</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
# Groups:   time [2]
  time  target  num_lapses num_trials lapse_rate
  &lt;fct&gt; &lt;fct&gt;        &lt;int&gt;      &lt;int&gt;      &lt;dbl&gt;
1 Pre   Forearm         10        132    0.0758 
2 Pre   Wrist            6        132    0.0455 
3 Pre   Elbow            2        132    0.0152 
4 Post  Forearm          7        132    0.0530 
5 Post  Wrist            1        132    0.00758
6 Post  Elbow            1        132    0.00758</code></pre>
</div>
</div>
<section id="models" class="level1">
<h1>Models</h1>
<p>In order to have an interaction parameter (and hypothesis test) for all three targets, brms’s nonlinear construction was used. ## Normal ### Prior</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>landmark_time_target_priors <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bf</span>(error_std <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> a <span class="sc">+</span> b <span class="sc">*</span> time <span class="sc">+</span> d,</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>     a <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> target,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>     b <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> target,</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>     d <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> (<span class="dv">0</span> <span class="sc">+</span> target <span class="sc">+</span> time <span class="sc">+</span> target <span class="sc">:</span> time <span class="sc">|</span> ppid),</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">nl =</span> <span class="cn">TRUE</span>),</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="st">"normal(0, 2)"</span>, <span class="at">nlpar =</span> <span class="st">"a"</span>),</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>               <span class="fu">prior</span>(<span class="st">"normal(.2, 2)"</span>, <span class="at">nlpar =</span> <span class="st">"b"</span>),</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>                <span class="co">#prior("normal(0, .5)", nlpar = "c"),</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="st">"exponential(1)"</span>, <span class="at">class =</span> <span class="st">"sd"</span>, <span class="at">nlpar =</span> <span class="st">"d"</span>),</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="st">"exponential(1)"</span>, <span class="at">class =</span> <span class="st">"sigma"</span>),</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>                <span class="fu">set_prior</span>(<span class="at">prior =</span> <span class="st">"lkj(1)"</span>, <span class="at">class =</span> <span class="st">"cor"</span>, <span class="at">group =</span> <span class="st">"ppid"</span>)),</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">data =</span> landmark_summary,</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>     <span class="at">sample_prior =</span> <span class="st">"only"</span>,</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>     <span class="at">seed =</span> <span class="dv">1337</span>,</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">silent =</span> <span class="cn">TRUE</span>, <span class="at">refresh =</span> <span class="dv">0</span>,</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>     <span class="at">save_pars =</span> <span class="fu">save_pars</span>(<span class="at">all =</span> <span class="cn">TRUE</span>),</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>     <span class="at">warmup =</span> b,</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>     <span class="at">iter =</span> i,</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>     <span class="at">chains =</span> ch,</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>     <span class="at">cores =</span> co,</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>     <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> .<span class="dv">975</span>, <span class="at">max_treedepth =</span> <span class="dv">15</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Running MCMC with 16 parallel chains...

Chain 1 finished in 2.9 seconds.
Chain 11 finished in 2.7 seconds.
Chain 2 finished in 2.9 seconds.
Chain 3 finished in 2.9 seconds.
Chain 4 finished in 2.9 seconds.
Chain 5 finished in 2.9 seconds.
Chain 7 finished in 2.8 seconds.
Chain 8 finished in 2.9 seconds.
Chain 9 finished in 2.9 seconds.
Chain 10 finished in 2.9 seconds.
Chain 6 finished in 3.0 seconds.
Chain 12 finished in 2.9 seconds.
Chain 13 finished in 2.9 seconds.
Chain 14 finished in 2.9 seconds.
Chain 15 finished in 2.9 seconds.
Chain 16 finished in 2.9 seconds.

All 16 chains finished successfully.
Mean chain execution time: 2.9 seconds.
Total execution time: 3.2 seconds.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(landmark_time_target_priors)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: error_std ~ 0 + a + b * time + d 
         a ~ 0 + target
         b ~ 0 + target
         d ~ 0 + (0 + target + time + target:time | ppid)
   Data: landmark_summary (Number of observations: 792) 
  Draws: 16 chains, each with iter = 3000; warmup = 1000; thin = 1;
         total post-warmup draws = 32000

Group-Level Effects: 
~ppid (Number of levels: 22) 
                                                   Estimate Est.Error l-95% CI
sd(d_targetForearm)                                    1.00      1.00     0.03
sd(d_targetWrist)                                      1.00      1.00     0.03
sd(d_targetElbow)                                      1.00      1.00     0.03
sd(d_timePost)                                         1.00      1.00     0.03
sd(d_targetWrist:timePost)                             1.00      0.99     0.03
sd(d_targetElbow:timePost)                             1.00      0.99     0.03
cor(d_targetForearm,d_targetWrist)                    -0.00      0.38    -0.70
cor(d_targetForearm,d_targetElbow)                    -0.00      0.38    -0.70
cor(d_targetWrist,d_targetElbow)                       0.00      0.38    -0.71
cor(d_targetForearm,d_timePost)                        0.00      0.38    -0.71
cor(d_targetWrist,d_timePost)                         -0.00      0.38    -0.70
cor(d_targetElbow,d_timePost)                         -0.00      0.38    -0.71
cor(d_targetForearm,d_targetWrist:timePost)            0.00      0.37    -0.70
cor(d_targetWrist,d_targetWrist:timePost)             -0.00      0.38    -0.71
cor(d_targetElbow,d_targetWrist:timePost)              0.00      0.38    -0.71
cor(d_timePost,d_targetWrist:timePost)                -0.00      0.38    -0.70
cor(d_targetForearm,d_targetElbow:timePost)            0.00      0.38    -0.70
cor(d_targetWrist,d_targetElbow:timePost)              0.00      0.38    -0.71
cor(d_targetElbow,d_targetElbow:timePost)             -0.00      0.38    -0.71
cor(d_timePost,d_targetElbow:timePost)                 0.00      0.38    -0.70
cor(d_targetWrist:timePost,d_targetElbow:timePost)     0.00      0.38    -0.71
                                                   u-95% CI Rhat Bulk_ESS
sd(d_targetForearm)                                    3.72 1.00    40949
sd(d_targetWrist)                                      3.72 1.00    41372
sd(d_targetElbow)                                      3.71 1.00    41038
sd(d_timePost)                                         3.69 1.00    40480
sd(d_targetWrist:timePost)                             3.65 1.00    41655
sd(d_targetElbow:timePost)                             3.65 1.00    39519
cor(d_targetForearm,d_targetWrist)                     0.70 1.00    78161
cor(d_targetForearm,d_targetElbow)                     0.71 1.00    75245
cor(d_targetWrist,d_targetElbow)                       0.71 1.00    43238
cor(d_targetForearm,d_timePost)                        0.71 1.00    72022
cor(d_targetWrist,d_timePost)                          0.70 1.00    42481
cor(d_targetElbow,d_timePost)                          0.70 1.00    30574
cor(d_targetForearm,d_targetWrist:timePost)            0.70 1.00    72744
cor(d_targetWrist,d_targetWrist:timePost)              0.70 1.00    42689
cor(d_targetElbow,d_targetWrist:timePost)              0.70 1.00    30429
cor(d_timePost,d_targetWrist:timePost)                 0.71 1.00    22146
cor(d_targetForearm,d_targetElbow:timePost)            0.71 1.00    78830
cor(d_targetWrist,d_targetElbow:timePost)              0.71 1.00    43136
cor(d_targetElbow,d_targetElbow:timePost)              0.71 1.00    32989
cor(d_timePost,d_targetElbow:timePost)                 0.70 1.00    21354
cor(d_targetWrist:timePost,d_targetElbow:timePost)     0.70 1.00    17879
                                                   Tail_ESS
sd(d_targetForearm)                                   17573
sd(d_targetWrist)                                     17935
sd(d_targetElbow)                                     18447
sd(d_timePost)                                        17762
sd(d_targetWrist:timePost)                            17780
sd(d_targetElbow:timePost)                            18423
cor(d_targetForearm,d_targetWrist)                    21763
cor(d_targetForearm,d_targetElbow)                    20904
cor(d_targetWrist,d_targetElbow)                      21445
cor(d_targetForearm,d_timePost)                       21187
cor(d_targetWrist,d_timePost)                         22565
cor(d_targetElbow,d_timePost)                         21015
cor(d_targetForearm,d_targetWrist:timePost)           22191
cor(d_targetWrist,d_targetWrist:timePost)             22038
cor(d_targetElbow,d_targetWrist:timePost)             22161
cor(d_timePost,d_targetWrist:timePost)                23728
cor(d_targetForearm,d_targetElbow:timePost)           21789
cor(d_targetWrist,d_targetElbow:timePost)             21999
cor(d_targetElbow,d_targetElbow:timePost)             22843
cor(d_timePost,d_targetElbow:timePost)                23502
cor(d_targetWrist:timePost,d_targetElbow:timePost)    23560

Population-Level Effects: 
                Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
a_targetForearm     0.01      1.99    -3.86     3.87 1.00    77599    22084
a_targetWrist      -0.00      2.00    -3.90     3.90 1.00    81280    23001
a_targetElbow       0.01      2.01    -3.93     3.95 1.00    76380    22988
b_targetForearm     0.21      1.99    -3.74     4.11 1.00    76807    20779
b_targetWrist       0.21      2.02    -3.78     4.18 1.00    78995    22650
b_targetElbow       0.20      1.99    -3.71     4.11 1.00    74477    22401

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.99      0.99     0.03     3.66 1.00    41390    17185

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(landmark_time_target_priors)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03a_landmark_models_files/figure-html/landmark-prior-1.png" class="img-fluid" width="1152"></p>
</div>
<div class="cell-output-display">
<p><img src="03a_landmark_models_files/figure-html/landmark-prior-2.png" class="img-fluid" width="1152"></p>
</div>
<div class="cell-output-display">
<p><img src="03a_landmark_models_files/figure-html/landmark-prior-3.png" class="img-fluid" width="1152"></p>
</div>
<div class="cell-output-display">
<p><img src="03a_landmark_models_files/figure-html/landmark-prior-4.png" class="img-fluid" width="1152"></p>
</div>
<div class="cell-output-display">
<p><img src="03a_landmark_models_files/figure-html/landmark-prior-5.png" class="img-fluid" width="1152"></p>
</div>
<div class="cell-output-display">
<p><img src="03a_landmark_models_files/figure-html/landmark-prior-6.png" class="img-fluid" width="1152"></p>
</div>
</div>
<section id="posterior" class="level3">
<h3 class="anchored" data-anchor-id="posterior">Posterior</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>landmark_time_target <span class="ot">&lt;-</span> <span class="fu">update</span>(</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  landmark_time_target_priors,</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">sample_prior =</span> <span class="st">"no"</span>,</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">refresh =</span> <span class="dv">0</span>,</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">1337</span>,</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"scripts"</span>, <span class="st">"for_osf"</span>, <span class="st">"tooluse_in_VR"</span>, <span class="st">"models"</span>, <span class="st">"landmark_error_time_target.rds"</span>),</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">file_refit =</span> <span class="st">"on_change"</span>,</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">silent =</span> <span class="cn">TRUE</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Running MCMC with 16 parallel chains...

Chain 12 finished in 43.7 seconds.
Chain 5 finished in 45.5 seconds.
Chain 10 finished in 45.5 seconds.
Chain 8 finished in 45.8 seconds.
Chain 6 finished in 46.1 seconds.
Chain 15 finished in 47.4 seconds.
Chain 7 finished in 48.1 seconds.
Chain 11 finished in 48.3 seconds.
Chain 9 finished in 48.3 seconds.
Chain 13 finished in 48.7 seconds.
Chain 16 finished in 48.6 seconds.
Chain 4 finished in 55.0 seconds.
Chain 3 finished in 55.3 seconds.
Chain 14 finished in 58.1 seconds.
Chain 2 finished in 62.0 seconds.
Chain 1 finished in 62.6 seconds.

All 16 chains finished successfully.
Mean chain execution time: 50.6 seconds.
Total execution time: 62.7 seconds.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(landmark_time_target)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: error_std ~ 0 + a + b * time + d 
         a ~ 0 + target
         b ~ 0 + target
         d ~ 0 + (0 + target + time + target:time | ppid)
   Data: landmark_summary (Number of observations: 792) 
  Draws: 16 chains, each with iter = 3000; warmup = 1000; thin = 1;
         total post-warmup draws = 32000

Group-Level Effects: 
~ppid (Number of levels: 22) 
                                                   Estimate Est.Error l-95% CI
sd(d_targetForearm)                                    0.66      0.10     0.49
sd(d_targetWrist)                                      0.85      0.14     0.62
sd(d_targetElbow)                                      0.56      0.11     0.38
sd(d_timePost)                                         0.43      0.10     0.25
sd(d_targetWrist:timePost)                             0.23      0.15     0.01
sd(d_targetElbow:timePost)                             0.31      0.15     0.03
cor(d_targetForearm,d_targetWrist)                     0.68      0.12     0.39
cor(d_targetForearm,d_targetElbow)                     0.66      0.14     0.33
cor(d_targetWrist,d_targetElbow)                       0.25      0.20    -0.16
cor(d_targetForearm,d_timePost)                       -0.36      0.20    -0.70
cor(d_targetWrist,d_timePost)                         -0.06      0.22    -0.47
cor(d_targetElbow,d_timePost)                         -0.35      0.22    -0.73
cor(d_targetForearm,d_targetWrist:timePost)           -0.01      0.32    -0.64
cor(d_targetWrist,d_targetWrist:timePost)             -0.12      0.33    -0.70
cor(d_targetElbow,d_targetWrist:timePost)             -0.16      0.33    -0.74
cor(d_timePost,d_targetWrist:timePost)                -0.03      0.34    -0.65
cor(d_targetForearm,d_targetElbow:timePost)            0.40      0.27    -0.24
cor(d_targetWrist,d_targetElbow:timePost)              0.17      0.29    -0.43
cor(d_targetElbow,d_targetElbow:timePost)              0.32      0.30    -0.32
cor(d_timePost,d_targetElbow:timePost)                -0.32      0.31    -0.81
cor(d_targetWrist:timePost,d_targetElbow:timePost)    -0.12      0.36    -0.75
                                                   u-95% CI Rhat Bulk_ESS
sd(d_targetForearm)                                    0.89 1.00    10553
sd(d_targetWrist)                                      1.16 1.00    11258
sd(d_targetElbow)                                      0.80 1.00    14785
sd(d_timePost)                                         0.65 1.00    13620
sd(d_targetWrist:timePost)                             0.58 1.00     7291
sd(d_targetElbow:timePost)                             0.63 1.00     7856
cor(d_targetForearm,d_targetWrist)                     0.87 1.00    11208
cor(d_targetForearm,d_targetElbow)                     0.88 1.00    15082
cor(d_targetWrist,d_targetElbow)                       0.61 1.00    16904
cor(d_targetForearm,d_timePost)                        0.06 1.00    16527
cor(d_targetWrist,d_timePost)                          0.37 1.00    19858
cor(d_targetElbow,d_timePost)                          0.11 1.00    14935
cor(d_targetForearm,d_targetWrist:timePost)            0.61 1.00    31279
cor(d_targetWrist,d_targetWrist:timePost)              0.55 1.00    32333
cor(d_targetElbow,d_targetWrist:timePost)              0.53 1.00    23759
cor(d_timePost,d_targetWrist:timePost)                 0.65 1.00    26161
cor(d_targetForearm,d_targetElbow:timePost)            0.82 1.00    23143
cor(d_targetWrist,d_targetElbow:timePost)              0.70 1.00    32583
cor(d_targetElbow,d_targetElbow:timePost)              0.82 1.00    24424
cor(d_timePost,d_targetElbow:timePost)                 0.38 1.00    18047
cor(d_targetWrist:timePost,d_targetElbow:timePost)     0.59 1.00    15817
                                                   Tail_ESS
sd(d_targetForearm)                                   16696
sd(d_targetWrist)                                     17197
sd(d_targetElbow)                                     19292
sd(d_timePost)                                        19599
sd(d_targetWrist:timePost)                            13425
sd(d_targetElbow:timePost)                             8590
cor(d_targetForearm,d_targetWrist)                    17453
cor(d_targetForearm,d_targetElbow)                    20143
cor(d_targetWrist,d_targetElbow)                      22983
cor(d_targetForearm,d_timePost)                       21691
cor(d_targetWrist,d_timePost)                         23509
cor(d_targetElbow,d_timePost)                         21976
cor(d_targetForearm,d_targetWrist:timePost)           23569
cor(d_targetWrist,d_targetWrist:timePost)             23831
cor(d_targetElbow,d_targetWrist:timePost)             21770
cor(d_timePost,d_targetWrist:timePost)                24789
cor(d_targetForearm,d_targetElbow:timePost)           18313
cor(d_targetWrist,d_targetElbow:timePost)             24689
cor(d_targetElbow,d_targetElbow:timePost)             21582
cor(d_timePost,d_targetElbow:timePost)                20025
cor(d_targetWrist:timePost,d_targetElbow:timePost)    20619

Population-Level Effects: 
                Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
a_targetForearm     0.15      0.15    -0.15     0.45 1.00     5787    10261
a_targetWrist       0.22      0.19    -0.15     0.60 1.00     7183    13156
a_targetElbow      -0.38      0.13    -0.65    -0.12 1.00     9066    15491
b_targetForearm    -0.25      0.12    -0.50    -0.01 1.00    13404    18087
b_targetWrist       0.20      0.14    -0.07     0.46 1.00    13944    19769
b_targetElbow       0.08      0.13    -0.17     0.33 1.00    17577    20782

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.67      0.02     0.63     0.71 1.00    32612    23670

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(landmark_time_target)</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  landmark_time_target,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"dens_overlay_grouped"</span>, </span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">ndraws =</span> <span class="dv">50</span>,</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">group =</span> <span class="st">"target"</span>) <span class="sc">+</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_tidybayes</span>() <span class="sc">+</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>()</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Landmark Task Errors"</span>,</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Posterior Draws vs. Empirical Distribution"</span>,</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Error (standardized)"</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03a_landmark_models_files/figure-html/landmark-posterior-1.png" class="img-fluid" width="1152"></p>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>landmark_describe <span class="ot">&lt;-</span> bayestestR<span class="sc">::</span><span class="fu">describe_posterior</span>(</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  landmark_time_target,</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">centrality =</span> <span class="st">"map"</span>,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">ci_method=</span><span class="st">"hdi"</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> <span class="fu">as.data.table</span>()</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>landmark_describe</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           Parameter         MAP   CI     CI_low     CI_high        pd ROPE_CI
1: b_a_targetForearm  0.15144495 0.95 -0.1509170  0.45010800 0.8345312    0.95
2:   b_a_targetWrist  0.24913059 0.95 -0.1476310  0.60011000 0.8793437    0.95
3:   b_a_targetElbow -0.37855006 0.95 -0.6436930 -0.11402000 0.9962813    0.95
4: b_b_targetForearm -0.26108387 0.95 -0.4952640 -0.00890153 0.9782500    0.95
5:   b_b_targetWrist  0.20803180 0.95 -0.0682525  0.46491600 0.9303438    0.95
6:   b_b_targetElbow  0.09065071 0.95 -0.1703890  0.32580900 0.7436250    0.95
   ROPE_low ROPE_high ROPE_Percentage     Rhat       ESS
1:     -0.1       0.1      0.34509868 1.001740  5729.150
2:     -0.1       0.1      0.22084800 1.001371  7074.626
3:     -0.1       0.1      0.00000000 1.000613  9003.578
4:     -0.1       0.1      0.09098684 1.001269 13250.168
5:     -0.1       0.1      0.21868421 1.000951 13780.017
6:     -0.1       0.1      0.50898026 1.000846 17407.135</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>landmark_bfs <span class="ot">&lt;-</span> landmark_time_target <span class="sc">%&gt;%</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bayesfactor_pointnull</span>(</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">direction =</span> <span class="st">"&gt;"</span>,</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">prior =</span> landmark_time_target_priors</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.table</span>()</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>(landmark_error_table <span class="ot">&lt;-</span> <span class="fu">merge</span>(</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  landmark_bfs[Parameter <span class="sc">%in%</span> <span class="fu">c</span>(</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"b_b_targetElbow"</span>, </span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"b_b_targetWrist"</span>, </span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">"b_b_targetForearm"</span>),</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>    .(<span class="at">Parameter =</span> <span class="fu">fcase</span>(</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>        Parameter <span class="sc">==</span> <span class="st">"b_b_targetElbow"</span>, <span class="st">"Elbow"</span>,</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>        Parameter <span class="sc">==</span> <span class="st">"b_b_targetWrist"</span>, <span class="st">"Wrist"</span>,</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>        Parameter <span class="sc">==</span> <span class="st">"b_b_targetForearm"</span>, <span class="st">"Forearm"</span>),</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">BF =</span> <span class="fu">exp</span>(log_BF))],</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>    landmark_describe[</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>      Parameter <span class="sc">%in%</span> <span class="fu">c</span>(</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>        <span class="st">"b_b_targetElbow"</span>, </span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>        <span class="st">"b_b_targetWrist"</span>, </span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>        <span class="st">"b_b_targetForearm"</span></span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>        )][,</span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">Parameter :=</span> <span class="fu">fcase</span>(</span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>          Parameter <span class="sc">==</span> <span class="st">"b_b_targetElbow"</span>, <span class="st">"Elbow"</span>,</span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>          Parameter <span class="sc">==</span> <span class="st">"b_b_targetWrist"</span>, <span class="st">"Wrist"</span>,</span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>          Parameter <span class="sc">==</span> <span class="st">"b_b_targetForearm"</span>, <span class="st">"Forearm"</span></span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>          ],</span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">by =</span> <span class="st">"Parameter"</span></span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Parameter         BF         MAP   CI     CI_low     CI_high        pd
1:     Elbow 0.10481707  0.09065071 0.95 -0.1703890  0.32580900 0.7436250
2:   Forearm 0.01986817 -0.26108387 0.95 -0.4952640 -0.00890153 0.9782500
3:     Wrist 0.35327182  0.20803180 0.95 -0.0682525  0.46491600 0.9303438
   ROPE_CI ROPE_low ROPE_high ROPE_Percentage     Rhat      ESS
1:    0.95     -0.1       0.1      0.50898026 1.000846 17407.13
2:    0.95     -0.1       0.1      0.09098684 1.001269 13250.17
3:    0.95     -0.1       0.1      0.21868421 1.000951 13780.02</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(landmark_error_table, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"scripts"</span>, <span class="st">"for_osf"</span>, <span class="st">"tooluse_in_VR"</span>, <span class="st">"tables"</span>, <span class="st">"landmark_table.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="lapse-fix" class="level2">
<h2 class="anchored" data-anchor-id="lapse-fix">Lapse Fix</h2>
<section id="prior" class="level3">
<h3 class="anchored" data-anchor-id="prior">Prior</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>landmark_lapsefix_error_time_target_priors <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bf</span>(error_std <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> a <span class="sc">+</span> b <span class="sc">*</span> time <span class="sc">+</span> d,</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>     a <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> target,</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>     b <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> target,</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>     d <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> (<span class="dv">0</span> <span class="sc">+</span> target <span class="sc">+</span> time <span class="sc">+</span> target <span class="sc">:</span> time <span class="sc">|</span> ppid),</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">nl =</span> <span class="cn">TRUE</span>),</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="st">"normal(0, 2)"</span>, <span class="at">nlpar =</span> <span class="st">"a"</span>),</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>               <span class="fu">prior</span>(<span class="st">"normal(0, 2)"</span>, <span class="at">nlpar =</span> <span class="st">"b"</span>),</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="st">"exponential(1)"</span>, <span class="at">class =</span> <span class="st">"sd"</span>, <span class="at">nlpar =</span> <span class="st">"d"</span>),</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="st">"exponential(1)"</span>, <span class="at">class =</span> <span class="st">"sigma"</span>)),</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">data =</span> landmark_fix,</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">sample_prior =</span> <span class="st">"only"</span>,</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">seed =</span> <span class="dv">1337</span>,</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>     <span class="at">silent =</span> <span class="cn">TRUE</span>, <span class="at">refresh =</span> <span class="dv">0</span>,</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>     <span class="at">save_pars =</span> <span class="fu">save_pars</span>(<span class="at">all =</span> <span class="cn">TRUE</span>),</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">warmup =</span> b,</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>     <span class="at">iter =</span> i,</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>     <span class="at">chains =</span> ch,</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>     <span class="at">cores =</span> co,</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>     <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> .<span class="dv">975</span>, <span class="at">max_treedepth =</span> <span class="dv">15</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Running MCMC with 16 parallel chains...

Chain 1 finished in 3.0 seconds.
Chain 2 finished in 3.0 seconds.
Chain 3 finished in 3.0 seconds.
Chain 8 finished in 3.0 seconds.
Chain 4 finished in 3.1 seconds.
Chain 5 finished in 3.1 seconds.
Chain 6 finished in 3.1 seconds.
Chain 7 finished in 3.0 seconds.
Chain 9 finished in 3.0 seconds.
Chain 10 finished in 3.0 seconds.
Chain 11 finished in 3.0 seconds.
Chain 12 finished in 3.0 seconds.
Chain 13 finished in 2.9 seconds.
Chain 14 finished in 3.0 seconds.
Chain 15 finished in 3.1 seconds.
Chain 16 finished in 3.0 seconds.

All 16 chains finished successfully.
Mean chain execution time: 3.0 seconds.
Total execution time: 3.3 seconds.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(landmark_lapsefix_error_time_target_priors)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: error_std ~ 0 + a + b * time + d 
         a ~ 0 + target
         b ~ 0 + target
         d ~ 0 + (0 + target + time + target:time | ppid)
   Data: landmark_fix (Number of observations: 792) 
  Draws: 16 chains, each with iter = 3000; warmup = 1000; thin = 1;
         total post-warmup draws = 32000

Group-Level Effects: 
~ppid (Number of levels: 22) 
                                                   Estimate Est.Error l-95% CI
sd(d_targetForearm)                                    1.00      1.00     0.02
sd(d_targetWrist)                                      0.99      0.99     0.03
sd(d_targetElbow)                                      1.00      0.99     0.03
sd(d_timePost)                                         1.00      1.00     0.02
sd(d_targetWrist:timePost)                             1.00      0.99     0.02
sd(d_targetElbow:timePost)                             1.00      1.00     0.03
cor(d_targetForearm,d_targetWrist)                     0.00      0.38    -0.71
cor(d_targetForearm,d_targetElbow)                     0.00      0.38    -0.70
cor(d_targetWrist,d_targetElbow)                       0.00      0.38    -0.70
cor(d_targetForearm,d_timePost)                       -0.00      0.38    -0.71
cor(d_targetWrist,d_timePost)                         -0.00      0.38    -0.71
cor(d_targetElbow,d_timePost)                         -0.00      0.38    -0.71
cor(d_targetForearm,d_targetWrist:timePost)            0.00      0.38    -0.70
cor(d_targetWrist,d_targetWrist:timePost)             -0.00      0.38    -0.71
cor(d_targetElbow,d_targetWrist:timePost)              0.00      0.38    -0.70
cor(d_timePost,d_targetWrist:timePost)                 0.00      0.38    -0.71
cor(d_targetForearm,d_targetElbow:timePost)            0.00      0.38    -0.70
cor(d_targetWrist,d_targetElbow:timePost)              0.00      0.38    -0.70
cor(d_targetElbow,d_targetElbow:timePost)             -0.00      0.38    -0.71
cor(d_timePost,d_targetElbow:timePost)                -0.00      0.38    -0.71
cor(d_targetWrist:timePost,d_targetElbow:timePost)     0.01      0.38    -0.70
                                                   u-95% CI Rhat Bulk_ESS
sd(d_targetForearm)                                    3.72 1.00    42850
sd(d_targetWrist)                                      3.65 1.00    42385
sd(d_targetElbow)                                      3.68 1.00    42928
sd(d_timePost)                                         3.71 1.00    45070
sd(d_targetWrist:timePost)                             3.69 1.00    44469
sd(d_targetElbow:timePost)                             3.69 1.00    44055
cor(d_targetForearm,d_targetWrist)                     0.71 1.00    84389
cor(d_targetForearm,d_targetElbow)                     0.71 1.00    75180
cor(d_targetWrist,d_targetElbow)                       0.70 1.00    42990
cor(d_targetForearm,d_timePost)                        0.70 1.00    79775
cor(d_targetWrist,d_timePost)                          0.71 1.00    44114
cor(d_targetElbow,d_timePost)                          0.71 1.00    30245
cor(d_targetForearm,d_targetWrist:timePost)            0.70 1.00    79022
cor(d_targetWrist,d_targetWrist:timePost)              0.70 1.00    40735
cor(d_targetElbow,d_targetWrist:timePost)              0.71 1.00    29101
cor(d_timePost,d_targetWrist:timePost)                 0.71 1.00    21670
cor(d_targetForearm,d_targetElbow:timePost)            0.71 1.00    80880
cor(d_targetWrist,d_targetElbow:timePost)              0.71 1.00    41577
cor(d_targetElbow,d_targetElbow:timePost)              0.71 1.00    32614
cor(d_timePost,d_targetElbow:timePost)                 0.70 1.00    20967
cor(d_targetWrist:timePost,d_targetElbow:timePost)     0.70 1.00    18043
                                                   Tail_ESS
sd(d_targetForearm)                                   18310
sd(d_targetWrist)                                     19122
sd(d_targetElbow)                                     18442
sd(d_timePost)                                        18468
sd(d_targetWrist:timePost)                            18535
sd(d_targetElbow:timePost)                            18431
cor(d_targetForearm,d_targetWrist)                    21209
cor(d_targetForearm,d_targetElbow)                    20436
cor(d_targetWrist,d_targetElbow)                      21944
cor(d_targetForearm,d_timePost)                       21084
cor(d_targetWrist,d_timePost)                         22107
cor(d_targetElbow,d_timePost)                         20757
cor(d_targetForearm,d_targetWrist:timePost)           22045
cor(d_targetWrist,d_targetWrist:timePost)             21033
cor(d_targetElbow,d_targetWrist:timePost)             22413
cor(d_timePost,d_targetWrist:timePost)                23154
cor(d_targetForearm,d_targetElbow:timePost)           20949
cor(d_targetWrist,d_targetElbow:timePost)             21611
cor(d_targetElbow,d_targetElbow:timePost)             23680
cor(d_timePost,d_targetElbow:timePost)                24303
cor(d_targetWrist:timePost,d_targetElbow:timePost)    23909

Population-Level Effects: 
                Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
a_targetForearm     0.00      1.97    -3.85     3.85 1.00    81359    22969
a_targetWrist      -0.01      1.98    -3.86     3.82 1.00    80937    22057
a_targetElbow       0.01      1.98    -3.89     3.92 1.00    82942    22497
b_targetForearm     0.01      1.99    -3.91     3.92 1.00    86002    21643
b_targetWrist       0.00      2.01    -3.94     3.96 1.00    85534    22352
b_targetElbow       0.01      2.00    -3.90     3.95 1.00    77215    23368

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     1.00      0.99     0.03     3.63 1.00    44380    17956

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(landmark_lapsefix_error_time_target_priors)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03a_landmark_models_files/figure-html/lapsefix_model-1.png" class="img-fluid" width="1152"></p>
</div>
<div class="cell-output-display">
<p><img src="03a_landmark_models_files/figure-html/lapsefix_model-2.png" class="img-fluid" width="1152"></p>
</div>
<div class="cell-output-display">
<p><img src="03a_landmark_models_files/figure-html/lapsefix_model-3.png" class="img-fluid" width="1152"></p>
</div>
<div class="cell-output-display">
<p><img src="03a_landmark_models_files/figure-html/lapsefix_model-4.png" class="img-fluid" width="1152"></p>
</div>
<div class="cell-output-display">
<p><img src="03a_landmark_models_files/figure-html/lapsefix_model-5.png" class="img-fluid" width="1152"></p>
</div>
<div class="cell-output-display">
<p><img src="03a_landmark_models_files/figure-html/lapsefix_model-6.png" class="img-fluid" width="1152"></p>
</div>
</div>
</section>
<section id="posterior-1" class="level3">
<h3 class="anchored" data-anchor-id="posterior-1">Posterior</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>landmark_lapsefix_error_time_target <span class="ot">&lt;-</span> <span class="fu">update</span>(</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  landmark_lapsefix_error_time_target_priors,</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">sample_prior =</span> <span class="st">"no"</span>,</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">refresh =</span> <span class="dv">0</span>,</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">1337</span>,</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"scripts"</span>, <span class="st">"for_osf"</span>, <span class="st">"tooluse_in_VR"</span>, <span class="st">"models"</span>, <span class="st">"landmark_lapsefix_error_time_target.rds"</span>),</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">file_refit =</span> <span class="st">"on_change"</span>,</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">silent =</span> <span class="cn">TRUE</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Running MCMC with 16 parallel chains...

Chain 9 finished in 45.9 seconds.
Chain 15 finished in 47.4 seconds.
Chain 6 finished in 49.0 seconds.
Chain 10 finished in 51.0 seconds.
Chain 11 finished in 51.0 seconds.
Chain 13 finished in 52.2 seconds.
Chain 7 finished in 55.2 seconds.
Chain 16 finished in 55.1 seconds.
Chain 5 finished in 56.3 seconds.
Chain 1 finished in 57.3 seconds.
Chain 12 finished in 57.7 seconds.
Chain 4 finished in 63.6 seconds.
Chain 8 finished in 63.7 seconds.
Chain 14 finished in 64.4 seconds.
Chain 2 finished in 64.7 seconds.
Chain 3 finished in 66.0 seconds.

All 16 chains finished successfully.
Mean chain execution time: 56.3 seconds.
Total execution time: 66.2 seconds.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(landmark_lapsefix_error_time_target)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: error_std ~ 0 + a + b * time + d 
         a ~ 0 + target
         b ~ 0 + target
         d ~ 0 + (0 + target + time + target:time | ppid)
   Data: landmark_fix (Number of observations: 792) 
  Draws: 16 chains, each with iter = 3000; warmup = 1000; thin = 1;
         total post-warmup draws = 32000

Group-Level Effects: 
~ppid (Number of levels: 22) 
                                                   Estimate Est.Error l-95% CI
sd(d_targetForearm)                                    0.59      0.10     0.43
sd(d_targetWrist)                                      0.82      0.14     0.60
sd(d_targetElbow)                                      0.59      0.11     0.41
sd(d_timePost)                                         0.39      0.10     0.20
sd(d_targetWrist:timePost)                             0.29      0.17     0.02
sd(d_targetElbow:timePost)                             0.39      0.16     0.06
cor(d_targetForearm,d_targetWrist)                     0.64      0.14     0.33
cor(d_targetForearm,d_targetElbow)                     0.67      0.14     0.33
cor(d_targetWrist,d_targetElbow)                       0.26      0.20    -0.16
cor(d_targetForearm,d_timePost)                       -0.31      0.21    -0.67
cor(d_targetWrist,d_timePost)                          0.10      0.23    -0.35
cor(d_targetElbow,d_timePost)                         -0.30      0.23    -0.70
cor(d_targetForearm,d_targetWrist:timePost)           -0.04      0.31    -0.64
cor(d_targetWrist,d_targetWrist:timePost)             -0.08      0.31    -0.64
cor(d_targetElbow,d_targetWrist:timePost)             -0.18      0.31    -0.73
cor(d_timePost,d_targetWrist:timePost)                 0.07      0.33    -0.56
cor(d_targetForearm,d_targetElbow:timePost)            0.29      0.26    -0.27
cor(d_targetWrist,d_targetElbow:timePost)              0.13      0.27    -0.41
cor(d_targetElbow,d_targetElbow:timePost)              0.24      0.28    -0.32
cor(d_timePost,d_targetElbow:timePost)                -0.36      0.29    -0.80
cor(d_targetWrist:timePost,d_targetElbow:timePost)    -0.29      0.33    -0.82
                                                   u-95% CI Rhat Bulk_ESS
sd(d_targetForearm)                                    0.81 1.00    11493
sd(d_targetWrist)                                      1.14 1.00    11013
sd(d_targetElbow)                                      0.83 1.00    14380
sd(d_timePost)                                         0.60 1.00    11255
sd(d_targetWrist:timePost)                             0.64 1.00     5212
sd(d_targetElbow:timePost)                             0.73 1.00     5500
cor(d_targetForearm,d_targetWrist)                     0.85 1.00    11539
cor(d_targetForearm,d_targetElbow)                     0.88 1.00    14134
cor(d_targetWrist,d_targetElbow)                       0.61 1.00    18220
cor(d_targetForearm,d_timePost)                        0.16 1.00    16314
cor(d_targetWrist,d_timePost)                          0.54 1.00    20591
cor(d_targetElbow,d_timePost)                          0.18 1.00    19679
cor(d_targetForearm,d_targetWrist:timePost)            0.54 1.00    25951
cor(d_targetWrist,d_targetWrist:timePost)              0.54 1.00    28694
cor(d_targetElbow,d_targetWrist:timePost)              0.48 1.00    21424
cor(d_timePost,d_targetWrist:timePost)                 0.70 1.00    22660
cor(d_targetForearm,d_targetElbow:timePost)            0.73 1.00    23441
cor(d_targetWrist,d_targetElbow:timePost)              0.63 1.00    28699
cor(d_targetElbow,d_targetElbow:timePost)              0.75 1.00    20379
cor(d_timePost,d_targetElbow:timePost)                 0.33 1.00    12185
cor(d_targetWrist:timePost,d_targetElbow:timePost)     0.44 1.00    11666
                                                   Tail_ESS
sd(d_targetForearm)                                   18340
sd(d_targetWrist)                                     16109
sd(d_targetElbow)                                     19163
sd(d_timePost)                                        14093
sd(d_targetWrist:timePost)                             8354
sd(d_targetElbow:timePost)                             5167
cor(d_targetForearm,d_targetWrist)                    17294
cor(d_targetForearm,d_targetElbow)                    20250
cor(d_targetWrist,d_targetElbow)                      22174
cor(d_targetForearm,d_timePost)                       20704
cor(d_targetWrist,d_timePost)                         24294
cor(d_targetElbow,d_timePost)                         22502
cor(d_targetForearm,d_targetWrist:timePost)           18065
cor(d_targetWrist,d_targetWrist:timePost)             22894
cor(d_targetElbow,d_targetWrist:timePost)             21569
cor(d_timePost,d_targetWrist:timePost)                23380
cor(d_targetForearm,d_targetElbow:timePost)           18301
cor(d_targetWrist,d_targetElbow:timePost)             22593
cor(d_targetElbow,d_targetElbow:timePost)             22474
cor(d_timePost,d_targetElbow:timePost)                17053
cor(d_targetWrist:timePost,d_targetElbow:timePost)    15781

Population-Level Effects: 
                Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
a_targetForearm     0.24      0.14    -0.04     0.52 1.00     6570    11930
a_targetWrist       0.25      0.19    -0.12     0.62 1.00     7708    12715
a_targetElbow      -0.48      0.14    -0.76    -0.21 1.00     8884    14965
b_targetForearm    -0.31      0.12    -0.54    -0.08 1.00    15679    19140
b_targetWrist       0.17      0.14    -0.10     0.45 1.00    16163    20051
b_targetElbow       0.10      0.12    -0.15     0.34 1.00    20432    21894

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.64      0.02     0.61     0.68 1.00    28221    23030

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(landmark_lapsefix_error_time_target)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03a_landmark_models_files/figure-html/landmark_lapsefix_error_time_target_posterior-1.png" class="img-fluid" width="1152"></p>
</div>
<div class="cell-output-display">
<p><img src="03a_landmark_models_files/figure-html/landmark_lapsefix_error_time_target_posterior-2.png" class="img-fluid" width="1152"></p>
</div>
<div class="cell-output-display">
<p><img src="03a_landmark_models_files/figure-html/landmark_lapsefix_error_time_target_posterior-3.png" class="img-fluid" width="1152"></p>
</div>
<div class="cell-output-display">
<p><img src="03a_landmark_models_files/figure-html/landmark_lapsefix_error_time_target_posterior-4.png" class="img-fluid" width="1152"></p>
</div>
<div class="cell-output-display">
<p><img src="03a_landmark_models_files/figure-html/landmark_lapsefix_error_time_target_posterior-5.png" class="img-fluid" width="1152"></p>
</div>
<div class="cell-output-display">
<p><img src="03a_landmark_models_files/figure-html/landmark_lapsefix_error_time_target_posterior-6.png" class="img-fluid" width="1152"></p>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  landmark_lapsefix_error_time_target,</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">type  =</span> <span class="st">"dens_overlay_grouped"</span>,</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">ndraws =</span> <span class="dv">50</span>,</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">group =</span> <span class="st">"target"</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_tidybayes</span>() <span class="sc">+</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>()</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Landmark Task Errors"</span>,</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Posterior Draws vs. Empirical Distribution"</span>,</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Error (standardized)"</span></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03a_landmark_models_files/figure-html/landmark_lapsefix_error_time_target_posterior-7.png" class="img-fluid" width="1152"></p>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>landmark_describe <span class="ot">&lt;-</span> bayestestR<span class="sc">::</span><span class="fu">describe_posterior</span>(</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  landmark_lapsefix_error_time_target,</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">centrality =</span> <span class="st">"map"</span>,</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">ci_method=</span><span class="st">"hdi"</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> <span class="fu">as.data.table</span>()</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>landmark_describe</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           Parameter         MAP   CI     CI_low    CI_high        pd ROPE_CI
1: b_a_targetForearm  0.21699439 0.95 -0.0343246  0.5209350 0.9572500    0.95
2:   b_a_targetWrist  0.26509569 0.95 -0.1143240  0.6233090 0.9154062    0.95
3:   b_a_targetElbow -0.47266751 0.95 -0.7627760 -0.2131380 0.9991250    0.95
4: b_b_targetForearm -0.30860263 0.95 -0.5441620 -0.0843318 0.9943750    0.95
5:   b_b_targetWrist  0.17476854 0.95 -0.1032330  0.4420300 0.8994062    0.95
6:   b_b_targetElbow  0.09807743 0.95 -0.1377360  0.3522060 0.7912813    0.95
   ROPE_low ROPE_high ROPE_Percentage     Rhat       ESS
1:     -0.1       0.1      0.13292763 1.002336  6537.360
2:     -0.1       0.1      0.17947368 1.001608  7677.990
3:     -0.1       0.1      0.00000000 1.001901  8810.609
4:     -0.1       0.1      0.01253289 1.000019 15489.863
5:     -0.1       0.1      0.28046053 1.000236 16063.670
6:     -0.1       0.1      0.47608553 1.000352 20217.783</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>landmark_bfs <span class="ot">&lt;-</span> landmark_lapsefix_error_time_target <span class="sc">%&gt;%</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bayesfactor_pointnull</span>(</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">direction =</span> <span class="st">"&gt;"</span>,</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">prior =</span> landmark_lapsefix_error_time_target_priors</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.table</span>()</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>(landmark_lapsefix_error_table <span class="ot">&lt;-</span> <span class="fu">merge</span>(</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>  landmark_bfs[Parameter <span class="sc">%in%</span> <span class="fu">c</span>(</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"b_b_targetElbow"</span>, </span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"b_b_targetWrist"</span>, </span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">"b_b_targetForearm"</span>),</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>    .(<span class="at">Parameter =</span> <span class="fu">fcase</span>(</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>        Parameter <span class="sc">==</span> <span class="st">"b_b_targetElbow"</span>, <span class="st">"Elbow"</span>,</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>        Parameter <span class="sc">==</span> <span class="st">"b_b_targetWrist"</span>, <span class="st">"Wrist"</span>,</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>        Parameter <span class="sc">==</span> <span class="st">"b_b_targetForearm"</span>, <span class="st">"Forearm"</span>),</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">BF =</span> <span class="fu">exp</span>(log_BF))],</span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>    landmark_describe[</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>      Parameter <span class="sc">%in%</span> <span class="fu">c</span>(</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>        <span class="st">"b_b_targetElbow"</span>, </span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>        <span class="st">"b_b_targetWrist"</span>, </span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>        <span class="st">"b_b_targetForearm"</span></span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>        )][,</span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">Parameter :=</span> <span class="fu">fcase</span>(</span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>          Parameter <span class="sc">==</span> <span class="st">"b_b_targetElbow"</span>, <span class="st">"Elbow"</span>,</span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>          Parameter <span class="sc">==</span> <span class="st">"b_b_targetWrist"</span>, <span class="st">"Wrist"</span>,</span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>          Parameter <span class="sc">==</span> <span class="st">"b_b_targetForearm"</span>, <span class="st">"Forearm"</span></span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a>          ],</span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">by =</span> <span class="st">"Parameter"</span></span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Parameter         BF         MAP   CI    CI_low    CI_high        pd ROPE_CI
1:     Elbow 0.13619628  0.09807743 0.95 -0.137736  0.3522060 0.7912813    0.95
2:   Forearm 0.02042891 -0.30860263 0.95 -0.544162 -0.0843318 0.9943750    0.95
3:     Wrist 0.27982369  0.17476854 0.95 -0.103233  0.4420300 0.8994062    0.95
   ROPE_low ROPE_high ROPE_Percentage     Rhat      ESS
1:     -0.1       0.1      0.47608553 1.000352 20217.78
2:     -0.1       0.1      0.01253289 1.000019 15489.86
3:     -0.1       0.1      0.28046053 1.000236 16063.67</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>landmark_lapsefix_error_table <span class="sc">%&gt;%</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(<span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"scripts"</span>, <span class="st">"for_osf"</span>, <span class="st">"tooluse_in_VR"</span>, <span class="st">"tables"</span>, <span class="st">"landmark_table_lapsefix.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>model_params <span class="ot">&lt;-</span> landmark_error_table <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  Parameter,</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  BF,</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  MAP,</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  CI_low,</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  CI_high</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="st">"Lower"</span> <span class="ot">=</span> CI_low,</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Upper"</span> <span class="ot">=</span> CI_high,</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Mode"</span> <span class="ot">=</span> MAP)</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a><span class="fu">fwrite</span>(model_params, here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"scripts"</span>, <span class="st">"for_osf"</span>, <span class="st">"tooluse_in_vr"</span>, <span class="st">"tables"</span>, <span class="st">"landmark_model_params.csv"</span>))</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(model_params, here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"scripts"</span>, <span class="st">"for_osf"</span>, <span class="st">"tooluse_in_vr"</span>, <span class="st">"tables"</span>, <span class="st">"landmark_model_params.rds"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>