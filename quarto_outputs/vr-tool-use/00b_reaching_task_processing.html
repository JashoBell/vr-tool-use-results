<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.186">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Joshua Bell">

<title>VR - Processing - Reaching</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="00b_reaching_task_processing_files/libs/clipboard/clipboard.min.js"></script>
<script src="00b_reaching_task_processing_files/libs/quarto-html/quarto.js"></script>
<script src="00b_reaching_task_processing_files/libs/quarto-html/popper.min.js"></script>
<script src="00b_reaching_task_processing_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="00b_reaching_task_processing_files/libs/quarto-html/anchor.min.js"></script>
<link href="00b_reaching_task_processing_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="00b_reaching_task_processing_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="00b_reaching_task_processing_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="00b_reaching_task_processing_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="00b_reaching_task_processing_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#package-and-session-info" id="toc-package-and-session-info" class="nav-link active" data-scroll-target="#package-and-session-info">Package and Session Info</a></li>
  <li><a href="#position-filter" id="toc-position-filter" class="nav-link" data-scroll-target="#position-filter">Position Filter</a></li>
  <li><a href="#velocity-calculation" id="toc-velocity-calculation" class="nav-link" data-scroll-target="#velocity-calculation">Velocity calculation</a></li>
  <li><a href="#kinematic-filtering" id="toc-kinematic-filtering" class="nav-link" data-scroll-target="#kinematic-filtering">Kinematic filtering</a></li>
  <li><a href="#movement-onset" id="toc-movement-onset" class="nav-link" data-scroll-target="#movement-onset">Movement Onset</a></li>
  <li><a href="#individualized-adjustments" id="toc-individualized-adjustments" class="nav-link" data-scroll-target="#individualized-adjustments">Individualized Adjustments</a></li>
  <li><a href="#removals-imputation-and-export" id="toc-removals-imputation-and-export" class="nav-link" data-scroll-target="#removals-imputation-and-export">Removals, Imputation and Export</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">VR - Processing - Reaching</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Joshua Bell </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="package-and-session-info" class="level1">
<h1>Package and Session Info</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># PPT Reaching Data -------------------------------------------------------</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Load necessary libraries ------------------------------------------------</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>pkgs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"data.table"</span>, <span class="st">"dplyr"</span>, <span class="st">"readr"</span>, <span class="st">"tidyfast"</span>, <span class="st">"stringr"</span>, <span class="st">"tidyr"</span>, <span class="st">"magrittr"</span>, <span class="st">"purrr"</span>, <span class="st">"signal"</span>, <span class="st">"here"</span>, <span class="st">"missForest"</span>, <span class="st">"simputation"</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> pkgs) {</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span>i <span class="sc">%in%</span> <span class="fu">rownames</span>(<span class="fu">installed.packages</span>())) {</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">install.packages</span>(i)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">library</span>(i, <span class="at">character.only =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>      (<span class="fu">library</span>(i, <span class="at">character.only =</span> <span class="cn">TRUE</span>))</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'data.table' was built under R version 4.2.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'dplyr' was built under R version 4.2.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:data.table':

    between, first, last</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'readr' was built under R version 4.2.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'stringr' was built under R version 4.2.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'tidyr' was built under R version 4.2.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'magrittr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:tidyr':

    extract</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'purrr' was built under R version 4.2.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'purrr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:magrittr':

    set_names</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:data.table':

    transpose</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'signal'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    filter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, poly</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>here() starts at C:/Repositories/R Projects/dissertation-analysis</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>data.table<span class="sc">::</span><span class="fu">setDTthreads</span>(<span class="at">percent =</span> <span class="dv">90</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.2.1 (2022-06-23 ucrt)
Platform: x86_64-w64-mingw32/x64 (64-bit)
Running under: Windows 10 x64 (build 19044)

Matrix products: default

locale:
[1] LC_COLLATE=English_United States.utf8 
[2] LC_CTYPE=English_United States.utf8   
[3] LC_MONETARY=English_United States.utf8
[4] LC_NUMERIC=C                          
[5] LC_TIME=English_United States.utf8    

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] simputation_0.2.8 missForest_1.5    here_1.0.1        signal_0.7-7     
 [5] purrr_1.0.1       magrittr_2.0.3    tidyr_1.3.0       stringr_1.5.0    
 [9] tidyfast_0.2.1    readr_2.1.4       dplyr_1.1.0       data.table_1.14.8

loaded via a namespace (and not attached):
 [1] Rcpp_1.0.10          gower_1.0.1          pillar_1.8.1        
 [4] compiler_4.2.1       rngtools_1.5.2       iterators_1.0.14    
 [7] tools_4.2.1          rpart_4.1.19         digest_0.6.31       
[10] jsonlite_1.8.4       evaluate_0.20        lifecycle_1.0.3     
[13] tibble_3.1.8         doRNG_1.8.6          pkgconfig_2.0.3     
[16] rlang_1.0.6          foreach_1.5.2        cli_3.6.0           
[19] parallel_4.2.1       yaml_2.3.7           xfun_0.37           
[22] fastmap_1.1.1        knitr_1.42           generics_0.1.3      
[25] vctrs_0.5.2          htmlwidgets_1.6.1    hms_1.1.2           
[28] rprojroot_2.0.3      tidyselect_1.2.0     glue_1.6.2          
[31] R6_2.5.1             fansi_1.0.4          rmarkdown_2.20      
[34] tzdb_0.3.0           itertools_0.1-3      codetools_0.2-19    
[37] htmltools_0.5.4      ellipsis_0.3.2       MASS_7.3-58.2       
[40] randomForest_4.7-1.1 utf8_1.2.3           stringi_1.7.12      </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set-up: Filter specification and .csv import ----------------------------</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 10hz Butterworth low-pass filter used for analyses</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>b_10hz <span class="ot">&lt;-</span> <span class="fu">butter</span>(<span class="dv">1</span>, <span class="fu">c</span>(.<span class="dv">1</span>), <span class="at">type =</span> <span class="st">"low"</span>)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Parse data from UXF</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>trial_details <span class="ot">&lt;-</span> <span class="fu">list.files</span>(</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">path =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"1_tooluseinVR"</span>),</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">pattern =</span> <span class="st">"trial_results.csv"</span>,</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">full.names =</span> <span class="cn">TRUE</span>,</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">recursive =</span> <span class="cn">TRUE</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> <span class="co"># %&gt;% as.data.table() %&gt;%</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map_dfr</span>(fread) <span class="sc">%&gt;%</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as.data.table</span>()</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Read manually-adjusted start times</span></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>latency_fix <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"study_one"</span>, <span class="st">"latency_fixes.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>New names:
Rows: 183 Columns: 7
── Column specification
──────────────────────────────────────────────────────── Delimiter: "," chr
(3): ppid, time, ...7 dbl (3): trial_num_in_block, start_time,
start_time_steamvr lgl (1): ...6
ℹ Use `spec()` to retrieve the full column specification for this data. ℹ
Specify the column types or set `show_col_types = FALSE` to quiet this message.
• `` -&gt; `...6`
• `` -&gt; `...7`</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Manual - Wrist &amp; Fingers ------------------------------------------------</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Parse file locations</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>ppt_m_files <span class="ot">&lt;-</span> trial_details <span class="sc">%&gt;%</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>    ppid,</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>    experiment,</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>    block_num,</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>    trial_num_in_block,</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>    manual_reach_ppt_hand_movement_location_0) <span class="sc">%&gt;%</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Fix mis-coding of participant IDs (I accidentally a number)</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">ppid =</span> <span class="fu">case_when</span>(</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>      ppid <span class="sc">==</span> <span class="st">"d-002"</span> <span class="sc">~</span> <span class="st">"d1-002"</span>,</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>      ppid <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"d-1-001"</span>, <span class="st">"d-1-002"</span>) <span class="sc">~</span> <span class="st">"d1-003"</span>,</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> ppid</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Adjust filepaths to accommodate fix</span></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">manual_reach_ppt_hand_movement_location_0 =</span> <span class="fu">ifelse</span>(</span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>      <span class="sc">!</span><span class="fu">is.na</span>(manual_reach_ppt_hand_movement_location_0)</span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>      <span class="sc">&amp;</span> <span class="fu">str_detect</span>(</span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>        manual_reach_ppt_hand_movement_location_0,</span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>        <span class="st">"1_tooluseinVR</span><span class="sc">\\</span><span class="st">/d-[</span><span class="sc">\\</span><span class="st">d-][</span><span class="sc">\\</span><span class="st">d-]</span><span class="sc">\\</span><span class="st">d+</span><span class="sc">\\</span><span class="st">/"</span></span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste0</span>(</span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a>        experiment, <span class="st">"/"</span>,</span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a>        ppid, <span class="st">"/"</span>,</span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a>        <span class="fu">str_remove</span>(</span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a>          manual_reach_ppt_hand_movement_location_0,</span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a>          <span class="st">"^1_tooluseinVR</span><span class="sc">\\</span><span class="st">/d-[</span><span class="sc">\\</span><span class="st">d-][</span><span class="sc">\\</span><span class="st">d-]</span><span class="sc">\\</span><span class="st">d+</span><span class="sc">\\</span><span class="st">/"</span></span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb25-35"><a href="#cb25-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-36"><a href="#cb25-36" aria-hidden="true" tabindex="-1"></a>      manual_reach_ppt_hand_movement_location_0</span>
<span id="cb25-37"><a href="#cb25-37" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb25-38"><a href="#cb25-38" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb25-39"><a href="#cb25-39" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(</span>
<span id="cb25-40"><a href="#cb25-40" aria-hidden="true" tabindex="-1"></a>      <span class="sc">!</span><span class="fu">is.na</span>(manual_reach_ppt_hand_movement_location_0) <span class="sc">&amp;</span></span>
<span id="cb25-41"><a href="#cb25-41" aria-hidden="true" tabindex="-1"></a>          manual_reach_ppt_hand_movement_location_0 <span class="sc">!=</span> <span class="st">""</span></span>
<span id="cb25-42"><a href="#cb25-42" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb25-43"><a href="#cb25-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-44"><a href="#cb25-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Read in the csv files using the paths from the trial_results files and unnest those</span></span>
<span id="cb25-45"><a href="#cb25-45" aria-hidden="true" tabindex="-1"></a>ppt_trials_nested <span class="ot">&lt;-</span> ppt_m_files <span class="sc">%&gt;%</span></span>
<span id="cb25-46"><a href="#cb25-46" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb25-47"><a href="#cb25-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">manual_movement_ppt =</span> <span class="fu">map</span>(</span>
<span id="cb25-48"><a href="#cb25-48" aria-hidden="true" tabindex="-1"></a>            <span class="fu">file.path</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data"</span>, manual_reach_ppt_hand_movement_location_0)),</span>
<span id="cb25-49"><a href="#cb25-49" aria-hidden="true" tabindex="-1"></a>            fread</span>
<span id="cb25-50"><a href="#cb25-50" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb25-51"><a href="#cb25-51" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb25-52"><a href="#cb25-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unnest</span>(<span class="at">cols =</span> <span class="fu">c</span>(manual_reach_ppt_hand_movement_location_0)) <span class="sc">%&gt;%</span></span>
<span id="cb25-53"><a href="#cb25-53" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.table</span>()</span>
<span id="cb25-54"><a href="#cb25-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-55"><a href="#cb25-55" aria-hidden="true" tabindex="-1"></a><span class="co"># Unnest again, and fix ms values that were recorded with "_"</span></span>
<span id="cb25-56"><a href="#cb25-56" aria-hidden="true" tabindex="-1"></a>ppt_trials_unnested <span class="ot">&lt;-</span> <span class="fu">dt_unnest</span>(ppt_trials_nested[</span>
<span id="cb25-57"><a href="#cb25-57" aria-hidden="true" tabindex="-1"></a>  ,</span>
<span id="cb25-58"><a href="#cb25-58" aria-hidden="true" tabindex="-1"></a>  <span class="at">manual_movement_ppt :=</span> <span class="fu">map</span>(</span>
<span id="cb25-59"><a href="#cb25-59" aria-hidden="true" tabindex="-1"></a>    manual_movement_ppt,</span>
<span id="cb25-60"><a href="#cb25-60" aria-hidden="true" tabindex="-1"></a>    <span class="sc">~</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(.x, <span class="at">time_ms =</span> <span class="fu">as.double</span>(<span class="fu">gsub</span>(<span class="st">"_"</span>, <span class="st">""</span>, time_ms)))</span>
<span id="cb25-61"><a href="#cb25-61" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb25-62"><a href="#cb25-62" aria-hidden="true" tabindex="-1"></a>], manual_movement_ppt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="position-filter" class="level1">
<h1>Position Filter</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Manually impute a time_ms column that increments in steps of 5.</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>ppt_prefilter <span class="ot">&lt;-</span> ppt_trials_unnested[,</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">:=</span><span class="st">`</span>(</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">time =</span> <span class="fu">if_else</span>(block_num <span class="sc">&lt;</span> <span class="dv">3</span>, <span class="st">"pre"</span>, <span class="st">"post"</span>),</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">time_second =</span> <span class="fu">signif</span>(time_ms <span class="sc">/</span> <span class="dv">1000</span>, <span class="dv">6</span>),</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">time_ms =</span> (<span class="dv">0</span><span class="sc">:</span>(.N <span class="sc">-</span> <span class="dv">1</span>)) <span class="sc">*</span> <span class="dv">5</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  by <span class="ot">=</span> <span class="fu">c</span>(</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ppid"</span>,</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"block_num"</span>,</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"trial_num_in_block"</span>,</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">"tracked"</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>][time_ms <span class="sc">&gt;</span> <span class="dv">25</span>]</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Participant 1 time_second variable recorded incorrectly</span></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>ppt_prefilter <span class="ot">&lt;-</span> ppt_prefilter[ppid <span class="sc">==</span> <span class="st">"d1-001"</span>,</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>  time_second <span class="sc">:</span><span class="er">=</span> <span class="fu">signif</span>(time_ms <span class="sc">/</span> <span class="dv">1000</span>, <span class="dv">6</span>),</span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>  by <span class="ot">=</span> <span class="fu">c</span>(</span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ppid"</span>,</span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">"block_num"</span>,</span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">"trial_num_in_block"</span>,</span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">"tracked"</span></span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(ppt_trials_unnested)</span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           used  (Mb) gc trigger  (Mb)  max used  (Mb)
Ncells  1032672  55.2    2052737 109.7   2052737 109.7
Vcells 65823447 502.2  112219502 856.2 112218708 856.2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>leadcols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"pos_x_lead"</span>, <span class="st">"pos_y_lead"</span>, <span class="st">"pos_z_lead"</span>, <span class="st">"time_lead"</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>bytrial <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"ppid"</span>,</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"block_num"</span>,</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"trial_num_in_block"</span>,</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"time"</span>,</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">"tracked"</span>,</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">"phase"</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>buffercols <span class="ot">&lt;-</span> <span class="fu">colnames</span>(ppt_prefilter)</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>buffer_samples <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a buffer to reduce the distortion caused by the filtering process</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostly relevant for the first few participants,</span></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a><span class="co"># others have much more of a buffer built in to the recording.</span></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>buffer <span class="ot">&lt;-</span> ppt_prefilter[,</span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>  .(</span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">pos_x =</span> <span class="fu">c</span>(</span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>      <span class="fu">seq</span>(</span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>        <span class="fu">first</span>(pos_x),</span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>        <span class="fu">nth</span>(pos_x, buffer_samples <span class="sc">-</span> <span class="dv">1</span>),</span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">length.out =</span> buffer_samples</span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a>      <span class="fu">seq</span>(</span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a>        <span class="fu">nth</span>(pos_x, buffer_samples <span class="sc">-</span> <span class="dv">1</span>),</span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a>        <span class="fu">first</span>(pos_x),</span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">length.out =</span> buffer_samples</span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">pos_y =</span> <span class="fu">c</span>(</span>
<span id="cb28-34"><a href="#cb28-34" aria-hidden="true" tabindex="-1"></a>      <span class="fu">seq</span>(</span>
<span id="cb28-35"><a href="#cb28-35" aria-hidden="true" tabindex="-1"></a>        <span class="fu">first</span>(pos_y),</span>
<span id="cb28-36"><a href="#cb28-36" aria-hidden="true" tabindex="-1"></a>        <span class="fu">nth</span>(pos_y, buffer_samples <span class="sc">-</span> <span class="dv">1</span>),</span>
<span id="cb28-37"><a href="#cb28-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">length.out =</span> buffer_samples</span>
<span id="cb28-38"><a href="#cb28-38" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb28-39"><a href="#cb28-39" aria-hidden="true" tabindex="-1"></a>      <span class="fu">seq</span>(</span>
<span id="cb28-40"><a href="#cb28-40" aria-hidden="true" tabindex="-1"></a>        <span class="fu">nth</span>(pos_y, buffer_samples <span class="sc">-</span> <span class="dv">1</span>),</span>
<span id="cb28-41"><a href="#cb28-41" aria-hidden="true" tabindex="-1"></a>        <span class="fu">first</span>(pos_y),</span>
<span id="cb28-42"><a href="#cb28-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">length.out =</span> buffer_samples</span>
<span id="cb28-43"><a href="#cb28-43" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb28-44"><a href="#cb28-44" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb28-45"><a href="#cb28-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">pos_z =</span> <span class="fu">c</span>(</span>
<span id="cb28-46"><a href="#cb28-46" aria-hidden="true" tabindex="-1"></a>      <span class="fu">seq</span>(</span>
<span id="cb28-47"><a href="#cb28-47" aria-hidden="true" tabindex="-1"></a>        <span class="fu">first</span>(pos_z),</span>
<span id="cb28-48"><a href="#cb28-48" aria-hidden="true" tabindex="-1"></a>        <span class="fu">nth</span>(pos_z, buffer_samples),</span>
<span id="cb28-49"><a href="#cb28-49" aria-hidden="true" tabindex="-1"></a>        <span class="at">length.out =</span> buffer_samples</span>
<span id="cb28-50"><a href="#cb28-50" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb28-51"><a href="#cb28-51" aria-hidden="true" tabindex="-1"></a>      <span class="fu">seq</span>(</span>
<span id="cb28-52"><a href="#cb28-52" aria-hidden="true" tabindex="-1"></a>        <span class="fu">nth</span>(pos_z, buffer_samples <span class="sc">-</span> <span class="dv">1</span>),</span>
<span id="cb28-53"><a href="#cb28-53" aria-hidden="true" tabindex="-1"></a>        <span class="fu">first</span>(pos_z),</span>
<span id="cb28-54"><a href="#cb28-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">length.out =</span> buffer_samples</span>
<span id="cb28-55"><a href="#cb28-55" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb28-56"><a href="#cb28-56" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb28-57"><a href="#cb28-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">time_ms =</span> <span class="fu">seq</span>(</span>
<span id="cb28-58"><a href="#cb28-58" aria-hidden="true" tabindex="-1"></a>      <span class="dv">25</span>,</span>
<span id="cb28-59"><a href="#cb28-59" aria-hidden="true" tabindex="-1"></a>      (<span class="sc">-</span><span class="dv">5</span><span class="sc">*</span>buffer_samples<span class="sc">*</span><span class="dv">2</span>)<span class="sc">+</span><span class="dv">25</span>,</span>
<span id="cb28-60"><a href="#cb28-60" aria-hidden="true" tabindex="-1"></a>      <span class="at">length.out =</span> (buffer_samples<span class="sc">*</span><span class="dv">2</span>)</span>
<span id="cb28-61"><a href="#cb28-61" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb28-62"><a href="#cb28-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">phase =</span> <span class="st">"buffer"</span></span>
<span id="cb28-63"><a href="#cb28-63" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb28-64"><a href="#cb28-64" aria-hidden="true" tabindex="-1"></a>  by <span class="ot">=</span> <span class="fu">c</span>(</span>
<span id="cb28-65"><a href="#cb28-65" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ppid"</span>,</span>
<span id="cb28-66"><a href="#cb28-66" aria-hidden="true" tabindex="-1"></a>    <span class="st">"block_num"</span>,</span>
<span id="cb28-67"><a href="#cb28-67" aria-hidden="true" tabindex="-1"></a>    <span class="st">"trial_num_in_block"</span>,</span>
<span id="cb28-68"><a href="#cb28-68" aria-hidden="true" tabindex="-1"></a>    <span class="st">"tracked"</span>,</span>
<span id="cb28-69"><a href="#cb28-69" aria-hidden="true" tabindex="-1"></a>    <span class="st">"time"</span></span>
<span id="cb28-70"><a href="#cb28-70" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb28-71"><a href="#cb28-71" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb28-72"><a href="#cb28-72" aria-hidden="true" tabindex="-1"></a>ppt_prefilter_buffered <span class="ot">&lt;-</span> <span class="fu">merge.data.table</span>(</span>
<span id="cb28-73"><a href="#cb28-73" aria-hidden="true" tabindex="-1"></a>  ppt_prefilter,</span>
<span id="cb28-74"><a href="#cb28-74" aria-hidden="true" tabindex="-1"></a>  buffer,</span>
<span id="cb28-75"><a href="#cb28-75" aria-hidden="true" tabindex="-1"></a>  <span class="at">all =</span> <span class="cn">TRUE</span></span>
<span id="cb28-76"><a href="#cb28-76" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">!</span>manual_reach_ppt_hand_movement_location_0)</span>
<span id="cb28-77"><a href="#cb28-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-78"><a href="#cb28-78" aria-hidden="true" tabindex="-1"></a><span class="co"># Fix ordering</span></span>
<span id="cb28-79"><a href="#cb28-79" aria-hidden="true" tabindex="-1"></a>ppt_prefilter_buffered <span class="ot">&lt;-</span> ppt_prefilter_buffered[</span>
<span id="cb28-80"><a href="#cb28-80" aria-hidden="true" tabindex="-1"></a>    <span class="fu">order</span>(</span>
<span id="cb28-81"><a href="#cb28-81" aria-hidden="true" tabindex="-1"></a>        ppid,</span>
<span id="cb28-82"><a href="#cb28-82" aria-hidden="true" tabindex="-1"></a>        block_num,</span>
<span id="cb28-83"><a href="#cb28-83" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block,</span>
<span id="cb28-84"><a href="#cb28-84" aria-hidden="true" tabindex="-1"></a>        tracked,</span>
<span id="cb28-85"><a href="#cb28-85" aria-hidden="true" tabindex="-1"></a>        time_ms</span>
<span id="cb28-86"><a href="#cb28-86" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb28-87"><a href="#cb28-87" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb28-88"><a href="#cb28-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-89"><a href="#cb28-89" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply Butterworth filter to position values</span></span>
<span id="cb28-90"><a href="#cb28-90" aria-hidden="true" tabindex="-1"></a>ppt_position_filtered <span class="ot">&lt;-</span> ppt_prefilter_buffered[<span class="sc">!</span>(ppid <span class="sc">%like%</span> <span class="st">"pilot"</span>), ] <span class="sc">%&gt;%</span></span>
<span id="cb28-91"><a href="#cb28-91" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">group_by</span>(</span>
<span id="cb28-92"><a href="#cb28-92" aria-hidden="true" tabindex="-1"></a>        ppid,</span>
<span id="cb28-93"><a href="#cb28-93" aria-hidden="true" tabindex="-1"></a>        block_num,</span>
<span id="cb28-94"><a href="#cb28-94" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block,</span>
<span id="cb28-95"><a href="#cb28-95" aria-hidden="true" tabindex="-1"></a>        time,</span>
<span id="cb28-96"><a href="#cb28-96" aria-hidden="true" tabindex="-1"></a>        tracked</span>
<span id="cb28-97"><a href="#cb28-97" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb28-98"><a href="#cb28-98" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb28-99"><a href="#cb28-99" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">across</span>(</span>
<span id="cb28-100"><a href="#cb28-100" aria-hidden="true" tabindex="-1"></a>          pos_x<span class="sc">:</span>pos_z, </span>
<span id="cb28-101"><a href="#cb28-101" aria-hidden="true" tabindex="-1"></a>          <span class="sc">~</span> <span class="fu">filtfilt</span>(b_10hz, .x), </span>
<span id="cb28-102"><a href="#cb28-102" aria-hidden="true" tabindex="-1"></a>          <span class="at">.names =</span> <span class="st">"{.col}_10hz"</span>)</span>
<span id="cb28-103"><a href="#cb28-103" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb28-104"><a href="#cb28-104" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.table</span>()</span>
<span id="cb28-105"><a href="#cb28-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-106"><a href="#cb28-106" aria-hidden="true" tabindex="-1"></a><span class="co"># Pull column names from the position variables</span></span>
<span id="cb28-107"><a href="#cb28-107" aria-hidden="true" tabindex="-1"></a>filteredcolnames <span class="ot">&lt;-</span> <span class="fu">colnames</span>(</span>
<span id="cb28-108"><a href="#cb28-108" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb28-109"><a href="#cb28-109" aria-hidden="true" tabindex="-1"></a>        ppt_position_filtered,</span>
<span id="cb28-110"><a href="#cb28-110" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ends_with</span>(</span>
<span id="cb28-111"><a href="#cb28-111" aria-hidden="true" tabindex="-1"></a>            <span class="fu">c</span>(<span class="st">"x"</span>, <span class="st">"y"</span>, <span class="st">"z"</span>)</span>
<span id="cb28-112"><a href="#cb28-112" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb28-113"><a href="#cb28-113" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb28-114"><a href="#cb28-114" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb28-115"><a href="#cb28-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-116"><a href="#cb28-116" aria-hidden="true" tabindex="-1"></a>cutoffs <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb28-117"><a href="#cb28-117" aria-hidden="true" tabindex="-1"></a>  <span class="st">"raw"</span>,</span>
<span id="cb28-118"><a href="#cb28-118" aria-hidden="true" tabindex="-1"></a>  <span class="st">"10hz"</span></span>
<span id="cb28-119"><a href="#cb28-119" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb28-120"><a href="#cb28-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-121"><a href="#cb28-121" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter out buffer and melt the data into long format.</span></span>
<span id="cb28-122"><a href="#cb28-122" aria-hidden="true" tabindex="-1"></a>ppt_position_filtered_long <span class="ot">&lt;-</span> ppt_position_filtered <span class="sc">%&gt;%</span></span>
<span id="cb28-123"><a href="#cb28-123" aria-hidden="true" tabindex="-1"></a>    data.table<span class="sc">::</span><span class="fu">melt</span>(</span>
<span id="cb28-124"><a href="#cb28-124" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(</span>
<span id="cb28-125"><a href="#cb28-125" aria-hidden="true" tabindex="-1"></a>            <span class="st">"ppid"</span>,</span>
<span id="cb28-126"><a href="#cb28-126" aria-hidden="true" tabindex="-1"></a>            <span class="st">"block_num"</span>,</span>
<span id="cb28-127"><a href="#cb28-127" aria-hidden="true" tabindex="-1"></a>            <span class="st">"trial_num_in_block"</span>,</span>
<span id="cb28-128"><a href="#cb28-128" aria-hidden="true" tabindex="-1"></a>            <span class="st">"tracked"</span>,</span>
<span id="cb28-129"><a href="#cb28-129" aria-hidden="true" tabindex="-1"></a>            <span class="st">"time_ms"</span>,</span>
<span id="cb28-130"><a href="#cb28-130" aria-hidden="true" tabindex="-1"></a>            <span class="st">"time_second"</span>,</span>
<span id="cb28-131"><a href="#cb28-131" aria-hidden="true" tabindex="-1"></a>            <span class="st">"time"</span>,</span>
<span id="cb28-132"><a href="#cb28-132" aria-hidden="true" tabindex="-1"></a>            <span class="st">"phase"</span></span>
<span id="cb28-133"><a href="#cb28-133" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb28-134"><a href="#cb28-134" aria-hidden="true" tabindex="-1"></a>        <span class="at">measure.vars =</span> <span class="fu">patterns</span>(<span class="st">"^pos_x"</span>, <span class="st">"^pos_y"</span>, <span class="st">"^pos_z"</span>),</span>
<span id="cb28-135"><a href="#cb28-135" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable.name =</span> <span class="st">"filter"</span>,</span>
<span id="cb28-136"><a href="#cb28-136" aria-hidden="true" tabindex="-1"></a>        <span class="at">value.name =</span> <span class="fu">c</span>(<span class="st">"pos_x"</span>, <span class="st">"pos_y"</span>, <span class="st">"pos_z"</span>)</span>
<span id="cb28-137"><a href="#cb28-137" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb28-138"><a href="#cb28-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-139"><a href="#cb28-139" aria-hidden="true" tabindex="-1"></a><span class="co"># Establish the different filters as the cutoffs.</span></span>
<span id="cb28-140"><a href="#cb28-140" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(ppt_position_filtered_long<span class="sc">$</span>filter) <span class="ot">&lt;-</span> cutoffs</span>
<span id="cb28-141"><a href="#cb28-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-142"><a href="#cb28-142" aria-hidden="true" tabindex="-1"></a>bytrial_filter <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb28-143"><a href="#cb28-143" aria-hidden="true" tabindex="-1"></a>  <span class="st">"ppid"</span>,</span>
<span id="cb28-144"><a href="#cb28-144" aria-hidden="true" tabindex="-1"></a>  <span class="st">"block_num"</span>,</span>
<span id="cb28-145"><a href="#cb28-145" aria-hidden="true" tabindex="-1"></a>  <span class="st">"trial_num_in_block"</span>,</span>
<span id="cb28-146"><a href="#cb28-146" aria-hidden="true" tabindex="-1"></a>  <span class="st">"time"</span>,</span>
<span id="cb28-147"><a href="#cb28-147" aria-hidden="true" tabindex="-1"></a>  <span class="st">"tracked"</span>,</span>
<span id="cb28-148"><a href="#cb28-148" aria-hidden="true" tabindex="-1"></a>  <span class="st">"filter"</span></span>
<span id="cb28-149"><a href="#cb28-149" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="velocity-calculation" class="level1">
<h1>Velocity calculation</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>ppt_velocity <span class="ot">&lt;-</span> ppt_position_filtered_long[,</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># create lead columns for position and time</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"pos_x_lead"</span>,</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"pos_y_lead"</span>,</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"pos_z_lead"</span>,</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"time_ms_lead"</span>,</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"time_s_lead"</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">:</span><span class="er">=</span> <span class="fu">lapply</span>(</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>      .SD,</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>      data.table<span class="sc">::</span>shift,</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>      <span class="dv">1</span>,</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">type =</span> <span class="st">"lead"</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>  .SDcols <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"pos_x"</span>, <span class="st">"pos_y"</span>, <span class="st">"pos_z"</span>, <span class="st">"time_ms"</span>, <span class="st">"time_second"</span>),</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>  by <span class="ot">=</span> bytrial_filter</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>][,</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># create lag columns for position and time</span></span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(</span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">"pos_x_lag"</span>,</span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">"pos_y_lag"</span>,</span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">"pos_z_lag"</span>,</span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">"time_ms_lag"</span>,</span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>    <span class="st">"time_s_lag"</span></span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">:</span><span class="er">=</span> <span class="fu">lapply</span>(.SD, data.table<span class="sc">::</span>shift, <span class="dv">1</span>, <span class="at">type =</span> <span class="st">"lag"</span>),</span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a>  .SDcols <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"pos_x"</span>, <span class="st">"pos_y"</span>, <span class="st">"pos_z"</span>, <span class="st">"time_ms"</span>, <span class="st">"time_second"</span>),</span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a>  by <span class="ot">=</span> bytrial_filter</span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a>][,</span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-32"><a href="#cb29-32" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">:=</span><span class="st">`</span>(</span>
<span id="cb29-33"><a href="#cb29-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">xdiff =</span> (pos_x_lead <span class="sc">-</span> pos_x_lag),</span>
<span id="cb29-34"><a href="#cb29-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">ydiff =</span> (pos_y_lead <span class="sc">-</span> pos_y_lag),</span>
<span id="cb29-35"><a href="#cb29-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">zdiff =</span> (pos_z_lead <span class="sc">-</span> pos_z_lag),</span>
<span id="cb29-36"><a href="#cb29-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">time_diff_ms =</span> (time_ms_lead <span class="sc">-</span> time_ms_lag),</span>
<span id="cb29-37"><a href="#cb29-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">time_diff_s =</span> (time_s_lead <span class="sc">-</span> time_s_lag)</span>
<span id="cb29-38"><a href="#cb29-38" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb29-39"><a href="#cb29-39" aria-hidden="true" tabindex="-1"></a>  by <span class="ot">=</span> bytrial_filter</span>
<span id="cb29-40"><a href="#cb29-40" aria-hidden="true" tabindex="-1"></a>][,</span>
<span id="cb29-41"><a href="#cb29-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-42"><a href="#cb29-42" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate velocity in mm/s^2</span></span>
<span id="cb29-43"><a href="#cb29-43" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">:=</span><span class="st">`</span>(</span>
<span id="cb29-44"><a href="#cb29-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">velocity =</span> <span class="fu">fifelse</span>(</span>
<span id="cb29-45"><a href="#cb29-45" aria-hidden="true" tabindex="-1"></a>      <span class="sc">!</span><span class="fu">is.na</span>(time_diff_s),</span>
<span id="cb29-46"><a href="#cb29-46" aria-hidden="true" tabindex="-1"></a>      (<span class="fu">sqrt</span>(xdiff<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> ydiff<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> zdiff<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> time_diff_s) <span class="sc">*</span> <span class="dv">1000</span>,</span>
<span id="cb29-47"><a href="#cb29-47" aria-hidden="true" tabindex="-1"></a>      (<span class="fu">sqrt</span>(xdiff<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> ydiff<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> zdiff<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> (time_diff_ms <span class="sc">/</span> <span class="dv">1000</span>)) <span class="sc">*</span> <span class="dv">1000</span></span>
<span id="cb29-48"><a href="#cb29-48" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb29-49"><a href="#cb29-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">displacement =</span> <span class="fu">sqrt</span>(pos_x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> pos_y<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> pos_z<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb29-50"><a href="#cb29-50" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb29-51"><a href="#cb29-51" aria-hidden="true" tabindex="-1"></a>  by <span class="ot">=</span> bytrial_filter</span>
<span id="cb29-52"><a href="#cb29-52" aria-hidden="true" tabindex="-1"></a>][,</span>
<span id="cb29-53"><a href="#cb29-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-54"><a href="#cb29-54" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create lead column for velocity</span></span>
<span id="cb29-55"><a href="#cb29-55" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">:=</span><span class="st">`</span>(</span>
<span id="cb29-56"><a href="#cb29-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">velocity_lead =</span> data.table<span class="sc">::</span><span class="fu">shift</span>(velocity, <span class="dv">1</span>, <span class="at">type =</span> <span class="st">"lead"</span>),</span>
<span id="cb29-57"><a href="#cb29-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">velocity_lag =</span> data.table<span class="sc">::</span><span class="fu">shift</span>(velocity, <span class="dv">1</span>, <span class="at">type =</span> <span class="st">"lag"</span>)</span>
<span id="cb29-58"><a href="#cb29-58" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb29-59"><a href="#cb29-59" aria-hidden="true" tabindex="-1"></a>  by <span class="ot">=</span> bytrial_filter</span>
<span id="cb29-60"><a href="#cb29-60" aria-hidden="true" tabindex="-1"></a>][,</span>
<span id="cb29-61"><a href="#cb29-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-62"><a href="#cb29-62" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute differences</span></span>
<span id="cb29-63"><a href="#cb29-63" aria-hidden="true" tabindex="-1"></a>  vel_diff <span class="sc">:</span><span class="er">=</span> (velocity_lead <span class="sc">-</span> velocity_lag),</span>
<span id="cb29-64"><a href="#cb29-64" aria-hidden="true" tabindex="-1"></a>  by <span class="ot">=</span> bytrial_filter</span>
<span id="cb29-65"><a href="#cb29-65" aria-hidden="true" tabindex="-1"></a>][,</span>
<span id="cb29-66"><a href="#cb29-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-67"><a href="#cb29-67" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate acceleration</span></span>
<span id="cb29-68"><a href="#cb29-68" aria-hidden="true" tabindex="-1"></a>  accel <span class="sc">:</span><span class="er">=</span> <span class="fu">fifelse</span>(</span>
<span id="cb29-69"><a href="#cb29-69" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.na</span>(time_diff_s),</span>
<span id="cb29-70"><a href="#cb29-70" aria-hidden="true" tabindex="-1"></a>    vel_diff <span class="sc">/</span> (time_diff_s),</span>
<span id="cb29-71"><a href="#cb29-71" aria-hidden="true" tabindex="-1"></a>    vel_diff <span class="sc">/</span> (time_diff_ms <span class="sc">/</span> <span class="dv">1000</span>)</span>
<span id="cb29-72"><a href="#cb29-72" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb29-73"><a href="#cb29-73" aria-hidden="true" tabindex="-1"></a>  by <span class="ot">=</span> bytrial_filter</span>
<span id="cb29-74"><a href="#cb29-74" aria-hidden="true" tabindex="-1"></a>][,</span>
<span id="cb29-75"><a href="#cb29-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-76"><a href="#cb29-76" aria-hidden="true" tabindex="-1"></a>  time_ms_perphase <span class="sc">:</span><span class="er">=</span> (</span>
<span id="cb29-77"><a href="#cb29-77" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span><span class="sc">:</span>(.N <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb29-78"><a href="#cb29-78" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">*</span> <span class="dv">5</span>,</span>
<span id="cb29-79"><a href="#cb29-79" aria-hidden="true" tabindex="-1"></a>  by <span class="ot">=</span> <span class="fu">c</span>(</span>
<span id="cb29-80"><a href="#cb29-80" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ppid"</span>,</span>
<span id="cb29-81"><a href="#cb29-81" aria-hidden="true" tabindex="-1"></a>    <span class="st">"block_num"</span>,</span>
<span id="cb29-82"><a href="#cb29-82" aria-hidden="true" tabindex="-1"></a>    <span class="st">"trial_num_in_block"</span>,</span>
<span id="cb29-83"><a href="#cb29-83" aria-hidden="true" tabindex="-1"></a>    <span class="st">"time"</span>,</span>
<span id="cb29-84"><a href="#cb29-84" aria-hidden="true" tabindex="-1"></a>    <span class="st">"phase"</span>,</span>
<span id="cb29-85"><a href="#cb29-85" aria-hidden="true" tabindex="-1"></a>    <span class="st">"tracked"</span>,</span>
<span id="cb29-86"><a href="#cb29-86" aria-hidden="true" tabindex="-1"></a>    <span class="st">"filter"</span></span>
<span id="cb29-87"><a href="#cb29-87" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb29-88"><a href="#cb29-88" aria-hidden="true" tabindex="-1"></a>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="kinematic-filtering" class="level1">
<h1>Kinematic filtering</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>ppt_filt <span class="ot">&lt;-</span> ppt_velocity[</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">order</span>(ppid, block_num, trial_num_in_block, tracked, filter, time_ms)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>][<span class="sc">!</span><span class="fu">is.na</span>(velocity) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.infinite</span>(velocity),</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filter velocity w/ 10hz butterworth</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">:=</span><span class="st">`</span>(<span class="at">velocity_10hz =</span> <span class="fu">filtfilt</span>(b_10hz, velocity)),</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>  by <span class="ot">=</span> <span class="fu">c</span>(</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ppid"</span>,</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"block_num"</span>,</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"trial_num_in_block"</span>,</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"tracked"</span>,</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">"filter"</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>][,</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create lead column for velocity</span></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">:=</span><span class="st">`</span>(</span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">velocity_10hzlead =</span> data.table<span class="sc">::</span><span class="fu">shift</span>(velocity_10hz, <span class="dv">1</span>, <span class="at">type =</span> <span class="st">"lead"</span>),</span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">velocity_10hzlag =</span> data.table<span class="sc">::</span><span class="fu">shift</span>(velocity_10hz, <span class="dv">1</span>, <span class="at">type =</span> <span class="st">"lag"</span>)</span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>  by <span class="ot">=</span> bytrial_filter</span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>][,</span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute differences</span></span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">:=</span><span class="st">`</span>(<span class="at">vel_10hzdiff =</span> (velocity_10hzlead <span class="sc">-</span> velocity_10hzlag)),</span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a>  by <span class="ot">=</span> bytrial_filter</span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>][,</span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute acceleration</span></span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a>  accel_filtvel <span class="sc">:</span><span class="er">=</span> <span class="fu">fifelse</span>(</span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.na</span>(time_diff_s),</span>
<span id="cb30-32"><a href="#cb30-32" aria-hidden="true" tabindex="-1"></a>    vel_10hzdiff <span class="sc">/</span> (time_diff_s),</span>
<span id="cb30-33"><a href="#cb30-33" aria-hidden="true" tabindex="-1"></a>    vel_10hzdiff <span class="sc">/</span> (time_diff_ms <span class="sc">/</span> <span class="dv">1000</span>)</span>
<span id="cb30-34"><a href="#cb30-34" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb30-35"><a href="#cb30-35" aria-hidden="true" tabindex="-1"></a>  by <span class="ot">=</span> bytrial_filter</span>
<span id="cb30-36"><a href="#cb30-36" aria-hidden="true" tabindex="-1"></a>][</span>
<span id="cb30-37"><a href="#cb30-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">order</span>(ppid, block_num, trial_num_in_block, tracked, filter, time_ms)</span>
<span id="cb30-38"><a href="#cb30-38" aria-hidden="true" tabindex="-1"></a>][</span>
<span id="cb30-39"><a href="#cb30-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-40"><a href="#cb30-40" aria-hidden="true" tabindex="-1"></a>  <span class="sc">!</span><span class="fu">is.na</span>(accel) <span class="sc">&amp;</span></span>
<span id="cb30-41"><a href="#cb30-41" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.na</span>(accel_filtvel) <span class="sc">&amp;</span></span>
<span id="cb30-42"><a href="#cb30-42" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.infinite</span>(accel) <span class="sc">&amp;</span></span>
<span id="cb30-43"><a href="#cb30-43" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.infinite</span>(accel_filtvel),</span>
<span id="cb30-44"><a href="#cb30-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-45"><a href="#cb30-45" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">:=</span><span class="st">`</span>(</span>
<span id="cb30-46"><a href="#cb30-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">accelfilt =</span> <span class="fu">filtfilt</span>(b_10hz, accel),</span>
<span id="cb30-47"><a href="#cb30-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">accel_filtvel_filt =</span> <span class="fu">filtfilt</span>(b_10hz, accel_filtvel)</span>
<span id="cb30-48"><a href="#cb30-48" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb30-49"><a href="#cb30-49" aria-hidden="true" tabindex="-1"></a>  by <span class="ot">=</span> <span class="fu">c</span>(</span>
<span id="cb30-50"><a href="#cb30-50" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ppid"</span>,</span>
<span id="cb30-51"><a href="#cb30-51" aria-hidden="true" tabindex="-1"></a>    <span class="st">"block_num"</span>,</span>
<span id="cb30-52"><a href="#cb30-52" aria-hidden="true" tabindex="-1"></a>    <span class="st">"trial_num_in_block"</span>,</span>
<span id="cb30-53"><a href="#cb30-53" aria-hidden="true" tabindex="-1"></a>    <span class="st">"tracked"</span>,</span>
<span id="cb30-54"><a href="#cb30-54" aria-hidden="true" tabindex="-1"></a>    <span class="st">"filter"</span></span>
<span id="cb30-55"><a href="#cb30-55" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb30-56"><a href="#cb30-56" aria-hidden="true" tabindex="-1"></a>][<span class="fu">order</span>(ppid, block_num, trial_num_in_block, tracked, filter, time_ms)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="movement-onset" class="level1">
<h1>Movement Onset</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Write full data for plotting individual trials/visual quality checks.</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>ppt_filt_ <span class="ot">&lt;-</span> ppt_filt[</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  phase <span class="sc">!=</span> <span class="st">"buffer"</span> <span class="sc">&amp;</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>    filter <span class="sc">==</span> <span class="st">"10hz"</span> <span class="sc">&amp;</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>    tracked <span class="sc">==</span> <span class="st">"wrist"</span> <span class="sc">&amp;</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Remove cases that would break analyses-</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># these are at the ends of the movement when the markers are hopping around.</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.infinite</span>(velocity_10hz) <span class="sc">&amp;</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.infinite</span>(accel) <span class="sc">&amp;</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.infinite</span>(accel_filtvel),</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>  .(</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>    ppid,</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>    time, block_num,</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>    trial_num_in_block, phase,</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>    time_ms, time_ms_perphase,</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>    velocity, velocity_10hz,</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>    accel, accelfilt, accel_filtvel,</span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>    accel_filtvel_filt</span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>ppt_filt_latfix <span class="ot">&lt;-</span> <span class="fu">merge</span>(</span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>  ppt_filt_,</span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>  latency_fix,</span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">by =</span> <span class="fu">c</span>(</span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ppid"</span>,</span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a>    <span class="st">"trial_num_in_block"</span>,</span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a>    <span class="st">"time"</span></span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">all.x =</span> <span class="cn">TRUE</span></span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb31-32"><a href="#cb31-32" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb31-33"><a href="#cb31-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">start_time =</span> <span class="fu">fifelse</span>(</span>
<span id="cb31-34"><a href="#cb31-34" aria-hidden="true" tabindex="-1"></a>      <span class="sc">!</span><span class="fu">is.na</span>(start_time),</span>
<span id="cb31-35"><a href="#cb31-35" aria-hidden="true" tabindex="-1"></a>      start_time,</span>
<span id="cb31-36"><a href="#cb31-36" aria-hidden="true" tabindex="-1"></a>      <span class="dv">0</span></span>
<span id="cb31-37"><a href="#cb31-37" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb31-38"><a href="#cb31-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">time_ms_fix =</span> time_ms <span class="sc">-</span> start_time) <span class="sc">%&gt;%</span></span>
<span id="cb31-39"><a href="#cb31-39" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(time_ms_fix <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-40"><a href="#cb31-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(</span>
<span id="cb31-41"><a href="#cb31-41" aria-hidden="true" tabindex="-1"></a>    ppid,</span>
<span id="cb31-42"><a href="#cb31-42" aria-hidden="true" tabindex="-1"></a>    time,</span>
<span id="cb31-43"><a href="#cb31-43" aria-hidden="true" tabindex="-1"></a>    trial_num_in_block,</span>
<span id="cb31-44"><a href="#cb31-44" aria-hidden="true" tabindex="-1"></a>    time_ms</span>
<span id="cb31-45"><a href="#cb31-45" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb31-46"><a href="#cb31-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.table</span>()</span>
<span id="cb31-47"><a href="#cb31-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-48"><a href="#cb31-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-49"><a href="#cb31-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Set start time as the first sample where velocity changes</span></span>
<span id="cb31-50"><a href="#cb31-50" aria-hidden="true" tabindex="-1"></a><span class="co"># by 50 over the subsequent 5 samples. When a manual start</span></span>
<span id="cb31-51"><a href="#cb31-51" aria-hidden="true" tabindex="-1"></a><span class="co"># time is specified, use that instead.</span></span>
<span id="cb31-52"><a href="#cb31-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-53"><a href="#cb31-53" aria-hidden="true" tabindex="-1"></a>ppt_filt_latfix[</span>
<span id="cb31-54"><a href="#cb31-54" aria-hidden="true" tabindex="-1"></a>  ,</span>
<span id="cb31-55"><a href="#cb31-55" aria-hidden="true" tabindex="-1"></a>  leadvel <span class="sc">:</span><span class="er">=</span> <span class="fu">lead</span>(velocity_10hz, <span class="dv">5</span>),</span>
<span id="cb31-56"><a href="#cb31-56" aria-hidden="true" tabindex="-1"></a>  by <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"ppid"</span>, <span class="st">"trial_num_in_block"</span>, <span class="st">"time"</span>)</span>
<span id="cb31-57"><a href="#cb31-57" aria-hidden="true" tabindex="-1"></a>  ][</span>
<span id="cb31-58"><a href="#cb31-58" aria-hidden="true" tabindex="-1"></a>  ,</span>
<span id="cb31-59"><a href="#cb31-59" aria-hidden="true" tabindex="-1"></a>  dif <span class="sc">:</span><span class="er">=</span> <span class="fu">abs</span>(velocity_10hz <span class="sc">-</span> leadvel)</span>
<span id="cb31-60"><a href="#cb31-60" aria-hidden="true" tabindex="-1"></a>  ][,</span>
<span id="cb31-61"><a href="#cb31-61" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">:=</span><span class="st">`</span>(</span>
<span id="cb31-62"><a href="#cb31-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">start_time =</span> <span class="fu">fifelse</span>(</span>
<span id="cb31-63"><a href="#cb31-63" aria-hidden="true" tabindex="-1"></a>      <span class="fu">is.na</span>(start_time) <span class="sc">|</span> start_time <span class="sc">==</span> <span class="dv">0</span>,</span>
<span id="cb31-64"><a href="#cb31-64" aria-hidden="true" tabindex="-1"></a>      .SD[(<span class="sc">!</span>phase <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"start"</span>, <span class="st">"replace"</span>, <span class="st">"return"</span>, <span class="st">"returned"</span>) <span class="sc">|</span></span>
<span id="cb31-65"><a href="#cb31-65" aria-hidden="true" tabindex="-1"></a>        (<span class="sc">!</span>phase <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"replace"</span>, <span class="st">"return"</span>, <span class="st">"returned"</span>) <span class="sc">&amp;</span> ppid <span class="sc">==</span> <span class="st">"d1-003"</span>)) <span class="sc">&amp;</span></span>
<span id="cb31-66"><a href="#cb31-66" aria-hidden="true" tabindex="-1"></a>        dif <span class="sc">&gt;</span> <span class="dv">50</span>]<span class="sc">$</span>time_ms_fix[<span class="dv">1</span>],</span>
<span id="cb31-67"><a href="#cb31-67" aria-hidden="true" tabindex="-1"></a>      start_time</span>
<span id="cb31-68"><a href="#cb31-68" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb31-69"><a href="#cb31-69" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb31-70"><a href="#cb31-70" aria-hidden="true" tabindex="-1"></a>  by <span class="ot">=</span> <span class="fu">c</span>(</span>
<span id="cb31-71"><a href="#cb31-71" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ppid"</span>,</span>
<span id="cb31-72"><a href="#cb31-72" aria-hidden="true" tabindex="-1"></a>    <span class="st">"trial_num_in_block"</span>,</span>
<span id="cb31-73"><a href="#cb31-73" aria-hidden="true" tabindex="-1"></a>    <span class="st">"time"</span></span>
<span id="cb31-74"><a href="#cb31-74" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb31-75"><a href="#cb31-75" aria-hidden="true" tabindex="-1"></a>  ][</span>
<span id="cb31-76"><a href="#cb31-76" aria-hidden="true" tabindex="-1"></a>  ,</span>
<span id="cb31-77"><a href="#cb31-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-78"><a href="#cb31-78" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">:=</span><span class="st">`</span>(</span>
<span id="cb31-79"><a href="#cb31-79" aria-hidden="true" tabindex="-1"></a>      <span class="at">order =</span> <span class="fu">case_when</span>(</span>
<span id="cb31-80"><a href="#cb31-80" aria-hidden="true" tabindex="-1"></a>          block_num <span class="sc">&lt;</span> <span class="dv">3</span> <span class="sc">~</span> <span class="st">"pre"</span>,</span>
<span id="cb31-81"><a href="#cb31-81" aria-hidden="true" tabindex="-1"></a>          block_num <span class="sc">==</span> <span class="dv">4</span> <span class="sc">~</span> <span class="st">"first"</span>,</span>
<span id="cb31-82"><a href="#cb31-82" aria-hidden="true" tabindex="-1"></a>          block_num <span class="sc">==</span> <span class="dv">5</span> <span class="sc">~</span> <span class="st">"second"</span></span>
<span id="cb31-83"><a href="#cb31-83" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb31-84"><a href="#cb31-84" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb31-85"><a href="#cb31-85" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb31-86"><a href="#cb31-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-87"><a href="#cb31-87" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge with manually-identified start points</span></span>
<span id="cb31-88"><a href="#cb31-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-89"><a href="#cb31-89" aria-hidden="true" tabindex="-1"></a>time_correction <span class="ot">&lt;-</span> ppt_filt_latfix[,</span>
<span id="cb31-90"><a href="#cb31-90" aria-hidden="true" tabindex="-1"></a>  time_ms_fix <span class="sc">:</span><span class="er">=</span> time_ms <span class="sc">-</span> start_time,</span>
<span id="cb31-91"><a href="#cb31-91" aria-hidden="true" tabindex="-1"></a>  by <span class="ot">=</span> <span class="fu">c</span>(</span>
<span id="cb31-92"><a href="#cb31-92" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ppid"</span>,</span>
<span id="cb31-93"><a href="#cb31-93" aria-hidden="true" tabindex="-1"></a>    <span class="st">"trial_num_in_block"</span>,</span>
<span id="cb31-94"><a href="#cb31-94" aria-hidden="true" tabindex="-1"></a>    <span class="st">"time"</span></span>
<span id="cb31-95"><a href="#cb31-95" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb31-96"><a href="#cb31-96" aria-hidden="true" tabindex="-1"></a>] <span class="sc">%&gt;%</span></span>
<span id="cb31-97"><a href="#cb31-97" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(ppid, time, trial_num_in_block, time_ms)</span>
<span id="cb31-98"><a href="#cb31-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-99"><a href="#cb31-99" aria-hidden="true" tabindex="-1"></a><span class="fu">fwrite</span>(time_correction, here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"study_one"</span>, <span class="st">"ppt_m_fulltrials.csv"</span>))</span>
<span id="cb31-100"><a href="#cb31-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-101"><a href="#cb31-101" aria-hidden="true" tabindex="-1"></a>start_times <span class="ot">&lt;-</span> time_correction[, .(<span class="at">start_time =</span> <span class="fu">median</span>(start_time)), by <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"ppid"</span>, <span class="st">"trial_num_in_block"</span>, <span class="st">"time"</span>)]</span>
<span id="cb31-102"><a href="#cb31-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-103"><a href="#cb31-103" aria-hidden="true" tabindex="-1"></a>start_times <span class="sc">%&gt;%</span></span>
<span id="cb31-104"><a href="#cb31-104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fwrite</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"study_one"</span>, <span class="st">"ppt_start_times.csv"</span>))</span>
<span id="cb31-105"><a href="#cb31-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-106"><a href="#cb31-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-107"><a href="#cb31-107" aria-hidden="true" tabindex="-1"></a><span class="co"># Manual data fixes/filters</span></span>
<span id="cb31-108"><a href="#cb31-108" aria-hidden="true" tabindex="-1"></a>ppt_m <span class="ot">&lt;-</span> time_correction[</span>
<span id="cb31-109"><a href="#cb31-109" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Only beginning and out phases, 10hz filter. Remove values that would break an analysis.</span></span>
<span id="cb31-110"><a href="#cb31-110" aria-hidden="true" tabindex="-1"></a>  (phase <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"begin"</span>, <span class="st">"out"</span>) <span class="sc">|</span> (ppid <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"d1-003"</span>, <span class="st">"d1-024"</span>) <span class="sc">&amp;</span> phase <span class="sc">==</span> <span class="st">"start"</span>) <span class="sc">|</span></span>
<span id="cb31-111"><a href="#cb31-111" aria-hidden="true" tabindex="-1"></a>    (phase <span class="sc">==</span> <span class="st">"lift"</span> <span class="sc">&amp;</span> time_ms_perphase <span class="sc">&lt;</span> <span class="dv">100</span>)) <span class="sc">&amp;</span></span>
<span id="cb31-112"><a href="#cb31-112" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.infinite</span>(velocity) <span class="sc">&amp;</span></span>
<span id="cb31-113"><a href="#cb31-113" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.infinite</span>(accel) <span class="sc">&amp;</span></span>
<span id="cb31-114"><a href="#cb31-114" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.infinite</span>(accel_filtvel) <span class="sc">&amp;</span></span>
<span id="cb31-115"><a href="#cb31-115" aria-hidden="true" tabindex="-1"></a>    time_ms_fix <span class="sc">&gt;=</span> <span class="dv">0</span></span>
<span id="cb31-116"><a href="#cb31-116" aria-hidden="true" tabindex="-1"></a>  ][</span>
<span id="cb31-117"><a href="#cb31-117" aria-hidden="true" tabindex="-1"></a>    ppid <span class="sc">==</span> <span class="st">"d1-022"</span> <span class="sc">&amp;</span> block_num <span class="sc">&gt;</span> <span class="dv">1</span>,</span>
<span id="cb31-118"><a href="#cb31-118" aria-hidden="true" tabindex="-1"></a>    block_num <span class="sc">:</span><span class="er">=</span> block_num <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb31-119"><a href="#cb31-119" aria-hidden="true" tabindex="-1"></a>  ][</span>
<span id="cb31-120"><a href="#cb31-120" aria-hidden="true" tabindex="-1"></a>  ,</span>
<span id="cb31-121"><a href="#cb31-121" aria-hidden="true" tabindex="-1"></a>  .(</span>
<span id="cb31-122"><a href="#cb31-122" aria-hidden="true" tabindex="-1"></a>    ppid, time, phase,</span>
<span id="cb31-123"><a href="#cb31-123" aria-hidden="true" tabindex="-1"></a>    block_num, trial_num_in_block,</span>
<span id="cb31-124"><a href="#cb31-124" aria-hidden="true" tabindex="-1"></a>    time_ms_perphase, time_ms, time_ms_fix,</span>
<span id="cb31-125"><a href="#cb31-125" aria-hidden="true" tabindex="-1"></a>    velocity, velocity_10hz,</span>
<span id="cb31-126"><a href="#cb31-126" aria-hidden="true" tabindex="-1"></a>    accel, accelfilt, accel_filtvel,</span>
<span id="cb31-127"><a href="#cb31-127" aria-hidden="true" tabindex="-1"></a>    accel_filtvel_filt</span>
<span id="cb31-128"><a href="#cb31-128" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb31-129"><a href="#cb31-129" aria-hidden="true" tabindex="-1"></a>][</span>
<span id="cb31-130"><a href="#cb31-130" aria-hidden="true" tabindex="-1"></a>  (ppid <span class="sc">==</span> <span class="st">"d1-003"</span> <span class="sc">&amp;</span> phase <span class="sc">==</span> <span class="st">"start"</span>)</span>
<span id="cb31-131"><a href="#cb31-131" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span> (ppid <span class="sc">==</span> <span class="st">"d1-024"</span> <span class="sc">&amp;</span> phase <span class="sc">==</span> <span class="st">"start"</span> <span class="sc">&amp;</span> trial_num_in_block <span class="sc">==</span> <span class="dv">7</span>),</span>
<span id="cb31-132"><a href="#cb31-132" aria-hidden="true" tabindex="-1"></a>  phase <span class="sc">:</span><span class="er">=</span> <span class="st">"begin"</span></span>
<span id="cb31-133"><a href="#cb31-133" aria-hidden="true" tabindex="-1"></a>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="individualized-adjustments" class="level1">
<h1>Individualized Adjustments</h1>
<p>The below code lays out the individualized adjustments made to ensure the correct peaks and latencies are chosen for each participant. To see the consequences of these choices, see the individual trial plots in 01b_reaching_trials.qmd.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>ppt_m_ <span class="ot">&lt;-</span> ppt_m[,</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute kinematic peaks and latencies</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># fcase used to manually identify ranges within which the peak occurs</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  .(</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">vel_m_filt =</span> <span class="fu">fcase</span>(</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>      (ppid <span class="sc">==</span> <span class="st">"d1-006"</span> <span class="sc">&amp;</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block <span class="sc">==</span> <span class="dv">8</span> <span class="sc">&amp;</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>        time <span class="sc">==</span> <span class="st">"pre"</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">max</span>(</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>        ppt_m[</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>          ppid <span class="sc">==</span> <span class="st">"d1-006"</span> <span class="sc">&amp;</span></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>          trial_num_in_block <span class="sc">==</span> <span class="dv">8</span> <span class="sc">&amp;</span></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>          time <span class="sc">==</span> <span class="st">"pre"</span> <span class="sc">&amp;</span></span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>          time_ms_fix <span class="sc">&lt;</span> <span class="dv">800</span></span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>        ][</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>        ,</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>        velocity_10hz</span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>        ], <span class="at">na.rm =</span> <span class="cn">TRUE</span></span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>      (</span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>        ppid <span class="sc">==</span> <span class="st">"d1-009"</span> <span class="sc">&amp;</span></span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block <span class="sc">==</span> <span class="dv">11</span> <span class="sc">&amp;</span></span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>        time <span class="sc">==</span> <span class="st">"pre"</span></span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a>      <span class="fu">max</span>(</span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a>        ppt_m[</span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a>          ppid <span class="sc">==</span> <span class="st">"d1-009"</span> <span class="sc">&amp;</span></span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a>          trial_num_in_block <span class="sc">==</span> <span class="dv">11</span> <span class="sc">&amp;</span></span>
<span id="cb32-33"><a href="#cb32-33" aria-hidden="true" tabindex="-1"></a>          time <span class="sc">==</span> <span class="st">"pre"</span> <span class="sc">&amp;</span></span>
<span id="cb32-34"><a href="#cb32-34" aria-hidden="true" tabindex="-1"></a>          time_ms_fix <span class="sc">&lt;</span> <span class="dv">500</span>,</span>
<span id="cb32-35"><a href="#cb32-35" aria-hidden="true" tabindex="-1"></a>          velocity_10hz</span>
<span id="cb32-36"><a href="#cb32-36" aria-hidden="true" tabindex="-1"></a>        ], <span class="at">na.rm =</span> <span class="cn">TRUE</span></span>
<span id="cb32-37"><a href="#cb32-37" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb32-38"><a href="#cb32-38" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb32-39"><a href="#cb32-39" aria-hidden="true" tabindex="-1"></a>      (</span>
<span id="cb32-40"><a href="#cb32-40" aria-hidden="true" tabindex="-1"></a>        ppid <span class="sc">==</span> <span class="st">"d1-013"</span> <span class="sc">&amp;</span></span>
<span id="cb32-41"><a href="#cb32-41" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span></span>
<span id="cb32-42"><a href="#cb32-42" aria-hidden="true" tabindex="-1"></a>        time <span class="sc">==</span> <span class="st">"pre"</span></span>
<span id="cb32-43"><a href="#cb32-43" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb32-44"><a href="#cb32-44" aria-hidden="true" tabindex="-1"></a>      <span class="fu">max</span>(</span>
<span id="cb32-45"><a href="#cb32-45" aria-hidden="true" tabindex="-1"></a>        ppt_m[</span>
<span id="cb32-46"><a href="#cb32-46" aria-hidden="true" tabindex="-1"></a>          ppid <span class="sc">==</span> <span class="st">"d1-013"</span> <span class="sc">&amp;</span></span>
<span id="cb32-47"><a href="#cb32-47" aria-hidden="true" tabindex="-1"></a>          trial_num_in_block <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span></span>
<span id="cb32-48"><a href="#cb32-48" aria-hidden="true" tabindex="-1"></a>          time <span class="sc">==</span> <span class="st">"pre"</span> <span class="sc">&amp;</span></span>
<span id="cb32-49"><a href="#cb32-49" aria-hidden="true" tabindex="-1"></a>          time_ms_fix <span class="sc">&lt;</span> <span class="dv">900</span>,</span>
<span id="cb32-50"><a href="#cb32-50" aria-hidden="true" tabindex="-1"></a>          velocity_10hz</span>
<span id="cb32-51"><a href="#cb32-51" aria-hidden="true" tabindex="-1"></a>        ], <span class="at">na.rm =</span> <span class="cn">TRUE</span></span>
<span id="cb32-52"><a href="#cb32-52" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb32-53"><a href="#cb32-53" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb32-54"><a href="#cb32-54" aria-hidden="true" tabindex="-1"></a>      (</span>
<span id="cb32-55"><a href="#cb32-55" aria-hidden="true" tabindex="-1"></a>        ppid <span class="sc">==</span> <span class="st">"d1-013"</span> <span class="sc">&amp;</span></span>
<span id="cb32-56"><a href="#cb32-56" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span></span>
<span id="cb32-57"><a href="#cb32-57" aria-hidden="true" tabindex="-1"></a>        time <span class="sc">==</span> <span class="st">"post"</span></span>
<span id="cb32-58"><a href="#cb32-58" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb32-59"><a href="#cb32-59" aria-hidden="true" tabindex="-1"></a>      <span class="fu">max</span>(</span>
<span id="cb32-60"><a href="#cb32-60" aria-hidden="true" tabindex="-1"></a>        ppt_m[</span>
<span id="cb32-61"><a href="#cb32-61" aria-hidden="true" tabindex="-1"></a>          ppid <span class="sc">==</span> <span class="st">"d1-013"</span> <span class="sc">&amp;</span></span>
<span id="cb32-62"><a href="#cb32-62" aria-hidden="true" tabindex="-1"></a>          trial_num_in_block <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span></span>
<span id="cb32-63"><a href="#cb32-63" aria-hidden="true" tabindex="-1"></a>          time <span class="sc">==</span> <span class="st">"post"</span> <span class="sc">&amp;</span></span>
<span id="cb32-64"><a href="#cb32-64" aria-hidden="true" tabindex="-1"></a>          time_ms_fix <span class="sc">&lt;</span> <span class="dv">360</span>,</span>
<span id="cb32-65"><a href="#cb32-65" aria-hidden="true" tabindex="-1"></a>          velocity_10hz</span>
<span id="cb32-66"><a href="#cb32-66" aria-hidden="true" tabindex="-1"></a>          ], <span class="at">na.rm =</span> <span class="cn">TRUE</span></span>
<span id="cb32-67"><a href="#cb32-67" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb32-68"><a href="#cb32-68" aria-hidden="true" tabindex="-1"></a>      (</span>
<span id="cb32-69"><a href="#cb32-69" aria-hidden="true" tabindex="-1"></a>        ppid <span class="sc">==</span> <span class="st">"d1-014"</span> <span class="sc">&amp;</span></span>
<span id="cb32-70"><a href="#cb32-70" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block <span class="sc">==</span> <span class="dv">12</span> <span class="sc">&amp;</span></span>
<span id="cb32-71"><a href="#cb32-71" aria-hidden="true" tabindex="-1"></a>        time <span class="sc">==</span> <span class="st">"pre"</span></span>
<span id="cb32-72"><a href="#cb32-72" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb32-73"><a href="#cb32-73" aria-hidden="true" tabindex="-1"></a>      <span class="fu">max</span>(</span>
<span id="cb32-74"><a href="#cb32-74" aria-hidden="true" tabindex="-1"></a>        ppt_m[</span>
<span id="cb32-75"><a href="#cb32-75" aria-hidden="true" tabindex="-1"></a>          ppid <span class="sc">==</span> <span class="st">"d1-014"</span> <span class="sc">&amp;</span></span>
<span id="cb32-76"><a href="#cb32-76" aria-hidden="true" tabindex="-1"></a>          trial_num_in_block <span class="sc">==</span> <span class="dv">12</span> <span class="sc">&amp;</span></span>
<span id="cb32-77"><a href="#cb32-77" aria-hidden="true" tabindex="-1"></a>          time <span class="sc">==</span> <span class="st">"pre"</span> <span class="sc">&amp;</span></span>
<span id="cb32-78"><a href="#cb32-78" aria-hidden="true" tabindex="-1"></a>          time_ms_fix <span class="sc">&lt;</span> <span class="dv">540</span>,</span>
<span id="cb32-79"><a href="#cb32-79" aria-hidden="true" tabindex="-1"></a>          velocity_10hz</span>
<span id="cb32-80"><a href="#cb32-80" aria-hidden="true" tabindex="-1"></a>          ], <span class="at">na.rm =</span> <span class="cn">TRUE</span></span>
<span id="cb32-81"><a href="#cb32-81" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb32-82"><a href="#cb32-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-83"><a href="#cb32-83" aria-hidden="true" tabindex="-1"></a>      <span class="at">default =</span> .SD[</span>
<span id="cb32-84"><a href="#cb32-84" aria-hidden="true" tabindex="-1"></a>        phase <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"begin"</span>, <span class="st">"out"</span>)</span>
<span id="cb32-85"><a href="#cb32-85" aria-hidden="true" tabindex="-1"></a>        ,</span>
<span id="cb32-86"><a href="#cb32-86" aria-hidden="true" tabindex="-1"></a>        <span class="fu">max</span>(velocity_10hz, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb32-87"><a href="#cb32-87" aria-hidden="true" tabindex="-1"></a>      ]</span>
<span id="cb32-88"><a href="#cb32-88" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb32-89"><a href="#cb32-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-90"><a href="#cb32-90" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Velocity Latency ----------------------------------------------------</span></span>
<span id="cb32-91"><a href="#cb32-91" aria-hidden="true" tabindex="-1"></a>    <span class="at">vel_lat_filt =</span> <span class="fu">fcase</span>(</span>
<span id="cb32-92"><a href="#cb32-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-93"><a href="#cb32-93" aria-hidden="true" tabindex="-1"></a>      (</span>
<span id="cb32-94"><a href="#cb32-94" aria-hidden="true" tabindex="-1"></a>        ppid <span class="sc">==</span> <span class="st">"d1-006"</span> <span class="sc">&amp;</span></span>
<span id="cb32-95"><a href="#cb32-95" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block <span class="sc">==</span> <span class="dv">8</span> <span class="sc">&amp;</span></span>
<span id="cb32-96"><a href="#cb32-96" aria-hidden="true" tabindex="-1"></a>        time <span class="sc">==</span> <span class="st">"pre"</span></span>
<span id="cb32-97"><a href="#cb32-97" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb32-98"><a href="#cb32-98" aria-hidden="true" tabindex="-1"></a>      <span class="fu">max</span>(</span>
<span id="cb32-99"><a href="#cb32-99" aria-hidden="true" tabindex="-1"></a>        ppt_m[</span>
<span id="cb32-100"><a href="#cb32-100" aria-hidden="true" tabindex="-1"></a>        ppid <span class="sc">==</span> <span class="st">"d1-006"</span> <span class="sc">&amp;</span></span>
<span id="cb32-101"><a href="#cb32-101" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block <span class="sc">==</span> <span class="dv">8</span> <span class="sc">&amp;</span></span>
<span id="cb32-102"><a href="#cb32-102" aria-hidden="true" tabindex="-1"></a>        time <span class="sc">==</span> <span class="st">"pre"</span> <span class="sc">&amp;</span></span>
<span id="cb32-103"><a href="#cb32-103" aria-hidden="true" tabindex="-1"></a>        time_ms_fix <span class="sc">&lt;</span> <span class="dv">800</span>][<span class="fu">which.max</span>(velocity_10hz), time_ms_fix][<span class="dv">1</span>]</span>
<span id="cb32-104"><a href="#cb32-104" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb32-105"><a href="#cb32-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-106"><a href="#cb32-106" aria-hidden="true" tabindex="-1"></a>      (</span>
<span id="cb32-107"><a href="#cb32-107" aria-hidden="true" tabindex="-1"></a>        ppid <span class="sc">==</span> <span class="st">"d1-009"</span> <span class="sc">&amp;</span></span>
<span id="cb32-108"><a href="#cb32-108" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block <span class="sc">==</span> <span class="dv">11</span> <span class="sc">&amp;</span></span>
<span id="cb32-109"><a href="#cb32-109" aria-hidden="true" tabindex="-1"></a>        time <span class="sc">==</span> <span class="st">"pre"</span>),</span>
<span id="cb32-110"><a href="#cb32-110" aria-hidden="true" tabindex="-1"></a>      (</span>
<span id="cb32-111"><a href="#cb32-111" aria-hidden="true" tabindex="-1"></a>        ppt_m[</span>
<span id="cb32-112"><a href="#cb32-112" aria-hidden="true" tabindex="-1"></a>          ppid <span class="sc">==</span> <span class="st">"d1-009"</span> <span class="sc">&amp;</span></span>
<span id="cb32-113"><a href="#cb32-113" aria-hidden="true" tabindex="-1"></a>          trial_num_in_block <span class="sc">==</span> <span class="dv">11</span> <span class="sc">&amp;</span></span>
<span id="cb32-114"><a href="#cb32-114" aria-hidden="true" tabindex="-1"></a>          time <span class="sc">==</span> <span class="st">"pre"</span> <span class="sc">&amp;</span></span>
<span id="cb32-115"><a href="#cb32-115" aria-hidden="true" tabindex="-1"></a>          time_ms_fix <span class="sc">&lt;</span> <span class="dv">500</span>][<span class="fu">which.max</span>(velocity_10hz), time_ms_fix][<span class="dv">1</span>]</span>
<span id="cb32-116"><a href="#cb32-116" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb32-117"><a href="#cb32-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-118"><a href="#cb32-118" aria-hidden="true" tabindex="-1"></a>      (</span>
<span id="cb32-119"><a href="#cb32-119" aria-hidden="true" tabindex="-1"></a>        ppid <span class="sc">==</span> <span class="st">"d1-013"</span> <span class="sc">&amp;</span></span>
<span id="cb32-120"><a href="#cb32-120" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span></span>
<span id="cb32-121"><a href="#cb32-121" aria-hidden="true" tabindex="-1"></a>        time <span class="sc">==</span> <span class="st">"pre"</span>),</span>
<span id="cb32-122"><a href="#cb32-122" aria-hidden="true" tabindex="-1"></a>      (</span>
<span id="cb32-123"><a href="#cb32-123" aria-hidden="true" tabindex="-1"></a>        ppt_m[</span>
<span id="cb32-124"><a href="#cb32-124" aria-hidden="true" tabindex="-1"></a>          ppid <span class="sc">==</span> <span class="st">"d1-013"</span> <span class="sc">&amp;</span></span>
<span id="cb32-125"><a href="#cb32-125" aria-hidden="true" tabindex="-1"></a>          trial_num_in_block <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span></span>
<span id="cb32-126"><a href="#cb32-126" aria-hidden="true" tabindex="-1"></a>          time <span class="sc">==</span> <span class="st">"pre"</span> <span class="sc">&amp;</span></span>
<span id="cb32-127"><a href="#cb32-127" aria-hidden="true" tabindex="-1"></a>          time_ms_fix <span class="sc">&lt;</span> <span class="dv">900</span>][<span class="fu">which.max</span>(velocity_10hz), time_ms_fix][<span class="dv">1</span>]</span>
<span id="cb32-128"><a href="#cb32-128" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb32-129"><a href="#cb32-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-130"><a href="#cb32-130" aria-hidden="true" tabindex="-1"></a>      (</span>
<span id="cb32-131"><a href="#cb32-131" aria-hidden="true" tabindex="-1"></a>        ppid <span class="sc">==</span> <span class="st">"d1-013"</span> <span class="sc">&amp;</span></span>
<span id="cb32-132"><a href="#cb32-132" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span></span>
<span id="cb32-133"><a href="#cb32-133" aria-hidden="true" tabindex="-1"></a>        time <span class="sc">==</span> <span class="st">"post"</span></span>
<span id="cb32-134"><a href="#cb32-134" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb32-135"><a href="#cb32-135" aria-hidden="true" tabindex="-1"></a>      (</span>
<span id="cb32-136"><a href="#cb32-136" aria-hidden="true" tabindex="-1"></a>        ppt_m[</span>
<span id="cb32-137"><a href="#cb32-137" aria-hidden="true" tabindex="-1"></a>          ppid <span class="sc">==</span> <span class="st">"d1-013"</span> <span class="sc">&amp;</span></span>
<span id="cb32-138"><a href="#cb32-138" aria-hidden="true" tabindex="-1"></a>          trial_num_in_block <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span></span>
<span id="cb32-139"><a href="#cb32-139" aria-hidden="true" tabindex="-1"></a>          time <span class="sc">==</span> <span class="st">"post"</span> <span class="sc">&amp;</span></span>
<span id="cb32-140"><a href="#cb32-140" aria-hidden="true" tabindex="-1"></a>          time_ms_fix <span class="sc">&lt;</span> <span class="dv">360</span>][<span class="fu">which.max</span>(velocity_10hz), time_ms_fix][<span class="dv">1</span>]</span>
<span id="cb32-141"><a href="#cb32-141" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb32-142"><a href="#cb32-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-143"><a href="#cb32-143" aria-hidden="true" tabindex="-1"></a>      (</span>
<span id="cb32-144"><a href="#cb32-144" aria-hidden="true" tabindex="-1"></a>        ppid <span class="sc">==</span> <span class="st">"d1-014"</span> <span class="sc">&amp;</span></span>
<span id="cb32-145"><a href="#cb32-145" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block <span class="sc">==</span> <span class="dv">12</span> <span class="sc">&amp;</span></span>
<span id="cb32-146"><a href="#cb32-146" aria-hidden="true" tabindex="-1"></a>        time <span class="sc">==</span> <span class="st">"pre"</span></span>
<span id="cb32-147"><a href="#cb32-147" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb32-148"><a href="#cb32-148" aria-hidden="true" tabindex="-1"></a>      (</span>
<span id="cb32-149"><a href="#cb32-149" aria-hidden="true" tabindex="-1"></a>        ppt_m[</span>
<span id="cb32-150"><a href="#cb32-150" aria-hidden="true" tabindex="-1"></a>          ppid <span class="sc">==</span> <span class="st">"d1-014"</span> <span class="sc">&amp;</span></span>
<span id="cb32-151"><a href="#cb32-151" aria-hidden="true" tabindex="-1"></a>          trial_num_in_block <span class="sc">==</span> <span class="dv">12</span> <span class="sc">&amp;</span></span>
<span id="cb32-152"><a href="#cb32-152" aria-hidden="true" tabindex="-1"></a>          time <span class="sc">==</span> <span class="st">"pre"</span> <span class="sc">&amp;</span></span>
<span id="cb32-153"><a href="#cb32-153" aria-hidden="true" tabindex="-1"></a>          time_ms_fix <span class="sc">&lt;</span> <span class="dv">540</span>][<span class="fu">which.max</span>(velocity_10hz), time_ms_fix][<span class="dv">1</span>]</span>
<span id="cb32-154"><a href="#cb32-154" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb32-155"><a href="#cb32-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-156"><a href="#cb32-156" aria-hidden="true" tabindex="-1"></a>      <span class="at">default =</span> .SD[</span>
<span id="cb32-157"><a href="#cb32-157" aria-hidden="true" tabindex="-1"></a>        <span class="fu">which.max</span>(velocity_10hz),</span>
<span id="cb32-158"><a href="#cb32-158" aria-hidden="true" tabindex="-1"></a>        time_ms_fix</span>
<span id="cb32-159"><a href="#cb32-159" aria-hidden="true" tabindex="-1"></a>      ][<span class="dv">1</span>]</span>
<span id="cb32-160"><a href="#cb32-160" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb32-161"><a href="#cb32-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-162"><a href="#cb32-162" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Acceleration Peak ------------------------------------------------</span></span>
<span id="cb32-163"><a href="#cb32-163" aria-hidden="true" tabindex="-1"></a>     <span class="at">acc_m_filtfilt =</span> <span class="fu">fcase</span>(</span>
<span id="cb32-164"><a href="#cb32-164" aria-hidden="true" tabindex="-1"></a>      (</span>
<span id="cb32-165"><a href="#cb32-165" aria-hidden="true" tabindex="-1"></a>        ppid <span class="sc">==</span> <span class="st">"d1-003"</span> <span class="sc">&amp;</span></span>
<span id="cb32-166"><a href="#cb32-166" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block <span class="sc">==</span> <span class="dv">10</span> <span class="sc">&amp;</span></span>
<span id="cb32-167"><a href="#cb32-167" aria-hidden="true" tabindex="-1"></a>        time <span class="sc">==</span> <span class="st">"post"</span></span>
<span id="cb32-168"><a href="#cb32-168" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb32-169"><a href="#cb32-169" aria-hidden="true" tabindex="-1"></a>      <span class="fu">max</span>(</span>
<span id="cb32-170"><a href="#cb32-170" aria-hidden="true" tabindex="-1"></a>        ppt_m[</span>
<span id="cb32-171"><a href="#cb32-171" aria-hidden="true" tabindex="-1"></a>          ppid <span class="sc">==</span> <span class="st">"d1-003"</span> <span class="sc">&amp;</span></span>
<span id="cb32-172"><a href="#cb32-172" aria-hidden="true" tabindex="-1"></a>          trial_num_in_block <span class="sc">==</span> <span class="dv">10</span> <span class="sc">&amp;</span></span>
<span id="cb32-173"><a href="#cb32-173" aria-hidden="true" tabindex="-1"></a>          time <span class="sc">==</span> <span class="st">"post"</span> <span class="sc">&amp;</span></span>
<span id="cb32-174"><a href="#cb32-174" aria-hidden="true" tabindex="-1"></a>          time_ms_fix <span class="sc">&lt;</span> <span class="dv">425</span></span>
<span id="cb32-175"><a href="#cb32-175" aria-hidden="true" tabindex="-1"></a>          ][</span>
<span id="cb32-176"><a href="#cb32-176" aria-hidden="true" tabindex="-1"></a>          ,</span>
<span id="cb32-177"><a href="#cb32-177" aria-hidden="true" tabindex="-1"></a>          accel_filtvel_filt</span>
<span id="cb32-178"><a href="#cb32-178" aria-hidden="true" tabindex="-1"></a>        ], <span class="at">na.rm =</span> <span class="cn">TRUE</span></span>
<span id="cb32-179"><a href="#cb32-179" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb32-180"><a href="#cb32-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-181"><a href="#cb32-181" aria-hidden="true" tabindex="-1"></a>      (</span>
<span id="cb32-182"><a href="#cb32-182" aria-hidden="true" tabindex="-1"></a>        ppid <span class="sc">==</span> <span class="st">"d1-004"</span> <span class="sc">&amp;</span></span>
<span id="cb32-183"><a href="#cb32-183" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block <span class="sc">==</span> <span class="dv">15</span> <span class="sc">&amp;</span></span>
<span id="cb32-184"><a href="#cb32-184" aria-hidden="true" tabindex="-1"></a>        time <span class="sc">==</span> <span class="st">"post"</span></span>
<span id="cb32-185"><a href="#cb32-185" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb32-186"><a href="#cb32-186" aria-hidden="true" tabindex="-1"></a>      <span class="fu">max</span>(</span>
<span id="cb32-187"><a href="#cb32-187" aria-hidden="true" tabindex="-1"></a>        ppt_m[</span>
<span id="cb32-188"><a href="#cb32-188" aria-hidden="true" tabindex="-1"></a>          ppid <span class="sc">==</span> <span class="st">"d1-004"</span> <span class="sc">&amp;</span></span>
<span id="cb32-189"><a href="#cb32-189" aria-hidden="true" tabindex="-1"></a>          trial_num_in_block <span class="sc">==</span> <span class="dv">15</span> <span class="sc">&amp;</span></span>
<span id="cb32-190"><a href="#cb32-190" aria-hidden="true" tabindex="-1"></a>          time <span class="sc">==</span> <span class="st">"post"</span> <span class="sc">&amp;</span></span>
<span id="cb32-191"><a href="#cb32-191" aria-hidden="true" tabindex="-1"></a>          time_ms_fix <span class="sc">&lt;</span> <span class="dv">500</span></span>
<span id="cb32-192"><a href="#cb32-192" aria-hidden="true" tabindex="-1"></a>          ][</span>
<span id="cb32-193"><a href="#cb32-193" aria-hidden="true" tabindex="-1"></a>          ,</span>
<span id="cb32-194"><a href="#cb32-194" aria-hidden="true" tabindex="-1"></a>          accel_filtvel_filt</span>
<span id="cb32-195"><a href="#cb32-195" aria-hidden="true" tabindex="-1"></a>        ], <span class="at">na.rm =</span> <span class="cn">TRUE</span></span>
<span id="cb32-196"><a href="#cb32-196" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb32-197"><a href="#cb32-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-198"><a href="#cb32-198" aria-hidden="true" tabindex="-1"></a>      (</span>
<span id="cb32-199"><a href="#cb32-199" aria-hidden="true" tabindex="-1"></a>        ppid <span class="sc">==</span> <span class="st">"d1-006"</span> <span class="sc">&amp;</span></span>
<span id="cb32-200"><a href="#cb32-200" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span></span>
<span id="cb32-201"><a href="#cb32-201" aria-hidden="true" tabindex="-1"></a>        time <span class="sc">==</span> <span class="st">"pre"</span></span>
<span id="cb32-202"><a href="#cb32-202" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb32-203"><a href="#cb32-203" aria-hidden="true" tabindex="-1"></a>      <span class="fu">max</span>(</span>
<span id="cb32-204"><a href="#cb32-204" aria-hidden="true" tabindex="-1"></a>        ppt_m[</span>
<span id="cb32-205"><a href="#cb32-205" aria-hidden="true" tabindex="-1"></a>          ppid <span class="sc">==</span> <span class="st">"d1-006"</span> <span class="sc">&amp;</span></span>
<span id="cb32-206"><a href="#cb32-206" aria-hidden="true" tabindex="-1"></a>          trial_num_in_block <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span></span>
<span id="cb32-207"><a href="#cb32-207" aria-hidden="true" tabindex="-1"></a>          time <span class="sc">==</span> <span class="st">"pre"</span> <span class="sc">&amp;</span></span>
<span id="cb32-208"><a href="#cb32-208" aria-hidden="true" tabindex="-1"></a>          time_ms_fix <span class="sc">&lt;</span> <span class="dv">800</span></span>
<span id="cb32-209"><a href="#cb32-209" aria-hidden="true" tabindex="-1"></a>          ][</span>
<span id="cb32-210"><a href="#cb32-210" aria-hidden="true" tabindex="-1"></a>          ,</span>
<span id="cb32-211"><a href="#cb32-211" aria-hidden="true" tabindex="-1"></a>          accel_filtvel_filt</span>
<span id="cb32-212"><a href="#cb32-212" aria-hidden="true" tabindex="-1"></a>        ], <span class="at">na.rm =</span> <span class="cn">TRUE</span></span>
<span id="cb32-213"><a href="#cb32-213" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb32-214"><a href="#cb32-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-215"><a href="#cb32-215" aria-hidden="true" tabindex="-1"></a>      (ppid <span class="sc">==</span> <span class="st">"d1-006"</span> <span class="sc">&amp;</span></span>
<span id="cb32-216"><a href="#cb32-216" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block <span class="sc">==</span> <span class="dv">4</span> <span class="sc">&amp;</span></span>
<span id="cb32-217"><a href="#cb32-217" aria-hidden="true" tabindex="-1"></a>        time <span class="sc">==</span> <span class="st">"pre"</span>),</span>
<span id="cb32-218"><a href="#cb32-218" aria-hidden="true" tabindex="-1"></a>      <span class="fu">max</span>(ppt_m[ppid <span class="sc">==</span> <span class="st">"d1-006"</span> <span class="sc">&amp;</span></span>
<span id="cb32-219"><a href="#cb32-219" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block <span class="sc">==</span> <span class="dv">4</span> <span class="sc">&amp;</span></span>
<span id="cb32-220"><a href="#cb32-220" aria-hidden="true" tabindex="-1"></a>        time <span class="sc">==</span> <span class="st">"pre"</span> <span class="sc">&amp;</span></span>
<span id="cb32-221"><a href="#cb32-221" aria-hidden="true" tabindex="-1"></a>        time_ms_fix <span class="sc">&lt;</span> <span class="dv">500</span>][</span>
<span id="cb32-222"><a href="#cb32-222" aria-hidden="true" tabindex="-1"></a>        ,</span>
<span id="cb32-223"><a href="#cb32-223" aria-hidden="true" tabindex="-1"></a>        accel_filtvel_filt</span>
<span id="cb32-224"><a href="#cb32-224" aria-hidden="true" tabindex="-1"></a>      ], <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb32-225"><a href="#cb32-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-226"><a href="#cb32-226" aria-hidden="true" tabindex="-1"></a>      (ppid <span class="sc">==</span> <span class="st">"d1-006"</span> <span class="sc">&amp;</span></span>
<span id="cb32-227"><a href="#cb32-227" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block <span class="sc">==</span> <span class="dv">8</span> <span class="sc">&amp;</span></span>
<span id="cb32-228"><a href="#cb32-228" aria-hidden="true" tabindex="-1"></a>        time <span class="sc">==</span> <span class="st">"pre"</span>),</span>
<span id="cb32-229"><a href="#cb32-229" aria-hidden="true" tabindex="-1"></a>      <span class="fu">max</span>(ppt_m[ppid <span class="sc">==</span> <span class="st">"d1-006"</span> <span class="sc">&amp;</span></span>
<span id="cb32-230"><a href="#cb32-230" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block <span class="sc">==</span> <span class="dv">8</span> <span class="sc">&amp;</span></span>
<span id="cb32-231"><a href="#cb32-231" aria-hidden="true" tabindex="-1"></a>        time <span class="sc">==</span> <span class="st">"pre"</span> <span class="sc">&amp;</span></span>
<span id="cb32-232"><a href="#cb32-232" aria-hidden="true" tabindex="-1"></a>        time_ms_fix <span class="sc">&lt;</span> <span class="dv">800</span>][</span>
<span id="cb32-233"><a href="#cb32-233" aria-hidden="true" tabindex="-1"></a>        ,</span>
<span id="cb32-234"><a href="#cb32-234" aria-hidden="true" tabindex="-1"></a>        accel_filtvel_filt</span>
<span id="cb32-235"><a href="#cb32-235" aria-hidden="true" tabindex="-1"></a>      ], <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb32-236"><a href="#cb32-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-237"><a href="#cb32-237" aria-hidden="true" tabindex="-1"></a>      (ppid <span class="sc">==</span> <span class="st">"d1-009"</span> <span class="sc">&amp;</span></span>
<span id="cb32-238"><a href="#cb32-238" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block <span class="sc">==</span> <span class="dv">11</span> <span class="sc">&amp;</span></span>
<span id="cb32-239"><a href="#cb32-239" aria-hidden="true" tabindex="-1"></a>        time <span class="sc">==</span> <span class="st">"pre"</span>),</span>
<span id="cb32-240"><a href="#cb32-240" aria-hidden="true" tabindex="-1"></a>      <span class="fu">max</span>(ppt_m[ppid <span class="sc">==</span> <span class="st">"d1-009"</span> <span class="sc">&amp;</span></span>
<span id="cb32-241"><a href="#cb32-241" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block <span class="sc">==</span> <span class="dv">11</span> <span class="sc">&amp;</span></span>
<span id="cb32-242"><a href="#cb32-242" aria-hidden="true" tabindex="-1"></a>        time <span class="sc">==</span> <span class="st">"pre"</span> <span class="sc">&amp;</span></span>
<span id="cb32-243"><a href="#cb32-243" aria-hidden="true" tabindex="-1"></a>        time_ms_fix <span class="sc">&lt;</span> <span class="dv">400</span>][</span>
<span id="cb32-244"><a href="#cb32-244" aria-hidden="true" tabindex="-1"></a>        ,</span>
<span id="cb32-245"><a href="#cb32-245" aria-hidden="true" tabindex="-1"></a>        accel_filtvel_filt</span>
<span id="cb32-246"><a href="#cb32-246" aria-hidden="true" tabindex="-1"></a>      ], <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb32-247"><a href="#cb32-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-248"><a href="#cb32-248" aria-hidden="true" tabindex="-1"></a>      (ppid <span class="sc">==</span> <span class="st">"d1-013"</span> <span class="sc">&amp;</span></span>
<span id="cb32-249"><a href="#cb32-249" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span></span>
<span id="cb32-250"><a href="#cb32-250" aria-hidden="true" tabindex="-1"></a>        time <span class="sc">==</span> <span class="st">"pre"</span>),</span>
<span id="cb32-251"><a href="#cb32-251" aria-hidden="true" tabindex="-1"></a>      <span class="fu">max</span>(ppt_m[</span>
<span id="cb32-252"><a href="#cb32-252" aria-hidden="true" tabindex="-1"></a>        ppid <span class="sc">==</span> <span class="st">"d1-013"</span> <span class="sc">&amp;</span></span>
<span id="cb32-253"><a href="#cb32-253" aria-hidden="true" tabindex="-1"></a>          trial_num_in_block <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span></span>
<span id="cb32-254"><a href="#cb32-254" aria-hidden="true" tabindex="-1"></a>          time <span class="sc">==</span> <span class="st">"pre"</span> <span class="sc">&amp;</span></span>
<span id="cb32-255"><a href="#cb32-255" aria-hidden="true" tabindex="-1"></a>          time_ms_fix <span class="sc">&lt;</span> <span class="dv">900</span>,</span>
<span id="cb32-256"><a href="#cb32-256" aria-hidden="true" tabindex="-1"></a>        accel_filtvel_filt</span>
<span id="cb32-257"><a href="#cb32-257" aria-hidden="true" tabindex="-1"></a>      ], <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb32-258"><a href="#cb32-258" aria-hidden="true" tabindex="-1"></a>      (</span>
<span id="cb32-259"><a href="#cb32-259" aria-hidden="true" tabindex="-1"></a>        ppid <span class="sc">==</span> <span class="st">"d1-013"</span> <span class="sc">&amp;</span></span>
<span id="cb32-260"><a href="#cb32-260" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>) <span class="sc">&amp;</span></span>
<span id="cb32-261"><a href="#cb32-261" aria-hidden="true" tabindex="-1"></a>        time <span class="sc">==</span> <span class="st">"post"</span></span>
<span id="cb32-262"><a href="#cb32-262" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb32-263"><a href="#cb32-263" aria-hidden="true" tabindex="-1"></a>      <span class="fu">max</span>(ppt_m[</span>
<span id="cb32-264"><a href="#cb32-264" aria-hidden="true" tabindex="-1"></a>        ppid <span class="sc">==</span> <span class="st">"d1-013"</span> <span class="sc">&amp;</span></span>
<span id="cb32-265"><a href="#cb32-265" aria-hidden="true" tabindex="-1"></a>          trial_num_in_block <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>) <span class="sc">&amp;</span></span>
<span id="cb32-266"><a href="#cb32-266" aria-hidden="true" tabindex="-1"></a>          time <span class="sc">==</span> <span class="st">"post"</span> <span class="sc">&amp;</span></span>
<span id="cb32-267"><a href="#cb32-267" aria-hidden="true" tabindex="-1"></a>          time_ms_fix <span class="sc">&lt;</span> <span class="dv">500</span>,</span>
<span id="cb32-268"><a href="#cb32-268" aria-hidden="true" tabindex="-1"></a>        accel_filtvel_filt</span>
<span id="cb32-269"><a href="#cb32-269" aria-hidden="true" tabindex="-1"></a>      ], <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb32-270"><a href="#cb32-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-271"><a href="#cb32-271" aria-hidden="true" tabindex="-1"></a>      (ppid <span class="sc">==</span> <span class="st">"d1-008"</span> <span class="sc">&amp;</span></span>
<span id="cb32-272"><a href="#cb32-272" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block <span class="sc">==</span> <span class="dv">12</span> <span class="sc">&amp;</span></span>
<span id="cb32-273"><a href="#cb32-273" aria-hidden="true" tabindex="-1"></a>        time <span class="sc">==</span> <span class="st">"post"</span>),</span>
<span id="cb32-274"><a href="#cb32-274" aria-hidden="true" tabindex="-1"></a>      <span class="fu">max</span>(ppt_m[</span>
<span id="cb32-275"><a href="#cb32-275" aria-hidden="true" tabindex="-1"></a>        ppid <span class="sc">==</span> <span class="st">"d1-008"</span> <span class="sc">&amp;</span></span>
<span id="cb32-276"><a href="#cb32-276" aria-hidden="true" tabindex="-1"></a>          trial_num_in_block <span class="sc">==</span> <span class="dv">12</span> <span class="sc">&amp;</span></span>
<span id="cb32-277"><a href="#cb32-277" aria-hidden="true" tabindex="-1"></a>          time <span class="sc">==</span> <span class="st">"post"</span> <span class="sc">&amp;</span></span>
<span id="cb32-278"><a href="#cb32-278" aria-hidden="true" tabindex="-1"></a>          time_ms_fix <span class="sc">&lt;</span> <span class="dv">250</span>,</span>
<span id="cb32-279"><a href="#cb32-279" aria-hidden="true" tabindex="-1"></a>        accel_filtvel_filt</span>
<span id="cb32-280"><a href="#cb32-280" aria-hidden="true" tabindex="-1"></a>      ], <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb32-281"><a href="#cb32-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-282"><a href="#cb32-282" aria-hidden="true" tabindex="-1"></a>      ppid <span class="sc">==</span> <span class="st">"d1-021"</span>,</span>
<span id="cb32-283"><a href="#cb32-283" aria-hidden="true" tabindex="-1"></a>      .SD[</span>
<span id="cb32-284"><a href="#cb32-284" aria-hidden="true" tabindex="-1"></a>        time_ms_fix <span class="sc">&lt;</span> <span class="dv">300</span>,</span>
<span id="cb32-285"><a href="#cb32-285" aria-hidden="true" tabindex="-1"></a>        <span class="fu">max</span>(</span>
<span id="cb32-286"><a href="#cb32-286" aria-hidden="true" tabindex="-1"></a>          accel_filtvel_filt,</span>
<span id="cb32-287"><a href="#cb32-287" aria-hidden="true" tabindex="-1"></a>          <span class="at">na.rm =</span> <span class="cn">TRUE</span></span>
<span id="cb32-288"><a href="#cb32-288" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb32-289"><a href="#cb32-289" aria-hidden="true" tabindex="-1"></a>          ],</span>
<span id="cb32-290"><a href="#cb32-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-291"><a href="#cb32-291" aria-hidden="true" tabindex="-1"></a>      (</span>
<span id="cb32-292"><a href="#cb32-292" aria-hidden="true" tabindex="-1"></a>        ppid <span class="sc">==</span> <span class="st">"d1-024"</span> <span class="sc">&amp;</span></span>
<span id="cb32-293"><a href="#cb32-293" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block <span class="sc">==</span> <span class="dv">6</span> <span class="sc">&amp;</span></span>
<span id="cb32-294"><a href="#cb32-294" aria-hidden="true" tabindex="-1"></a>        time <span class="sc">==</span> <span class="st">"pre"</span></span>
<span id="cb32-295"><a href="#cb32-295" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb32-296"><a href="#cb32-296" aria-hidden="true" tabindex="-1"></a>      ppt_m[</span>
<span id="cb32-297"><a href="#cb32-297" aria-hidden="true" tabindex="-1"></a>        ppid <span class="sc">==</span> <span class="st">"d1-024"</span> <span class="sc">&amp;</span></span>
<span id="cb32-298"><a href="#cb32-298" aria-hidden="true" tabindex="-1"></a>          trial_num_in_block <span class="sc">==</span> <span class="dv">6</span> <span class="sc">&amp;</span></span>
<span id="cb32-299"><a href="#cb32-299" aria-hidden="true" tabindex="-1"></a>          time <span class="sc">==</span> <span class="st">"pre"</span> <span class="sc">&amp;</span></span>
<span id="cb32-300"><a href="#cb32-300" aria-hidden="true" tabindex="-1"></a>          time_ms_fix <span class="sc">&lt;</span> <span class="dv">290</span>,</span>
<span id="cb32-301"><a href="#cb32-301" aria-hidden="true" tabindex="-1"></a>        <span class="fu">max</span>(accel_filtvel_filt, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb32-302"><a href="#cb32-302" aria-hidden="true" tabindex="-1"></a>      ],</span>
<span id="cb32-303"><a href="#cb32-303" aria-hidden="true" tabindex="-1"></a>      <span class="at">default =</span> <span class="fu">max</span>(accel_filtvel_filt, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb32-304"><a href="#cb32-304" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb32-305"><a href="#cb32-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-306"><a href="#cb32-306" aria-hidden="true" tabindex="-1"></a><span class="co"># Deceleration peak -------------------------------------------------------</span></span>
<span id="cb32-307"><a href="#cb32-307" aria-hidden="true" tabindex="-1"></a>    <span class="at">dec_m_filtfilt =</span> <span class="fu">fcase</span>(</span>
<span id="cb32-308"><a href="#cb32-308" aria-hidden="true" tabindex="-1"></a>      (ppid <span class="sc">==</span> <span class="st">"d1-001"</span> <span class="sc">&amp;</span></span>
<span id="cb32-309"><a href="#cb32-309" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block <span class="sc">==</span> <span class="dv">10</span> <span class="sc">&amp;</span></span>
<span id="cb32-310"><a href="#cb32-310" aria-hidden="true" tabindex="-1"></a>        time <span class="sc">==</span> <span class="st">"post"</span>),</span>
<span id="cb32-311"><a href="#cb32-311" aria-hidden="true" tabindex="-1"></a>      <span class="fu">min</span>(ppt_m[ppid <span class="sc">==</span> <span class="st">"d1-001"</span> <span class="sc">&amp;</span></span>
<span id="cb32-312"><a href="#cb32-312" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block <span class="sc">==</span> <span class="dv">10</span> <span class="sc">&amp;</span></span>
<span id="cb32-313"><a href="#cb32-313" aria-hidden="true" tabindex="-1"></a>        time <span class="sc">==</span> <span class="st">"post"</span> <span class="sc">&amp;</span></span>
<span id="cb32-314"><a href="#cb32-314" aria-hidden="true" tabindex="-1"></a>        time_ms_fix <span class="sc">&lt;</span> <span class="dv">600</span> <span class="sc">&amp;</span></span>
<span id="cb32-315"><a href="#cb32-315" aria-hidden="true" tabindex="-1"></a>        time_ms_fix <span class="sc">&gt;</span> <span class="dv">200</span>][</span>
<span id="cb32-316"><a href="#cb32-316" aria-hidden="true" tabindex="-1"></a>        ,</span>
<span id="cb32-317"><a href="#cb32-317" aria-hidden="true" tabindex="-1"></a>        accel_filtvel_filt</span>
<span id="cb32-318"><a href="#cb32-318" aria-hidden="true" tabindex="-1"></a>      ], <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb32-319"><a href="#cb32-319" aria-hidden="true" tabindex="-1"></a>      (ppid <span class="sc">==</span> <span class="st">"d1-001"</span> <span class="sc">&amp;</span></span>
<span id="cb32-320"><a href="#cb32-320" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block <span class="sc">==</span> <span class="dv">11</span> <span class="sc">&amp;</span></span>
<span id="cb32-321"><a href="#cb32-321" aria-hidden="true" tabindex="-1"></a>        time <span class="sc">==</span> <span class="st">"post"</span>),</span>
<span id="cb32-322"><a href="#cb32-322" aria-hidden="true" tabindex="-1"></a>      <span class="fu">min</span>(ppt_m[ppid <span class="sc">==</span> <span class="st">"d1-001"</span> <span class="sc">&amp;</span></span>
<span id="cb32-323"><a href="#cb32-323" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block <span class="sc">==</span> <span class="dv">11</span> <span class="sc">&amp;</span></span>
<span id="cb32-324"><a href="#cb32-324" aria-hidden="true" tabindex="-1"></a>        time <span class="sc">==</span> <span class="st">"post"</span> <span class="sc">&amp;</span></span>
<span id="cb32-325"><a href="#cb32-325" aria-hidden="true" tabindex="-1"></a>        time_ms_fix <span class="sc">&gt;</span> <span class="dv">200</span> <span class="sc">&amp;</span></span>
<span id="cb32-326"><a href="#cb32-326" aria-hidden="true" tabindex="-1"></a>        time_ms_fix <span class="sc">&lt;</span> <span class="dv">900</span>][</span>
<span id="cb32-327"><a href="#cb32-327" aria-hidden="true" tabindex="-1"></a>        ,</span>
<span id="cb32-328"><a href="#cb32-328" aria-hidden="true" tabindex="-1"></a>        accel_filtvel_filt</span>
<span id="cb32-329"><a href="#cb32-329" aria-hidden="true" tabindex="-1"></a>      ], <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb32-330"><a href="#cb32-330" aria-hidden="true" tabindex="-1"></a>      (ppid <span class="sc">==</span> <span class="st">"d1-004"</span> <span class="sc">&amp;</span></span>
<span id="cb32-331"><a href="#cb32-331" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block <span class="sc">==</span> <span class="dv">3</span> <span class="sc">&amp;</span></span>
<span id="cb32-332"><a href="#cb32-332" aria-hidden="true" tabindex="-1"></a>        time <span class="sc">==</span> <span class="st">"pre"</span>),</span>
<span id="cb32-333"><a href="#cb32-333" aria-hidden="true" tabindex="-1"></a>      <span class="fu">min</span>(ppt_m[ppid <span class="sc">==</span> <span class="st">"d1-004"</span> <span class="sc">&amp;</span></span>
<span id="cb32-334"><a href="#cb32-334" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block <span class="sc">==</span> <span class="dv">3</span> <span class="sc">&amp;</span></span>
<span id="cb32-335"><a href="#cb32-335" aria-hidden="true" tabindex="-1"></a>        time <span class="sc">==</span> <span class="st">"pre"</span> <span class="sc">&amp;</span></span>
<span id="cb32-336"><a href="#cb32-336" aria-hidden="true" tabindex="-1"></a>        time_ms_fix <span class="sc">&gt;</span> <span class="dv">350</span>][</span>
<span id="cb32-337"><a href="#cb32-337" aria-hidden="true" tabindex="-1"></a>        ,</span>
<span id="cb32-338"><a href="#cb32-338" aria-hidden="true" tabindex="-1"></a>        accel_filtvel_filt</span>
<span id="cb32-339"><a href="#cb32-339" aria-hidden="true" tabindex="-1"></a>      ], <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb32-340"><a href="#cb32-340" aria-hidden="true" tabindex="-1"></a>      (ppid <span class="sc">==</span> <span class="st">"d1-006"</span> <span class="sc">&amp;</span></span>
<span id="cb32-341"><a href="#cb32-341" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span></span>
<span id="cb32-342"><a href="#cb32-342" aria-hidden="true" tabindex="-1"></a>        time <span class="sc">==</span> <span class="st">"pre"</span>),</span>
<span id="cb32-343"><a href="#cb32-343" aria-hidden="true" tabindex="-1"></a>      <span class="fu">min</span>(ppt_m[ppid <span class="sc">==</span> <span class="st">"d1-006"</span> <span class="sc">&amp;</span></span>
<span id="cb32-344"><a href="#cb32-344" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span></span>
<span id="cb32-345"><a href="#cb32-345" aria-hidden="true" tabindex="-1"></a>        time <span class="sc">==</span> <span class="st">"pre"</span> <span class="sc">&amp;</span></span>
<span id="cb32-346"><a href="#cb32-346" aria-hidden="true" tabindex="-1"></a>        time_ms_fix <span class="sc">&lt;</span> <span class="dv">800</span> <span class="sc">&amp;</span></span>
<span id="cb32-347"><a href="#cb32-347" aria-hidden="true" tabindex="-1"></a>        time_ms_fix <span class="sc">&gt;</span> <span class="dv">300</span>][</span>
<span id="cb32-348"><a href="#cb32-348" aria-hidden="true" tabindex="-1"></a>        ,</span>
<span id="cb32-349"><a href="#cb32-349" aria-hidden="true" tabindex="-1"></a>        accel_filtvel_filt</span>
<span id="cb32-350"><a href="#cb32-350" aria-hidden="true" tabindex="-1"></a>      ], <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb32-351"><a href="#cb32-351" aria-hidden="true" tabindex="-1"></a>      (ppid <span class="sc">==</span> <span class="st">"d1-006"</span> <span class="sc">&amp;</span></span>
<span id="cb32-352"><a href="#cb32-352" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block <span class="sc">==</span> <span class="dv">4</span> <span class="sc">&amp;</span></span>
<span id="cb32-353"><a href="#cb32-353" aria-hidden="true" tabindex="-1"></a>        time <span class="sc">==</span> <span class="st">"pre"</span>),</span>
<span id="cb32-354"><a href="#cb32-354" aria-hidden="true" tabindex="-1"></a>      <span class="fu">min</span>(ppt_m[ppid <span class="sc">==</span> <span class="st">"d1-006"</span> <span class="sc">&amp;</span></span>
<span id="cb32-355"><a href="#cb32-355" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block <span class="sc">==</span> <span class="dv">4</span> <span class="sc">&amp;</span></span>
<span id="cb32-356"><a href="#cb32-356" aria-hidden="true" tabindex="-1"></a>        time <span class="sc">==</span> <span class="st">"pre"</span> <span class="sc">&amp;</span></span>
<span id="cb32-357"><a href="#cb32-357" aria-hidden="true" tabindex="-1"></a>        time_ms_fix <span class="sc">&gt;</span> <span class="dv">900</span>][</span>
<span id="cb32-358"><a href="#cb32-358" aria-hidden="true" tabindex="-1"></a>        ,</span>
<span id="cb32-359"><a href="#cb32-359" aria-hidden="true" tabindex="-1"></a>        accel_filtvel_filt</span>
<span id="cb32-360"><a href="#cb32-360" aria-hidden="true" tabindex="-1"></a>      ], <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb32-361"><a href="#cb32-361" aria-hidden="true" tabindex="-1"></a>      (ppid <span class="sc">==</span> <span class="st">"d1-006"</span> <span class="sc">&amp;</span></span>
<span id="cb32-362"><a href="#cb32-362" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block <span class="sc">==</span> <span class="dv">8</span> <span class="sc">&amp;</span></span>
<span id="cb32-363"><a href="#cb32-363" aria-hidden="true" tabindex="-1"></a>        time <span class="sc">==</span> <span class="st">"pre"</span>),</span>
<span id="cb32-364"><a href="#cb32-364" aria-hidden="true" tabindex="-1"></a>      <span class="fu">min</span>(ppt_m[ppid <span class="sc">==</span> <span class="st">"d1-006"</span> <span class="sc">&amp;</span></span>
<span id="cb32-365"><a href="#cb32-365" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block <span class="sc">==</span> <span class="dv">8</span> <span class="sc">&amp;</span></span>
<span id="cb32-366"><a href="#cb32-366" aria-hidden="true" tabindex="-1"></a>        time <span class="sc">==</span> <span class="st">"pre"</span> <span class="sc">&amp;</span></span>
<span id="cb32-367"><a href="#cb32-367" aria-hidden="true" tabindex="-1"></a>        time_ms_fix <span class="sc">&lt;</span> <span class="dv">850</span>][</span>
<span id="cb32-368"><a href="#cb32-368" aria-hidden="true" tabindex="-1"></a>        ,</span>
<span id="cb32-369"><a href="#cb32-369" aria-hidden="true" tabindex="-1"></a>        accel_filtvel_filt</span>
<span id="cb32-370"><a href="#cb32-370" aria-hidden="true" tabindex="-1"></a>      ], <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb32-371"><a href="#cb32-371" aria-hidden="true" tabindex="-1"></a>      (ppid <span class="sc">==</span> <span class="st">"d1-006"</span> <span class="sc">&amp;</span></span>
<span id="cb32-372"><a href="#cb32-372" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block <span class="sc">==</span> <span class="dv">15</span> <span class="sc">&amp;</span></span>
<span id="cb32-373"><a href="#cb32-373" aria-hidden="true" tabindex="-1"></a>        time <span class="sc">==</span> <span class="st">"pre"</span>),</span>
<span id="cb32-374"><a href="#cb32-374" aria-hidden="true" tabindex="-1"></a>      <span class="fu">min</span>(ppt_m[ppid <span class="sc">==</span> <span class="st">"d1-006"</span> <span class="sc">&amp;</span></span>
<span id="cb32-375"><a href="#cb32-375" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block <span class="sc">==</span> <span class="dv">15</span> <span class="sc">&amp;</span></span>
<span id="cb32-376"><a href="#cb32-376" aria-hidden="true" tabindex="-1"></a>        time <span class="sc">==</span> <span class="st">"pre"</span> <span class="sc">&amp;</span></span>
<span id="cb32-377"><a href="#cb32-377" aria-hidden="true" tabindex="-1"></a>        time_ms_fix <span class="sc">&lt;</span> <span class="dv">1200</span>][, accel_filtvel_filt], <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb32-378"><a href="#cb32-378" aria-hidden="true" tabindex="-1"></a>      (ppid <span class="sc">==</span> <span class="st">"d1-006"</span> <span class="sc">&amp;</span></span>
<span id="cb32-379"><a href="#cb32-379" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block <span class="sc">==</span> <span class="dv">16</span> <span class="sc">&amp;</span></span>
<span id="cb32-380"><a href="#cb32-380" aria-hidden="true" tabindex="-1"></a>        time <span class="sc">==</span> <span class="st">"post"</span>),</span>
<span id="cb32-381"><a href="#cb32-381" aria-hidden="true" tabindex="-1"></a>      <span class="fu">min</span>(ppt_m[ppid <span class="sc">==</span> <span class="st">"d1-006"</span> <span class="sc">&amp;</span></span>
<span id="cb32-382"><a href="#cb32-382" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block <span class="sc">==</span> <span class="dv">16</span> <span class="sc">&amp;</span></span>
<span id="cb32-383"><a href="#cb32-383" aria-hidden="true" tabindex="-1"></a>        time <span class="sc">==</span> <span class="st">"post"</span> <span class="sc">&amp;</span></span>
<span id="cb32-384"><a href="#cb32-384" aria-hidden="true" tabindex="-1"></a>        time_ms_fix <span class="sc">&lt;</span> <span class="dv">1000</span>][, accel_filtvel_filt], <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb32-385"><a href="#cb32-385" aria-hidden="true" tabindex="-1"></a>      (ppid <span class="sc">==</span> <span class="st">"d1-006"</span> <span class="sc">&amp;</span></span>
<span id="cb32-386"><a href="#cb32-386" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block <span class="sc">==</span> <span class="dv">15</span> <span class="sc">&amp;</span></span>
<span id="cb32-387"><a href="#cb32-387" aria-hidden="true" tabindex="-1"></a>        time <span class="sc">==</span> <span class="st">"post"</span>),</span>
<span id="cb32-388"><a href="#cb32-388" aria-hidden="true" tabindex="-1"></a>      <span class="fu">min</span>(ppt_m[ppid <span class="sc">==</span> <span class="st">"d1-006"</span> <span class="sc">&amp;</span></span>
<span id="cb32-389"><a href="#cb32-389" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block <span class="sc">==</span> <span class="dv">15</span> <span class="sc">&amp;</span></span>
<span id="cb32-390"><a href="#cb32-390" aria-hidden="true" tabindex="-1"></a>        time <span class="sc">==</span> <span class="st">"post"</span> <span class="sc">&amp;</span></span>
<span id="cb32-391"><a href="#cb32-391" aria-hidden="true" tabindex="-1"></a>        time_ms_fix <span class="sc">&gt;</span> <span class="dv">520</span>][</span>
<span id="cb32-392"><a href="#cb32-392" aria-hidden="true" tabindex="-1"></a>        ,</span>
<span id="cb32-393"><a href="#cb32-393" aria-hidden="true" tabindex="-1"></a>        accel_filtvel_filt</span>
<span id="cb32-394"><a href="#cb32-394" aria-hidden="true" tabindex="-1"></a>      ], <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb32-395"><a href="#cb32-395" aria-hidden="true" tabindex="-1"></a>      (ppid <span class="sc">==</span> <span class="st">"d1-008"</span> <span class="sc">&amp;</span></span>
<span id="cb32-396"><a href="#cb32-396" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block <span class="sc">==</span> <span class="dv">12</span> <span class="sc">&amp;</span></span>
<span id="cb32-397"><a href="#cb32-397" aria-hidden="true" tabindex="-1"></a>        time <span class="sc">==</span> <span class="st">"post"</span>),</span>
<span id="cb32-398"><a href="#cb32-398" aria-hidden="true" tabindex="-1"></a>      <span class="fu">min</span>(ppt_m[ppid <span class="sc">==</span> <span class="st">"d1-008"</span> <span class="sc">&amp;</span></span>
<span id="cb32-399"><a href="#cb32-399" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block <span class="sc">==</span> <span class="dv">12</span> <span class="sc">&amp;</span></span>
<span id="cb32-400"><a href="#cb32-400" aria-hidden="true" tabindex="-1"></a>        time <span class="sc">==</span> <span class="st">"post"</span> <span class="sc">&amp;</span></span>
<span id="cb32-401"><a href="#cb32-401" aria-hidden="true" tabindex="-1"></a>        time_ms_fix <span class="sc">&gt;</span> <span class="dv">950</span>][</span>
<span id="cb32-402"><a href="#cb32-402" aria-hidden="true" tabindex="-1"></a>        ,</span>
<span id="cb32-403"><a href="#cb32-403" aria-hidden="true" tabindex="-1"></a>        accel_filtvel_filt</span>
<span id="cb32-404"><a href="#cb32-404" aria-hidden="true" tabindex="-1"></a>      ], <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb32-405"><a href="#cb32-405" aria-hidden="true" tabindex="-1"></a>      (ppid <span class="sc">==</span> <span class="st">"d1-009"</span> <span class="sc">&amp;</span></span>
<span id="cb32-406"><a href="#cb32-406" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block <span class="sc">==</span> <span class="dv">10</span> <span class="sc">&amp;</span></span>
<span id="cb32-407"><a href="#cb32-407" aria-hidden="true" tabindex="-1"></a>        time <span class="sc">==</span> <span class="st">"pre"</span>),</span>
<span id="cb32-408"><a href="#cb32-408" aria-hidden="true" tabindex="-1"></a>      <span class="fu">min</span>(ppt_m[ppid <span class="sc">==</span> <span class="st">"d1-009"</span> <span class="sc">&amp;</span></span>
<span id="cb32-409"><a href="#cb32-409" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block <span class="sc">==</span> <span class="dv">10</span> <span class="sc">&amp;</span></span>
<span id="cb32-410"><a href="#cb32-410" aria-hidden="true" tabindex="-1"></a>        time <span class="sc">==</span> <span class="st">"pre"</span> <span class="sc">&amp;</span></span>
<span id="cb32-411"><a href="#cb32-411" aria-hidden="true" tabindex="-1"></a>        time_ms_fix <span class="sc">&gt;</span> <span class="dv">550</span>][</span>
<span id="cb32-412"><a href="#cb32-412" aria-hidden="true" tabindex="-1"></a>        ,</span>
<span id="cb32-413"><a href="#cb32-413" aria-hidden="true" tabindex="-1"></a>        accel_filtvel_filt</span>
<span id="cb32-414"><a href="#cb32-414" aria-hidden="true" tabindex="-1"></a>      ], <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb32-415"><a href="#cb32-415" aria-hidden="true" tabindex="-1"></a>      (ppid <span class="sc">==</span> <span class="st">"d1-013"</span> <span class="sc">&amp;</span></span>
<span id="cb32-416"><a href="#cb32-416" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span></span>
<span id="cb32-417"><a href="#cb32-417" aria-hidden="true" tabindex="-1"></a>        time <span class="sc">==</span> <span class="st">"pre"</span>),</span>
<span id="cb32-418"><a href="#cb32-418" aria-hidden="true" tabindex="-1"></a>      <span class="fu">min</span>(ppt_m[ppid <span class="sc">==</span> <span class="st">"d1-016"</span> <span class="sc">&amp;</span></span>
<span id="cb32-419"><a href="#cb32-419" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block <span class="sc">==</span> <span class="dv">12</span> <span class="sc">&amp;</span></span>
<span id="cb32-420"><a href="#cb32-420" aria-hidden="true" tabindex="-1"></a>        time <span class="sc">==</span> <span class="st">"pre"</span> <span class="sc">&amp;</span></span>
<span id="cb32-421"><a href="#cb32-421" aria-hidden="true" tabindex="-1"></a>        time_ms_fix <span class="sc">&gt;</span> <span class="dv">340</span>][</span>
<span id="cb32-422"><a href="#cb32-422" aria-hidden="true" tabindex="-1"></a>        ,</span>
<span id="cb32-423"><a href="#cb32-423" aria-hidden="true" tabindex="-1"></a>        accel_filtvel_filt</span>
<span id="cb32-424"><a href="#cb32-424" aria-hidden="true" tabindex="-1"></a>      ], <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb32-425"><a href="#cb32-425" aria-hidden="true" tabindex="-1"></a>      (ppid <span class="sc">==</span> <span class="st">"d1-016"</span> <span class="sc">&amp;</span></span>
<span id="cb32-426"><a href="#cb32-426" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block <span class="sc">==</span> <span class="dv">12</span> <span class="sc">&amp;</span></span>
<span id="cb32-427"><a href="#cb32-427" aria-hidden="true" tabindex="-1"></a>        time <span class="sc">==</span> <span class="st">"pre"</span>),</span>
<span id="cb32-428"><a href="#cb32-428" aria-hidden="true" tabindex="-1"></a>      <span class="fu">min</span>(ppt_m[ppid <span class="sc">==</span> <span class="st">"d1-016"</span> <span class="sc">&amp;</span></span>
<span id="cb32-429"><a href="#cb32-429" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block <span class="sc">==</span> <span class="dv">12</span> <span class="sc">&amp;</span></span>
<span id="cb32-430"><a href="#cb32-430" aria-hidden="true" tabindex="-1"></a>        time <span class="sc">==</span> <span class="st">"pre"</span> <span class="sc">&amp;</span></span>
<span id="cb32-431"><a href="#cb32-431" aria-hidden="true" tabindex="-1"></a>        time_ms_fix <span class="sc">&gt;</span> <span class="dv">340</span>][</span>
<span id="cb32-432"><a href="#cb32-432" aria-hidden="true" tabindex="-1"></a>        ,</span>
<span id="cb32-433"><a href="#cb32-433" aria-hidden="true" tabindex="-1"></a>        accel_filtvel_filt</span>
<span id="cb32-434"><a href="#cb32-434" aria-hidden="true" tabindex="-1"></a>      ], <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb32-435"><a href="#cb32-435" aria-hidden="true" tabindex="-1"></a>      (ppid <span class="sc">==</span> <span class="st">"d1-021"</span> <span class="sc">&amp;</span></span>
<span id="cb32-436"><a href="#cb32-436" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block <span class="sc">==</span> <span class="dv">17</span> <span class="sc">&amp;</span></span>
<span id="cb32-437"><a href="#cb32-437" aria-hidden="true" tabindex="-1"></a>        time <span class="sc">==</span> <span class="st">"pre"</span>),</span>
<span id="cb32-438"><a href="#cb32-438" aria-hidden="true" tabindex="-1"></a>      <span class="fu">min</span>(ppt_m[ppid <span class="sc">==</span> <span class="st">"d1-021"</span> <span class="sc">&amp;</span></span>
<span id="cb32-439"><a href="#cb32-439" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block <span class="sc">==</span> <span class="dv">17</span> <span class="sc">&amp;</span></span>
<span id="cb32-440"><a href="#cb32-440" aria-hidden="true" tabindex="-1"></a>        time <span class="sc">==</span> <span class="st">"pre"</span> <span class="sc">&amp;</span></span>
<span id="cb32-441"><a href="#cb32-441" aria-hidden="true" tabindex="-1"></a>        time_ms_fix <span class="sc">&gt;</span> <span class="dv">345</span>][</span>
<span id="cb32-442"><a href="#cb32-442" aria-hidden="true" tabindex="-1"></a>        ,</span>
<span id="cb32-443"><a href="#cb32-443" aria-hidden="true" tabindex="-1"></a>        accel_filtvel_filt</span>
<span id="cb32-444"><a href="#cb32-444" aria-hidden="true" tabindex="-1"></a>      ], <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb32-445"><a href="#cb32-445" aria-hidden="true" tabindex="-1"></a>      <span class="at">default =</span> <span class="fu">min</span>(accel_filtvel_filt, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb32-446"><a href="#cb32-446" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb32-447"><a href="#cb32-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-448"><a href="#cb32-448" aria-hidden="true" tabindex="-1"></a><span class="co"># Acceleration Latency ----------------------------------------------</span></span>
<span id="cb32-449"><a href="#cb32-449" aria-hidden="true" tabindex="-1"></a>    <span class="at">acc_lat_filtfilt =</span> <span class="fu">fcase</span>(</span>
<span id="cb32-450"><a href="#cb32-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-451"><a href="#cb32-451" aria-hidden="true" tabindex="-1"></a>      (</span>
<span id="cb32-452"><a href="#cb32-452" aria-hidden="true" tabindex="-1"></a>        ppid <span class="sc">==</span> <span class="st">"d1-003"</span> <span class="sc">&amp;</span></span>
<span id="cb32-453"><a href="#cb32-453" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block <span class="sc">==</span> <span class="dv">10</span> <span class="sc">&amp;</span></span>
<span id="cb32-454"><a href="#cb32-454" aria-hidden="true" tabindex="-1"></a>        time <span class="sc">==</span> <span class="st">"post"</span></span>
<span id="cb32-455"><a href="#cb32-455" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb32-456"><a href="#cb32-456" aria-hidden="true" tabindex="-1"></a>      ppt_m[</span>
<span id="cb32-457"><a href="#cb32-457" aria-hidden="true" tabindex="-1"></a>          ppid <span class="sc">==</span> <span class="st">"d1-003"</span> <span class="sc">&amp;</span></span>
<span id="cb32-458"><a href="#cb32-458" aria-hidden="true" tabindex="-1"></a>          trial_num_in_block <span class="sc">==</span> <span class="dv">10</span> <span class="sc">&amp;</span></span>
<span id="cb32-459"><a href="#cb32-459" aria-hidden="true" tabindex="-1"></a>          time <span class="sc">==</span> <span class="st">"post"</span> <span class="sc">&amp;</span></span>
<span id="cb32-460"><a href="#cb32-460" aria-hidden="true" tabindex="-1"></a>          time_ms_fix <span class="sc">&lt;</span> <span class="dv">425</span></span>
<span id="cb32-461"><a href="#cb32-461" aria-hidden="true" tabindex="-1"></a>        ][</span>
<span id="cb32-462"><a href="#cb32-462" aria-hidden="true" tabindex="-1"></a>          <span class="fu">which.max</span>(accel_filtvel_filt),</span>
<span id="cb32-463"><a href="#cb32-463" aria-hidden="true" tabindex="-1"></a>          time_ms_fix][<span class="dv">1</span>],</span>
<span id="cb32-464"><a href="#cb32-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-465"><a href="#cb32-465" aria-hidden="true" tabindex="-1"></a>      (</span>
<span id="cb32-466"><a href="#cb32-466" aria-hidden="true" tabindex="-1"></a>        ppid <span class="sc">==</span> <span class="st">"d1-004"</span> <span class="sc">&amp;</span></span>
<span id="cb32-467"><a href="#cb32-467" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block <span class="sc">==</span> <span class="dv">15</span> <span class="sc">&amp;</span></span>
<span id="cb32-468"><a href="#cb32-468" aria-hidden="true" tabindex="-1"></a>        time <span class="sc">==</span> <span class="st">"post"</span></span>
<span id="cb32-469"><a href="#cb32-469" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb32-470"><a href="#cb32-470" aria-hidden="true" tabindex="-1"></a>      ppt_m[</span>
<span id="cb32-471"><a href="#cb32-471" aria-hidden="true" tabindex="-1"></a>          ppid <span class="sc">==</span> <span class="st">"d1-004"</span> <span class="sc">&amp;</span></span>
<span id="cb32-472"><a href="#cb32-472" aria-hidden="true" tabindex="-1"></a>          trial_num_in_block <span class="sc">==</span> <span class="dv">15</span> <span class="sc">&amp;</span></span>
<span id="cb32-473"><a href="#cb32-473" aria-hidden="true" tabindex="-1"></a>          time <span class="sc">==</span> <span class="st">"post"</span> <span class="sc">&amp;</span></span>
<span id="cb32-474"><a href="#cb32-474" aria-hidden="true" tabindex="-1"></a>          time_ms_fix <span class="sc">&lt;</span> <span class="dv">500</span></span>
<span id="cb32-475"><a href="#cb32-475" aria-hidden="true" tabindex="-1"></a>        ][</span>
<span id="cb32-476"><a href="#cb32-476" aria-hidden="true" tabindex="-1"></a>          <span class="fu">which.max</span>(accel_filtvel_filt),</span>
<span id="cb32-477"><a href="#cb32-477" aria-hidden="true" tabindex="-1"></a>          time_ms_fix][<span class="dv">1</span>],</span>
<span id="cb32-478"><a href="#cb32-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-479"><a href="#cb32-479" aria-hidden="true" tabindex="-1"></a>      (</span>
<span id="cb32-480"><a href="#cb32-480" aria-hidden="true" tabindex="-1"></a>        ppid <span class="sc">==</span> <span class="st">"d1-006"</span> <span class="sc">&amp;</span></span>
<span id="cb32-481"><a href="#cb32-481" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span></span>
<span id="cb32-482"><a href="#cb32-482" aria-hidden="true" tabindex="-1"></a>        time <span class="sc">==</span> <span class="st">"pre"</span></span>
<span id="cb32-483"><a href="#cb32-483" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb32-484"><a href="#cb32-484" aria-hidden="true" tabindex="-1"></a>      ppt_m[</span>
<span id="cb32-485"><a href="#cb32-485" aria-hidden="true" tabindex="-1"></a>          ppid <span class="sc">==</span> <span class="st">"d1-006"</span> <span class="sc">&amp;</span></span>
<span id="cb32-486"><a href="#cb32-486" aria-hidden="true" tabindex="-1"></a>          trial_num_in_block <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span></span>
<span id="cb32-487"><a href="#cb32-487" aria-hidden="true" tabindex="-1"></a>          time <span class="sc">==</span> <span class="st">"pre"</span> <span class="sc">&amp;</span></span>
<span id="cb32-488"><a href="#cb32-488" aria-hidden="true" tabindex="-1"></a>          time_ms_fix <span class="sc">&lt;</span> <span class="dv">800</span></span>
<span id="cb32-489"><a href="#cb32-489" aria-hidden="true" tabindex="-1"></a>        ][</span>
<span id="cb32-490"><a href="#cb32-490" aria-hidden="true" tabindex="-1"></a>          <span class="fu">which.max</span>(accel_filtvel_filt),</span>
<span id="cb32-491"><a href="#cb32-491" aria-hidden="true" tabindex="-1"></a>          time_ms_fix][<span class="dv">1</span>],</span>
<span id="cb32-492"><a href="#cb32-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-493"><a href="#cb32-493" aria-hidden="true" tabindex="-1"></a>      (</span>
<span id="cb32-494"><a href="#cb32-494" aria-hidden="true" tabindex="-1"></a>        ppid <span class="sc">==</span> <span class="st">"d1-006"</span> <span class="sc">&amp;</span></span>
<span id="cb32-495"><a href="#cb32-495" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block <span class="sc">==</span> <span class="dv">8</span> <span class="sc">&amp;</span></span>
<span id="cb32-496"><a href="#cb32-496" aria-hidden="true" tabindex="-1"></a>        time <span class="sc">==</span> <span class="st">"pre"</span></span>
<span id="cb32-497"><a href="#cb32-497" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb32-498"><a href="#cb32-498" aria-hidden="true" tabindex="-1"></a>      ppt_m[</span>
<span id="cb32-499"><a href="#cb32-499" aria-hidden="true" tabindex="-1"></a>          ppid <span class="sc">==</span> <span class="st">"d1-006"</span> <span class="sc">&amp;</span></span>
<span id="cb32-500"><a href="#cb32-500" aria-hidden="true" tabindex="-1"></a>          trial_num_in_block <span class="sc">==</span> <span class="dv">8</span> <span class="sc">&amp;</span></span>
<span id="cb32-501"><a href="#cb32-501" aria-hidden="true" tabindex="-1"></a>          time <span class="sc">==</span> <span class="st">"pre"</span> <span class="sc">&amp;</span></span>
<span id="cb32-502"><a href="#cb32-502" aria-hidden="true" tabindex="-1"></a>          time_ms_fix <span class="sc">&lt;</span> <span class="dv">800</span></span>
<span id="cb32-503"><a href="#cb32-503" aria-hidden="true" tabindex="-1"></a>        ][</span>
<span id="cb32-504"><a href="#cb32-504" aria-hidden="true" tabindex="-1"></a>          <span class="fu">which.max</span>(accel_filtvel_filt),</span>
<span id="cb32-505"><a href="#cb32-505" aria-hidden="true" tabindex="-1"></a>          time_ms_fix][<span class="dv">1</span>],</span>
<span id="cb32-506"><a href="#cb32-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-507"><a href="#cb32-507" aria-hidden="true" tabindex="-1"></a>      (</span>
<span id="cb32-508"><a href="#cb32-508" aria-hidden="true" tabindex="-1"></a>        ppid <span class="sc">==</span> <span class="st">"d1-008"</span> <span class="sc">&amp;</span></span>
<span id="cb32-509"><a href="#cb32-509" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block <span class="sc">==</span> <span class="dv">12</span> <span class="sc">&amp;</span></span>
<span id="cb32-510"><a href="#cb32-510" aria-hidden="true" tabindex="-1"></a>        time <span class="sc">==</span> <span class="st">"post"</span></span>
<span id="cb32-511"><a href="#cb32-511" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb32-512"><a href="#cb32-512" aria-hidden="true" tabindex="-1"></a>      ppt_m[</span>
<span id="cb32-513"><a href="#cb32-513" aria-hidden="true" tabindex="-1"></a>          ppid <span class="sc">==</span> <span class="st">"d1-008"</span> <span class="sc">&amp;</span></span>
<span id="cb32-514"><a href="#cb32-514" aria-hidden="true" tabindex="-1"></a>          trial_num_in_block <span class="sc">==</span> <span class="dv">12</span> <span class="sc">&amp;</span></span>
<span id="cb32-515"><a href="#cb32-515" aria-hidden="true" tabindex="-1"></a>          time <span class="sc">==</span> <span class="st">"post"</span> <span class="sc">&amp;</span></span>
<span id="cb32-516"><a href="#cb32-516" aria-hidden="true" tabindex="-1"></a>          time_ms_fix <span class="sc">&gt;</span> <span class="dv">250</span></span>
<span id="cb32-517"><a href="#cb32-517" aria-hidden="true" tabindex="-1"></a>        ][</span>
<span id="cb32-518"><a href="#cb32-518" aria-hidden="true" tabindex="-1"></a>          <span class="fu">which.max</span>(accel_filtvel_filt),</span>
<span id="cb32-519"><a href="#cb32-519" aria-hidden="true" tabindex="-1"></a>          time_ms_fix][<span class="dv">1</span>],</span>
<span id="cb32-520"><a href="#cb32-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-521"><a href="#cb32-521" aria-hidden="true" tabindex="-1"></a>        (</span>
<span id="cb32-522"><a href="#cb32-522" aria-hidden="true" tabindex="-1"></a>          ppid <span class="sc">==</span> <span class="st">"d1-009"</span> <span class="sc">&amp;</span></span>
<span id="cb32-523"><a href="#cb32-523" aria-hidden="true" tabindex="-1"></a>          trial_num_in_block <span class="sc">==</span> <span class="dv">11</span> <span class="sc">&amp;</span></span>
<span id="cb32-524"><a href="#cb32-524" aria-hidden="true" tabindex="-1"></a>          time <span class="sc">==</span> <span class="st">"pre"</span></span>
<span id="cb32-525"><a href="#cb32-525" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb32-526"><a href="#cb32-526" aria-hidden="true" tabindex="-1"></a>      ppt_m[</span>
<span id="cb32-527"><a href="#cb32-527" aria-hidden="true" tabindex="-1"></a>          ppid <span class="sc">==</span> <span class="st">"d1-009"</span> <span class="sc">&amp;</span></span>
<span id="cb32-528"><a href="#cb32-528" aria-hidden="true" tabindex="-1"></a>          trial_num_in_block <span class="sc">==</span> <span class="dv">11</span> <span class="sc">&amp;</span></span>
<span id="cb32-529"><a href="#cb32-529" aria-hidden="true" tabindex="-1"></a>          time <span class="sc">==</span> <span class="st">"pre"</span> <span class="sc">&amp;</span></span>
<span id="cb32-530"><a href="#cb32-530" aria-hidden="true" tabindex="-1"></a>          time_ms_fix <span class="sc">&lt;</span> <span class="dv">250</span></span>
<span id="cb32-531"><a href="#cb32-531" aria-hidden="true" tabindex="-1"></a>        ][</span>
<span id="cb32-532"><a href="#cb32-532" aria-hidden="true" tabindex="-1"></a>          <span class="fu">which.max</span>(accel_filtvel_filt),</span>
<span id="cb32-533"><a href="#cb32-533" aria-hidden="true" tabindex="-1"></a>          time_ms_fix][<span class="dv">1</span>],</span>
<span id="cb32-534"><a href="#cb32-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-535"><a href="#cb32-535" aria-hidden="true" tabindex="-1"></a>      (</span>
<span id="cb32-536"><a href="#cb32-536" aria-hidden="true" tabindex="-1"></a>        ppid <span class="sc">==</span> <span class="st">"d1-013"</span> <span class="sc">&amp;</span></span>
<span id="cb32-537"><a href="#cb32-537" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span></span>
<span id="cb32-538"><a href="#cb32-538" aria-hidden="true" tabindex="-1"></a>        time <span class="sc">==</span> <span class="st">"pre"</span></span>
<span id="cb32-539"><a href="#cb32-539" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb32-540"><a href="#cb32-540" aria-hidden="true" tabindex="-1"></a>      ppt_m[</span>
<span id="cb32-541"><a href="#cb32-541" aria-hidden="true" tabindex="-1"></a>          ppid <span class="sc">==</span> <span class="st">"d1-013"</span> <span class="sc">&amp;</span></span>
<span id="cb32-542"><a href="#cb32-542" aria-hidden="true" tabindex="-1"></a>          trial_num_in_block <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span></span>
<span id="cb32-543"><a href="#cb32-543" aria-hidden="true" tabindex="-1"></a>          time <span class="sc">==</span> <span class="st">"pre"</span> <span class="sc">&amp;</span></span>
<span id="cb32-544"><a href="#cb32-544" aria-hidden="true" tabindex="-1"></a>          time_ms_fix <span class="sc">&lt;</span> <span class="dv">500</span></span>
<span id="cb32-545"><a href="#cb32-545" aria-hidden="true" tabindex="-1"></a>        ][</span>
<span id="cb32-546"><a href="#cb32-546" aria-hidden="true" tabindex="-1"></a>          <span class="fu">which.max</span>(accel_filtvel_filt),</span>
<span id="cb32-547"><a href="#cb32-547" aria-hidden="true" tabindex="-1"></a>          time_ms_fix</span>
<span id="cb32-548"><a href="#cb32-548" aria-hidden="true" tabindex="-1"></a>        ][<span class="dv">1</span>],</span>
<span id="cb32-549"><a href="#cb32-549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-550"><a href="#cb32-550" aria-hidden="true" tabindex="-1"></a>      (</span>
<span id="cb32-551"><a href="#cb32-551" aria-hidden="true" tabindex="-1"></a>        ppid <span class="sc">==</span> <span class="st">"d1-013"</span> <span class="sc">&amp;</span></span>
<span id="cb32-552"><a href="#cb32-552" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>) <span class="sc">&amp;</span></span>
<span id="cb32-553"><a href="#cb32-553" aria-hidden="true" tabindex="-1"></a>        time <span class="sc">==</span> <span class="st">"post"</span></span>
<span id="cb32-554"><a href="#cb32-554" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb32-555"><a href="#cb32-555" aria-hidden="true" tabindex="-1"></a>      ppt_m[</span>
<span id="cb32-556"><a href="#cb32-556" aria-hidden="true" tabindex="-1"></a>          ppid <span class="sc">==</span> <span class="st">"d1-013"</span> <span class="sc">&amp;</span></span>
<span id="cb32-557"><a href="#cb32-557" aria-hidden="true" tabindex="-1"></a>          trial_num_in_block <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>) <span class="sc">&amp;</span></span>
<span id="cb32-558"><a href="#cb32-558" aria-hidden="true" tabindex="-1"></a>          time <span class="sc">==</span> <span class="st">"post"</span> <span class="sc">&amp;</span></span>
<span id="cb32-559"><a href="#cb32-559" aria-hidden="true" tabindex="-1"></a>          time_ms_fix <span class="sc">&lt;</span> <span class="dv">500</span></span>
<span id="cb32-560"><a href="#cb32-560" aria-hidden="true" tabindex="-1"></a>        ][</span>
<span id="cb32-561"><a href="#cb32-561" aria-hidden="true" tabindex="-1"></a>          <span class="fu">which.max</span>(accel_filtvel_filt),</span>
<span id="cb32-562"><a href="#cb32-562" aria-hidden="true" tabindex="-1"></a>          time_ms_fix</span>
<span id="cb32-563"><a href="#cb32-563" aria-hidden="true" tabindex="-1"></a>        ][<span class="dv">1</span>],</span>
<span id="cb32-564"><a href="#cb32-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-565"><a href="#cb32-565" aria-hidden="true" tabindex="-1"></a>      ppid <span class="sc">==</span> <span class="st">"d1-014"</span>,</span>
<span id="cb32-566"><a href="#cb32-566" aria-hidden="true" tabindex="-1"></a>      .SD[</span>
<span id="cb32-567"><a href="#cb32-567" aria-hidden="true" tabindex="-1"></a>        time_ms_fix <span class="sc">&lt;</span> <span class="dv">300</span></span>
<span id="cb32-568"><a href="#cb32-568" aria-hidden="true" tabindex="-1"></a>        ][</span>
<span id="cb32-569"><a href="#cb32-569" aria-hidden="true" tabindex="-1"></a>          <span class="fu">which.max</span>(accel_filtvel_filt),</span>
<span id="cb32-570"><a href="#cb32-570" aria-hidden="true" tabindex="-1"></a>          time_ms_fix</span>
<span id="cb32-571"><a href="#cb32-571" aria-hidden="true" tabindex="-1"></a>        ][<span class="dv">1</span>],</span>
<span id="cb32-572"><a href="#cb32-572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-573"><a href="#cb32-573" aria-hidden="true" tabindex="-1"></a>      (</span>
<span id="cb32-574"><a href="#cb32-574" aria-hidden="true" tabindex="-1"></a>        ppid <span class="sc">==</span> <span class="st">"d1-014"</span> <span class="sc">&amp;</span></span>
<span id="cb32-575"><a href="#cb32-575" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block <span class="sc">==</span> <span class="dv">12</span> <span class="sc">&amp;</span></span>
<span id="cb32-576"><a href="#cb32-576" aria-hidden="true" tabindex="-1"></a>        time <span class="sc">==</span> <span class="st">"pre"</span></span>
<span id="cb32-577"><a href="#cb32-577" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb32-578"><a href="#cb32-578" aria-hidden="true" tabindex="-1"></a>      ppt_m[</span>
<span id="cb32-579"><a href="#cb32-579" aria-hidden="true" tabindex="-1"></a>          ppid <span class="sc">==</span> <span class="st">"d1-014"</span> <span class="sc">&amp;</span></span>
<span id="cb32-580"><a href="#cb32-580" aria-hidden="true" tabindex="-1"></a>          trial_num_in_block <span class="sc">==</span> <span class="dv">12</span> <span class="sc">&amp;</span></span>
<span id="cb32-581"><a href="#cb32-581" aria-hidden="true" tabindex="-1"></a>          time <span class="sc">==</span> <span class="st">"pre"</span> <span class="sc">&amp;</span></span>
<span id="cb32-582"><a href="#cb32-582" aria-hidden="true" tabindex="-1"></a>          time_ms_fix <span class="sc">&lt;</span> <span class="dv">300</span></span>
<span id="cb32-583"><a href="#cb32-583" aria-hidden="true" tabindex="-1"></a>        ][</span>
<span id="cb32-584"><a href="#cb32-584" aria-hidden="true" tabindex="-1"></a>          <span class="fu">which.max</span>(accel_filtvel_filt),</span>
<span id="cb32-585"><a href="#cb32-585" aria-hidden="true" tabindex="-1"></a>          time_ms_fix</span>
<span id="cb32-586"><a href="#cb32-586" aria-hidden="true" tabindex="-1"></a>        ][<span class="dv">1</span>],</span>
<span id="cb32-587"><a href="#cb32-587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-588"><a href="#cb32-588" aria-hidden="true" tabindex="-1"></a>      ppid <span class="sc">==</span> <span class="st">"d1-021"</span>,</span>
<span id="cb32-589"><a href="#cb32-589" aria-hidden="true" tabindex="-1"></a>      .SD[</span>
<span id="cb32-590"><a href="#cb32-590" aria-hidden="true" tabindex="-1"></a>        time_ms_fix <span class="sc">&lt;</span> <span class="dv">300</span></span>
<span id="cb32-591"><a href="#cb32-591" aria-hidden="true" tabindex="-1"></a>        ][</span>
<span id="cb32-592"><a href="#cb32-592" aria-hidden="true" tabindex="-1"></a>          <span class="fu">which.max</span>(accel_filtvel_filt),</span>
<span id="cb32-593"><a href="#cb32-593" aria-hidden="true" tabindex="-1"></a>          time_ms_fix</span>
<span id="cb32-594"><a href="#cb32-594" aria-hidden="true" tabindex="-1"></a>        ][<span class="dv">1</span>],</span>
<span id="cb32-595"><a href="#cb32-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-596"><a href="#cb32-596" aria-hidden="true" tabindex="-1"></a>      (</span>
<span id="cb32-597"><a href="#cb32-597" aria-hidden="true" tabindex="-1"></a>        ppid <span class="sc">==</span> <span class="st">"d1-024"</span> <span class="sc">&amp;</span></span>
<span id="cb32-598"><a href="#cb32-598" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block <span class="sc">==</span> <span class="dv">6</span> <span class="sc">&amp;</span></span>
<span id="cb32-599"><a href="#cb32-599" aria-hidden="true" tabindex="-1"></a>        time <span class="sc">==</span> <span class="st">"pre"</span></span>
<span id="cb32-600"><a href="#cb32-600" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb32-601"><a href="#cb32-601" aria-hidden="true" tabindex="-1"></a>      ppt_m[ppid <span class="sc">==</span> <span class="st">"d1-024"</span> <span class="sc">&amp;</span></span>
<span id="cb32-602"><a href="#cb32-602" aria-hidden="true" tabindex="-1"></a>          trial_num_in_block <span class="sc">==</span> <span class="dv">6</span> <span class="sc">&amp;</span></span>
<span id="cb32-603"><a href="#cb32-603" aria-hidden="true" tabindex="-1"></a>          time <span class="sc">==</span> <span class="st">"pre"</span> <span class="sc">&amp;</span></span>
<span id="cb32-604"><a href="#cb32-604" aria-hidden="true" tabindex="-1"></a>          time_ms_fix <span class="sc">&lt;</span> <span class="dv">290</span></span>
<span id="cb32-605"><a href="#cb32-605" aria-hidden="true" tabindex="-1"></a>        ][</span>
<span id="cb32-606"><a href="#cb32-606" aria-hidden="true" tabindex="-1"></a>          <span class="fu">which.max</span>(accel_filtvel_filt), time_ms_fix</span>
<span id="cb32-607"><a href="#cb32-607" aria-hidden="true" tabindex="-1"></a>        ][<span class="dv">1</span>],</span>
<span id="cb32-608"><a href="#cb32-608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-609"><a href="#cb32-609" aria-hidden="true" tabindex="-1"></a>      <span class="at">default =</span> .SD[<span class="fu">which.max</span>(accel_filtvel_filt), time_ms_fix][<span class="dv">1</span>]</span>
<span id="cb32-610"><a href="#cb32-610" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb32-611"><a href="#cb32-611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-612"><a href="#cb32-612" aria-hidden="true" tabindex="-1"></a>    <span class="at">dec_lat_filtfilt =</span> <span class="fu">fcase</span>(</span>
<span id="cb32-613"><a href="#cb32-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-614"><a href="#cb32-614" aria-hidden="true" tabindex="-1"></a>      (ppid <span class="sc">==</span> <span class="st">"d1-004"</span> <span class="sc">&amp;</span></span>
<span id="cb32-615"><a href="#cb32-615" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block <span class="sc">==</span> <span class="dv">3</span> <span class="sc">&amp;</span></span>
<span id="cb32-616"><a href="#cb32-616" aria-hidden="true" tabindex="-1"></a>        time <span class="sc">==</span> <span class="st">"pre"</span>),</span>
<span id="cb32-617"><a href="#cb32-617" aria-hidden="true" tabindex="-1"></a>      ppt_m[ppid <span class="sc">==</span> <span class="st">"d1-004"</span> <span class="sc">&amp;</span></span>
<span id="cb32-618"><a href="#cb32-618" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block <span class="sc">==</span> <span class="dv">3</span> <span class="sc">&amp;</span></span>
<span id="cb32-619"><a href="#cb32-619" aria-hidden="true" tabindex="-1"></a>        time <span class="sc">==</span> <span class="st">"pre"</span> <span class="sc">&amp;</span></span>
<span id="cb32-620"><a href="#cb32-620" aria-hidden="true" tabindex="-1"></a>        time_ms_fix <span class="sc">&gt;</span> <span class="dv">680</span>][<span class="fu">which.min</span>(accel_filtvel_filt), time_ms_fix][<span class="dv">1</span>],</span>
<span id="cb32-621"><a href="#cb32-621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-622"><a href="#cb32-622" aria-hidden="true" tabindex="-1"></a>      (ppid <span class="sc">==</span> <span class="st">"d1-006"</span> <span class="sc">&amp;</span></span>
<span id="cb32-623"><a href="#cb32-623" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span></span>
<span id="cb32-624"><a href="#cb32-624" aria-hidden="true" tabindex="-1"></a>        time <span class="sc">==</span> <span class="st">"pre"</span>),</span>
<span id="cb32-625"><a href="#cb32-625" aria-hidden="true" tabindex="-1"></a>      ppt_m[ppid <span class="sc">==</span> <span class="st">"d1-006"</span> <span class="sc">&amp;</span></span>
<span id="cb32-626"><a href="#cb32-626" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span></span>
<span id="cb32-627"><a href="#cb32-627" aria-hidden="true" tabindex="-1"></a>        time <span class="sc">==</span> <span class="st">"pre"</span> <span class="sc">&amp;</span></span>
<span id="cb32-628"><a href="#cb32-628" aria-hidden="true" tabindex="-1"></a>        time_ms_fix <span class="sc">&lt;</span> <span class="dv">800</span> <span class="sc">&amp;</span></span>
<span id="cb32-629"><a href="#cb32-629" aria-hidden="true" tabindex="-1"></a>        time_ms_fix <span class="sc">&gt;</span> <span class="dv">300</span>][<span class="fu">which.min</span>(accel_filtvel_filt), time_ms_fix][<span class="dv">1</span>],</span>
<span id="cb32-630"><a href="#cb32-630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-631"><a href="#cb32-631" aria-hidden="true" tabindex="-1"></a>      (ppid <span class="sc">==</span> <span class="st">"d1-006"</span> <span class="sc">&amp;</span></span>
<span id="cb32-632"><a href="#cb32-632" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block <span class="sc">==</span> <span class="dv">8</span> <span class="sc">&amp;</span></span>
<span id="cb32-633"><a href="#cb32-633" aria-hidden="true" tabindex="-1"></a>        time <span class="sc">==</span> <span class="st">"pre"</span>),</span>
<span id="cb32-634"><a href="#cb32-634" aria-hidden="true" tabindex="-1"></a>      ppt_m[ppid <span class="sc">==</span> <span class="st">"d1-006"</span> <span class="sc">&amp;</span></span>
<span id="cb32-635"><a href="#cb32-635" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block <span class="sc">==</span> <span class="dv">8</span> <span class="sc">&amp;</span></span>
<span id="cb32-636"><a href="#cb32-636" aria-hidden="true" tabindex="-1"></a>        time <span class="sc">==</span> <span class="st">"pre"</span> <span class="sc">&amp;</span></span>
<span id="cb32-637"><a href="#cb32-637" aria-hidden="true" tabindex="-1"></a>        time_ms_fix <span class="sc">&lt;</span> <span class="dv">900</span>][<span class="fu">which.min</span>(accel_filtvel_filt), time_ms_fix][<span class="dv">1</span>],</span>
<span id="cb32-638"><a href="#cb32-638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-639"><a href="#cb32-639" aria-hidden="true" tabindex="-1"></a>      (ppid <span class="sc">==</span> <span class="st">"d1-006"</span> <span class="sc">&amp;</span></span>
<span id="cb32-640"><a href="#cb32-640" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block <span class="sc">==</span> <span class="dv">10</span> <span class="sc">&amp;</span></span>
<span id="cb32-641"><a href="#cb32-641" aria-hidden="true" tabindex="-1"></a>        time <span class="sc">==</span> <span class="st">"pre"</span>),</span>
<span id="cb32-642"><a href="#cb32-642" aria-hidden="true" tabindex="-1"></a>      ppt_m[ppid <span class="sc">==</span> <span class="st">"d1-006"</span> <span class="sc">&amp;</span></span>
<span id="cb32-643"><a href="#cb32-643" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block <span class="sc">==</span> <span class="dv">10</span> <span class="sc">&amp;</span></span>
<span id="cb32-644"><a href="#cb32-644" aria-hidden="true" tabindex="-1"></a>        time <span class="sc">==</span> <span class="st">"pre"</span> <span class="sc">&amp;</span></span>
<span id="cb32-645"><a href="#cb32-645" aria-hidden="true" tabindex="-1"></a>        time_ms_fix <span class="sc">&gt;</span> <span class="dv">500</span> <span class="sc">&amp;</span></span>
<span id="cb32-646"><a href="#cb32-646" aria-hidden="true" tabindex="-1"></a>        time_ms_fix <span class="sc">&lt;</span> <span class="dv">1000</span>][<span class="fu">which.min</span>(accel_filtvel_filt), time_ms_fix][<span class="dv">1</span>],</span>
<span id="cb32-647"><a href="#cb32-647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-648"><a href="#cb32-648" aria-hidden="true" tabindex="-1"></a>      (ppid <span class="sc">==</span> <span class="st">"d1-006"</span> <span class="sc">&amp;</span></span>
<span id="cb32-649"><a href="#cb32-649" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block <span class="sc">==</span> <span class="dv">15</span> <span class="sc">&amp;</span></span>
<span id="cb32-650"><a href="#cb32-650" aria-hidden="true" tabindex="-1"></a>        time <span class="sc">==</span> <span class="st">"pre"</span>),</span>
<span id="cb32-651"><a href="#cb32-651" aria-hidden="true" tabindex="-1"></a>      ppt_m[ppid <span class="sc">==</span> <span class="st">"d1-006"</span> <span class="sc">&amp;</span></span>
<span id="cb32-652"><a href="#cb32-652" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block <span class="sc">==</span> <span class="dv">15</span> <span class="sc">&amp;</span></span>
<span id="cb32-653"><a href="#cb32-653" aria-hidden="true" tabindex="-1"></a>        time <span class="sc">==</span> <span class="st">"pre"</span> <span class="sc">&amp;</span></span>
<span id="cb32-654"><a href="#cb32-654" aria-hidden="true" tabindex="-1"></a>        time_ms_fix <span class="sc">&lt;</span> <span class="dv">1200</span>][<span class="fu">which.min</span>(accel_filtvel_filt), time_ms_fix][<span class="dv">1</span>],</span>
<span id="cb32-655"><a href="#cb32-655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-656"><a href="#cb32-656" aria-hidden="true" tabindex="-1"></a>      (ppid <span class="sc">==</span> <span class="st">"d1-006"</span> <span class="sc">&amp;</span></span>
<span id="cb32-657"><a href="#cb32-657" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block <span class="sc">==</span> <span class="dv">16</span> <span class="sc">&amp;</span></span>
<span id="cb32-658"><a href="#cb32-658" aria-hidden="true" tabindex="-1"></a>        time <span class="sc">==</span> <span class="st">"post"</span>),</span>
<span id="cb32-659"><a href="#cb32-659" aria-hidden="true" tabindex="-1"></a>      ppt_m[ppid <span class="sc">==</span> <span class="st">"d1-006"</span> <span class="sc">&amp;</span></span>
<span id="cb32-660"><a href="#cb32-660" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block <span class="sc">==</span> <span class="dv">16</span> <span class="sc">&amp;</span></span>
<span id="cb32-661"><a href="#cb32-661" aria-hidden="true" tabindex="-1"></a>        time <span class="sc">==</span> <span class="st">"post"</span> <span class="sc">&amp;</span></span>
<span id="cb32-662"><a href="#cb32-662" aria-hidden="true" tabindex="-1"></a>        time_ms_fix <span class="sc">&lt;</span> <span class="dv">900</span>][<span class="fu">which.min</span>(accel_filtvel_filt), time_ms_fix][<span class="dv">1</span>],</span>
<span id="cb32-663"><a href="#cb32-663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-664"><a href="#cb32-664" aria-hidden="true" tabindex="-1"></a>      (ppid <span class="sc">==</span> <span class="st">"d1-006"</span> <span class="sc">&amp;</span></span>
<span id="cb32-665"><a href="#cb32-665" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block <span class="sc">==</span> <span class="dv">15</span> <span class="sc">&amp;</span></span>
<span id="cb32-666"><a href="#cb32-666" aria-hidden="true" tabindex="-1"></a>        time <span class="sc">==</span> <span class="st">"post"</span>),</span>
<span id="cb32-667"><a href="#cb32-667" aria-hidden="true" tabindex="-1"></a>      ppt_m[ppid <span class="sc">==</span> <span class="st">"d1-006"</span> <span class="sc">&amp;</span></span>
<span id="cb32-668"><a href="#cb32-668" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block <span class="sc">==</span> <span class="dv">15</span> <span class="sc">&amp;</span></span>
<span id="cb32-669"><a href="#cb32-669" aria-hidden="true" tabindex="-1"></a>        time <span class="sc">==</span> <span class="st">"post"</span> <span class="sc">&amp;</span></span>
<span id="cb32-670"><a href="#cb32-670" aria-hidden="true" tabindex="-1"></a>        time_ms_fix <span class="sc">&gt;</span> <span class="dv">520</span>][<span class="fu">which.min</span>(accel_filtvel_filt), time_ms_fix][<span class="dv">1</span>],</span>
<span id="cb32-671"><a href="#cb32-671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-672"><a href="#cb32-672" aria-hidden="true" tabindex="-1"></a>      (ppid <span class="sc">==</span> <span class="st">"d1-008"</span> <span class="sc">&amp;</span></span>
<span id="cb32-673"><a href="#cb32-673" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block <span class="sc">==</span> <span class="dv">12</span> <span class="sc">&amp;</span></span>
<span id="cb32-674"><a href="#cb32-674" aria-hidden="true" tabindex="-1"></a>        time <span class="sc">==</span> <span class="st">"post"</span>),</span>
<span id="cb32-675"><a href="#cb32-675" aria-hidden="true" tabindex="-1"></a>      ppt_m[ppid <span class="sc">==</span> <span class="st">"d1-008"</span> <span class="sc">&amp;</span></span>
<span id="cb32-676"><a href="#cb32-676" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block <span class="sc">==</span> <span class="dv">12</span> <span class="sc">&amp;</span></span>
<span id="cb32-677"><a href="#cb32-677" aria-hidden="true" tabindex="-1"></a>        time <span class="sc">==</span> <span class="st">"post"</span> <span class="sc">&amp;</span></span>
<span id="cb32-678"><a href="#cb32-678" aria-hidden="true" tabindex="-1"></a>        time_ms_fix <span class="sc">&gt;</span> <span class="dv">950</span>][<span class="fu">which.min</span>(accel_filtvel_filt), time_ms_fix][<span class="dv">1</span>],</span>
<span id="cb32-679"><a href="#cb32-679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-680"><a href="#cb32-680" aria-hidden="true" tabindex="-1"></a>      (ppid <span class="sc">==</span> <span class="st">"d1-009"</span> <span class="sc">&amp;</span></span>
<span id="cb32-681"><a href="#cb32-681" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block <span class="sc">==</span> <span class="dv">10</span> <span class="sc">&amp;</span></span>
<span id="cb32-682"><a href="#cb32-682" aria-hidden="true" tabindex="-1"></a>        time <span class="sc">==</span> <span class="st">"pre"</span>),</span>
<span id="cb32-683"><a href="#cb32-683" aria-hidden="true" tabindex="-1"></a>      ppt_m[ppid <span class="sc">==</span> <span class="st">"d1-009"</span> <span class="sc">&amp;</span></span>
<span id="cb32-684"><a href="#cb32-684" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block <span class="sc">==</span> <span class="dv">10</span> <span class="sc">&amp;</span></span>
<span id="cb32-685"><a href="#cb32-685" aria-hidden="true" tabindex="-1"></a>        time <span class="sc">==</span> <span class="st">"pre"</span> <span class="sc">&amp;</span></span>
<span id="cb32-686"><a href="#cb32-686" aria-hidden="true" tabindex="-1"></a>        time_ms_fix <span class="sc">&gt;</span> <span class="dv">550</span>][<span class="fu">which.min</span>(accel_filtvel_filt), time_ms_fix][<span class="dv">1</span>],</span>
<span id="cb32-687"><a href="#cb32-687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-688"><a href="#cb32-688" aria-hidden="true" tabindex="-1"></a>      (ppid <span class="sc">==</span> <span class="st">"d1-013"</span> <span class="sc">&amp;</span></span>
<span id="cb32-689"><a href="#cb32-689" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span></span>
<span id="cb32-690"><a href="#cb32-690" aria-hidden="true" tabindex="-1"></a>        time <span class="sc">==</span> <span class="st">"pre"</span>),</span>
<span id="cb32-691"><a href="#cb32-691" aria-hidden="true" tabindex="-1"></a>      ppt_m[ppid <span class="sc">==</span> <span class="st">"d1-013"</span> <span class="sc">&amp;</span></span>
<span id="cb32-692"><a href="#cb32-692" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span></span>
<span id="cb32-693"><a href="#cb32-693" aria-hidden="true" tabindex="-1"></a>        time <span class="sc">==</span> <span class="st">"pre"</span> <span class="sc">&amp;</span></span>
<span id="cb32-694"><a href="#cb32-694" aria-hidden="true" tabindex="-1"></a>        time_ms_fix <span class="sc">&lt;</span> <span class="dv">1050</span> <span class="sc">&amp;</span></span>
<span id="cb32-695"><a href="#cb32-695" aria-hidden="true" tabindex="-1"></a>        time_ms_fix <span class="sc">&gt;</span> <span class="dv">525</span>][<span class="fu">which.min</span>(accel_filtvel_filt), time_ms_fix][<span class="dv">1</span>],</span>
<span id="cb32-696"><a href="#cb32-696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-697"><a href="#cb32-697" aria-hidden="true" tabindex="-1"></a>      (ppid <span class="sc">==</span> <span class="st">"d1-016"</span> <span class="sc">&amp;</span></span>
<span id="cb32-698"><a href="#cb32-698" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block <span class="sc">==</span> <span class="dv">12</span> <span class="sc">&amp;</span></span>
<span id="cb32-699"><a href="#cb32-699" aria-hidden="true" tabindex="-1"></a>        time <span class="sc">==</span> <span class="st">"pre"</span>),</span>
<span id="cb32-700"><a href="#cb32-700" aria-hidden="true" tabindex="-1"></a>      ppt_m[ppid <span class="sc">==</span> <span class="st">"d1-016"</span> <span class="sc">&amp;</span></span>
<span id="cb32-701"><a href="#cb32-701" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block <span class="sc">==</span> <span class="dv">12</span> <span class="sc">&amp;</span></span>
<span id="cb32-702"><a href="#cb32-702" aria-hidden="true" tabindex="-1"></a>        time <span class="sc">==</span> <span class="st">"pre"</span> <span class="sc">&amp;</span></span>
<span id="cb32-703"><a href="#cb32-703" aria-hidden="true" tabindex="-1"></a>        time_ms_fix <span class="sc">&gt;</span> <span class="dv">340</span>][<span class="fu">which.min</span>(accel_filtvel_filt), time_ms_fix][<span class="dv">1</span>],</span>
<span id="cb32-704"><a href="#cb32-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-705"><a href="#cb32-705" aria-hidden="true" tabindex="-1"></a>      (ppid <span class="sc">==</span> <span class="st">"d1-021"</span> <span class="sc">&amp;</span></span>
<span id="cb32-706"><a href="#cb32-706" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block <span class="sc">==</span> <span class="dv">17</span> <span class="sc">&amp;</span></span>
<span id="cb32-707"><a href="#cb32-707" aria-hidden="true" tabindex="-1"></a>        time <span class="sc">==</span> <span class="st">"pre"</span>),</span>
<span id="cb32-708"><a href="#cb32-708" aria-hidden="true" tabindex="-1"></a>      ppt_m[ppid <span class="sc">==</span> <span class="st">"d1-021"</span> <span class="sc">&amp;</span></span>
<span id="cb32-709"><a href="#cb32-709" aria-hidden="true" tabindex="-1"></a>        trial_num_in_block <span class="sc">==</span> <span class="dv">17</span> <span class="sc">&amp;</span></span>
<span id="cb32-710"><a href="#cb32-710" aria-hidden="true" tabindex="-1"></a>        time <span class="sc">==</span> <span class="st">"pre"</span> <span class="sc">&amp;</span></span>
<span id="cb32-711"><a href="#cb32-711" aria-hidden="true" tabindex="-1"></a>        time_ms_fix <span class="sc">&gt;</span> <span class="dv">345</span>][<span class="fu">which.min</span>(accel_filtvel_filt), time_ms_fix][<span class="dv">1</span>],</span>
<span id="cb32-712"><a href="#cb32-712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-713"><a href="#cb32-713" aria-hidden="true" tabindex="-1"></a>      <span class="at">default =</span> .SD[</span>
<span id="cb32-714"><a href="#cb32-714" aria-hidden="true" tabindex="-1"></a>        time_ms_fix <span class="sc">&gt;</span> <span class="dv">100</span></span>
<span id="cb32-715"><a href="#cb32-715" aria-hidden="true" tabindex="-1"></a>      ][</span>
<span id="cb32-716"><a href="#cb32-716" aria-hidden="true" tabindex="-1"></a>        <span class="fu">which.min</span>(accel_filtvel_filt), time_ms_fix</span>
<span id="cb32-717"><a href="#cb32-717" aria-hidden="true" tabindex="-1"></a>      ][<span class="dv">1</span>]</span>
<span id="cb32-718"><a href="#cb32-718" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb32-719"><a href="#cb32-719" aria-hidden="true" tabindex="-1"></a>       ),</span>
<span id="cb32-720"><a href="#cb32-720" aria-hidden="true" tabindex="-1"></a>        by <span class="ot">=</span> <span class="fu">c</span>(</span>
<span id="cb32-721"><a href="#cb32-721" aria-hidden="true" tabindex="-1"></a>          <span class="st">"ppid"</span>,</span>
<span id="cb32-722"><a href="#cb32-722" aria-hidden="true" tabindex="-1"></a>          <span class="st">"trial_num_in_block"</span>,</span>
<span id="cb32-723"><a href="#cb32-723" aria-hidden="true" tabindex="-1"></a>          <span class="st">"block_num"</span>,</span>
<span id="cb32-724"><a href="#cb32-724" aria-hidden="true" tabindex="-1"></a>          <span class="st">"time"</span></span>
<span id="cb32-725"><a href="#cb32-725" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb32-726"><a href="#cb32-726" aria-hidden="true" tabindex="-1"></a>      ]</span>
<span id="cb32-727"><a href="#cb32-727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-728"><a href="#cb32-728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-729"><a href="#cb32-729" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> ppt_m_[</span>
<span id="cb32-730"><a href="#cb32-730" aria-hidden="true" tabindex="-1"></a>  dec_lat_filtfilt <span class="sc">&lt;</span> acc_lat_filtfilt <span class="sc">|</span></span>
<span id="cb32-731"><a href="#cb32-731" aria-hidden="true" tabindex="-1"></a>    dec_lat_filtfilt <span class="sc">&lt;</span> vel_lat_filt <span class="sc">|</span></span>
<span id="cb32-732"><a href="#cb32-732" aria-hidden="true" tabindex="-1"></a>    acc_lat_filtfilt <span class="sc">&gt;</span> vel_lat_filt</span>
<span id="cb32-733"><a href="#cb32-733" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb32-734"><a href="#cb32-734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-735"><a href="#cb32-735" aria-hidden="true" tabindex="-1"></a>test</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     ppid trial_num_in_block block_num time vel_m_filt vel_lat_filt
1: d1-001                 18         2  pre   793.2591          210
   acc_m_filtfilt dec_m_filtfilt acc_lat_filtfilt dec_lat_filtfilt
1:       4814.967      -1913.649              560              430</code></pre>
</div>
</div>
<p>Note: Accelerations for d1-001 are removed prior to analysis, so their presence in the above test is inconsequential.</p>
</section>
<section id="removals-imputation-and-export" class="level1">
<h1>Removals, Imputation and Export</h1>
<p>A single trial’s accelerations for participants 18 and 21 were removed from analysis due to distortions. A single trial’s decelerations were removed for participants 14 and 21. These were imputed using a missing forest approach.</p>
<p>Participant 1’s accelerations and acceleration latencies were removed from analysis due to a delay in the start of recording. These were not imputed, as there was insufficient information to do so confidently.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">complete</span>(ppt_m_, ppid, trial_num_in_block, time) <span class="sc">%&gt;%</span> <span class="fu">as.data.table</span>()</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> d[</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  ppid <span class="sc">==</span> <span class="st">"d1-003"</span> <span class="sc">&amp;</span> time <span class="sc">==</span> <span class="st">"post"</span>,</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  block_num <span class="sc">:</span><span class="er">=</span> <span class="dv">4</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>][</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  ,</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">:=</span><span class="st">`</span>(</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">ppid =</span> <span class="fu">factor</span>(ppid),</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">time =</span> <span class="fu">factor</span>(time),</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">trial_num_in_block =</span> <span class="fu">factor</span>(trial_num_in_block),</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">order =</span> <span class="fu">fcase</span>(</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>      block_num <span class="sc">&lt;</span> <span class="dv">3</span>, <span class="st">"pre"</span>,</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>      block_num <span class="sc">==</span> <span class="dv">4</span>, <span class="st">"first"</span>,</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>      block_num <span class="sc">==</span> <span class="dv">5</span>, <span class="st">"second"</span></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>][</span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>  (ppid <span class="sc">==</span> <span class="st">"d1-021"</span> <span class="sc">&amp;</span> time <span class="sc">==</span> <span class="st">"pre"</span> <span class="sc">&amp;</span> trial_num_in_block <span class="sc">==</span> <span class="dv">17</span>)</span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span> (ppid <span class="sc">==</span> <span class="st">"d1-018"</span> <span class="sc">&amp;</span> time <span class="sc">==</span> <span class="st">"pre"</span> <span class="sc">&amp;</span> trial_num_in_block <span class="sc">==</span> <span class="dv">2</span>),</span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">:=</span><span class="st">`</span>(<span class="at">acc_lat_filtfilt =</span> <span class="cn">NA</span>,</span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">acc_m_filtfilt =</span> <span class="cn">NA</span>) </span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>][</span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>  (ppid <span class="sc">==</span> <span class="st">"d1-014"</span> <span class="sc">&amp;</span> time <span class="sc">==</span> <span class="st">"pre"</span> <span class="sc">&amp;</span> trial_num_in_block <span class="sc">==</span> <span class="dv">4</span>)</span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span> (ppid <span class="sc">==</span> <span class="st">"d1-021"</span> <span class="sc">&amp;</span> time <span class="sc">==</span> <span class="st">"post"</span> <span class="sc">&amp;</span> trial_num_in_block <span class="sc">==</span> <span class="dv">4</span>),</span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">:=</span><span class="st">`</span>(<span class="at">dec_lat_filtfilt =</span> <span class="cn">NA</span>,</span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a>       <span class="at">dec_m_filtfilt =</span> <span class="cn">NA</span>)</span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-30"><a href="#cb34-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Use a linear model to impute any missing trials</span></span>
<span id="cb34-31"><a href="#cb34-31" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1337</span>)</span>
<span id="cb34-32"><a href="#cb34-32" aria-hidden="true" tabindex="-1"></a>d_imputed <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span> </span>
<span id="cb34-33"><a href="#cb34-33" aria-hidden="true" tabindex="-1"></a>simputation<span class="sc">::</span><span class="fu">impute_mf</span>(</span>
<span id="cb34-34"><a href="#cb34-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> vel_m_filt <span class="sc">+</span> vel_lat_filt </span>
<span id="cb34-35"><a href="#cb34-35" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> acc_m_filtfilt <span class="sc">+</span> dec_m_filtfilt </span>
<span id="cb34-36"><a href="#cb34-36" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> acc_lat_filtfilt <span class="sc">+</span> dec_lat_filtfilt </span>
<span id="cb34-37"><a href="#cb34-37" aria-hidden="true" tabindex="-1"></a>    <span class="sc">~</span> trial_num_in_block </span>
<span id="cb34-38"><a href="#cb34-38" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> ppid </span>
<span id="cb34-39"><a href="#cb34-39" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> time</span>
<span id="cb34-40"><a href="#cb34-40" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb34-41"><a href="#cb34-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-42"><a href="#cb34-42" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(</span>
<span id="cb34-43"><a href="#cb34-43" aria-hidden="true" tabindex="-1"></a>    d_imputed[</span>
<span id="cb34-44"><a href="#cb34-44" aria-hidden="true" tabindex="-1"></a>        ppid <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"d1-001"</span>),</span>
<span id="cb34-45"><a href="#cb34-45" aria-hidden="true" tabindex="-1"></a>        <span class="st">`</span><span class="at">:=</span><span class="st">`</span>(</span>
<span id="cb34-46"><a href="#cb34-46" aria-hidden="true" tabindex="-1"></a>            <span class="at">acc_lat_filtfilt =</span> <span class="cn">NA</span>,</span>
<span id="cb34-47"><a href="#cb34-47" aria-hidden="true" tabindex="-1"></a>            <span class="at">acc_m_filtfilt =</span> <span class="cn">NA</span>,</span>
<span id="cb34-48"><a href="#cb34-48" aria-hidden="true" tabindex="-1"></a>            <span class="at">vel_lat_filt =</span> <span class="cn">NA</span>,</span>
<span id="cb34-49"><a href="#cb34-49" aria-hidden="true" tabindex="-1"></a>            <span class="at">dec_lat_filtfilt =</span> <span class="cn">NA</span></span>
<span id="cb34-50"><a href="#cb34-50" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb34-51"><a href="#cb34-51" aria-hidden="true" tabindex="-1"></a>    ], here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"study_one"</span>, <span class="st">"ppt_manual.csv"</span>)</span>
<span id="cb34-52"><a href="#cb34-52" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>